<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='goè¯­è¨€'><title>ã€ŠMastering Goã€‹ç¿»è¯‘ç¬¬å…­ç« ï¼ˆå·²å®Œæˆï¼‰</title>

<link rel='canonical' href='https://yunteng9345.github.io/p/mastering-go%E7%BF%BB%E8%AF%91%E7%AC%AC%E5%85%AD%E7%AB%A0%E5%B7%B2%E5%AE%8C%E6%88%90/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='ã€ŠMastering Goã€‹ç¿»è¯‘ç¬¬å…­ç« ï¼ˆå·²å®Œæˆï¼‰'>
<meta property='og:description' content='goè¯­è¨€'>
<meta property='og:url' content='https://yunteng9345.github.io/p/mastering-go%E7%BF%BB%E8%AF%91%E7%AC%AC%E5%85%AD%E7%AB%A0%E5%B7%B2%E5%AE%8C%E6%88%90/'>
<meta property='og:site_name' content=''>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2021-01-09T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2021-01-09T00:00:00&#43;00:00'/>
<meta name="twitter:title" content="ã€ŠMastering Goã€‹ç¿»è¯‘ç¬¬å…­ç« ï¼ˆå·²å®Œæˆï¼‰">
<meta name="twitter:description" content="goè¯­è¨€">
    </head>
    <body class="
    article-page 
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        on-phone--column extended
    
">
    
        <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            
            <figure class="site-avatar">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hub71195b252e6e88b5edc9899f4d2ee4b_224567_300x0_resize_q75_box.jpg" width="300"
                            height="333" class="site-logo" loading="lazy" alt="Avatar">
                    
                

                
                    <span class="emoji">ğŸ¥</span>
                
            </figure>
            
        
        <h1 class="site-name"><a href="https://yunteng9345.github.io/"></a></h1>
        <h2 class="site-description">test, consectetur adipiscing elit.</h2>
    </header>

    <ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/' target="_blank">
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives/' >
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search/' >
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        
            <li id="dark-mode-toggle">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <span>æš—è‰²æ¨¡å¼</span>
            </li>
        
    </ol>
</aside>

    
<main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <h2 class="article-title">
        <a href="/p/mastering-go%E7%BF%BB%E8%AF%91%E7%AC%AC%E5%85%AD%E7%AB%A0%E5%B7%B2%E5%AE%8C%E6%88%90/">ã€ŠMastering Goã€‹ç¿»è¯‘ç¬¬å…­ç« ï¼ˆå·²å®Œæˆï¼‰</a>
    </h2>

    
    <h3 class="article-subtitle">
        goè¯­è¨€
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jan 09, 2021</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 21 åˆ†é’Ÿ
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h1 id="mastering-goç¿»è¯‘ç¬¬6ç« ">ã€ŠMastering Goã€‹ç¿»è¯‘ç¬¬6ç« </h1>
<p>æˆ‘çš„githubåœ°å€ï¼š<a class="link" href="https://github.com/yunteng9345/Mastering_Go_Second_Edition_Zh_CN"  target="_blank" rel="noopener"
    >https://github.com/yunteng9345/Mastering_Go_Second_Edition_Zh_CN</a></p>
<p>ä¸»è¦å†…å®¹ï¼š</p>
<ul>
<li>goå‡½æ•°å¼€å‘</li>
<li>åŒ¿åå‡½æ•°</li>
<li>å¤šè¿”å›å€¼å‡½æ•°</li>
<li>å‘½åå‡½æ•°è¿”å›å€¼</li>
<li>å‡½æ•°è¿”å›å…¶ä»–å‡½æ•°</li>
<li>å¯å˜å‚æ•°å‡½æ•°</li>
<li>å¼€å‘Go packages</li>
<li>ç”¨Go Moduleså¼€å‘å’Œå·¥ä½œ</li>
<li>ç§æœ‰å’Œå…¬æœ‰packageå¯¹è±¡</li>
<li>åœ¨packagesä½¿ç”¨<code>init()</code>å‡½æ•°</li>
<li>Goæ ‡å‡†åŒ…html/template</li>
<li>Goæ ‡å‡†åŒ…text/template</li>
<li>Goé«˜çº§åŒ…go/scanner, go/parser, go/token</li>
<li>Goæ ‡å‡†åŒ…syscallï¼Œåº•å±‚åŒ…ï¼Œè™½ç„¶ä½ å¯èƒ½ä¸ç›´æ¥ä½¿ç”¨ï¼Œä½†æ˜¯å®ƒå¹¿æ³›è¿ç”¨åœ¨å…¶ä»–çš„Go packages</li>
</ul>
<h1 id="ä½ ä¸çŸ¥é“çš„go-packageså’ŒåŠŸèƒ½">ä½ ä¸çŸ¥é“çš„Go packageså’ŒåŠŸèƒ½</h1>
<p>ä¸Šä¸€ç« è®²è§£äº†å¦‚ä½•å¼€å‘å’Œå¦‚ä½•è‡ªå®šçš„æ•°æ®ç»“æ„ï¼Œå¦‚ï¼šlinked listsã€binary treesã€hash tableã€‚ç”¨Goè¯­è¨€ç”Ÿæˆéšæœºæ•°å’Œå¯†ç ã€æ‰§è¡Œé«˜æ€§èƒ½çš„çŸ©é˜µæ“ä½œç­‰ã€‚</p>
<p>è¿™ç« ä¸»è¦çš„é‡ç‚¹æ˜¯Go packagesï¼Œå®ƒæ˜¯ç”¨Goçš„æ–¹å¼ç»„ç»‡ã€äº¤ä»˜ã€ä½¿ç”¨ä»£ç ã€‚æœ€é‡è¦çš„é€šç”¨ç»„ä»¶å°±æ˜¯Go packageä¸­çš„å‡½æ•°ï¼Œå®ƒä½¿å¾—åœ¨Goè¯­è¨€ä¸­å˜å¾—å¯æ‰©å±•ã€‚ç´§æ¥ç€ï¼Œè¿™ç« å°†ä¼šè®²è§£Go modulesï¼Œè¿™æ˜¯å¸¦æœ‰ç‰ˆæœ¬å·çš„Go packagesã€‚åœ¨è¿™ç« çš„æœ€åï¼Œä½ å°†äº†è§£ä¸€äº›å±äºGoæ ‡å‡†åº“çš„packagesï¼Œä¸ºäº†æ›´å¥½çš„ç†è§£Go packagesçš„ä¸åŒçš„åˆ›å»ºæ–¹å¼ã€‚</p>
<p>æœ¬ç« ï¼Œä½ å°†å­¦åˆ°ä»¥ä¸‹ä¸»é¢˜ï¼š</p>
<ul>
<li>goå‡½æ•°å¼€å‘</li>
<li>åŒ¿åå‡½æ•°</li>
<li>å¤šè¿”å›å€¼å‡½æ•°</li>
<li>å‘½åå‡½æ•°è¿”å›å€¼</li>
<li>å‡½æ•°è¿”å›å…¶ä»–å‡½æ•°</li>
<li>å¯å˜å‚æ•°å‡½æ•°</li>
<li>å¼€å‘Go packages</li>
<li>ç”¨Go Moduleså¼€å‘å’Œå·¥ä½œ</li>
<li>ç§æœ‰å’Œå…¬æœ‰packageå¯¹è±¡</li>
<li>åœ¨packagesä½¿ç”¨<code>init()</code>å‡½æ•°</li>
<li>Goæ ‡å‡†åŒ…html/template</li>
<li>Goæ ‡å‡†åŒ…text/template</li>
<li>Goé«˜çº§åŒ…go/scanner, go/parser, go/token</li>
<li>Goæ ‡å‡†åŒ…syscallï¼Œåº•å±‚åŒ…ï¼Œè™½ç„¶ä½ å¯èƒ½ä¸ç›´æ¥ä½¿ç”¨ï¼Œä½†æ˜¯å®ƒå¹¿æ³›è¿ç”¨åœ¨å…¶ä»–çš„Go packages</li>
</ul>
<h1 id="å…³äºgo-package">å…³äºGo package</h1>
<p>ä»»ä½•å†…å®¹åœ¨Goè¯­è¨€ä¸­äº¤ä»˜éƒ½æ˜¯ä»¥packagesçš„å½¢å¼ã€‚Go packageæ˜¯ä¸€ä¸ªç”¨packageå…³é”®å­—å¼€å¤´ï¼Œåé¢è·Ÿç€åŒ…åçš„æºæ–‡ä»¶ã€‚ä¸€äº›packagesä¹Ÿæœ‰ç»“æ„ã€‚ä¾‹å¦‚netåŒ…æœ‰ä¸€ç³»åˆ—çš„å­ç›®å½•ï¼Œhttpã€mailã€rpcã€smtpã€textprotoã€urlã€‚è¿™äº›åŒ…å¯ä»¥ç”¨ <code>net/http, net/mail, net/rpc, net/smtp, net/textproto, net/url</code> çš„è¯­æ³•å½¢å¼å•ç‹¬ä½¿ç”¨ã€‚</p>
<p>ä¸ºäº†å’ŒGoæ ‡å‡†åº“åšåˆ†ç¦»ï¼Œå­˜åœ¨ä¸€äº›èƒ½å¤Ÿä½¿ç”¨å…¨è·¯å¾„å¯¼å…¥çš„å¤–éƒ¨åŒ…ï¼Œåœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨ä¹‹å‰ä¼šè¢«ä¸‹è½½ã€‚å¦‚<code>github.com/matryer/is</code>ï¼Œæ˜¯ä¸€ä¸ªGithubä»“åº“ã€‚</p>
<p>Packagesä¸»è¦ä½¿ç”¨äºå°†å‡½æ•°ã€å˜é‡ã€ å¸¸é‡åˆ†ç»„ã€‚ä¸ºçš„æ˜¯åœ¨ä½¿ç”¨è‡ªå·±çš„Goç¨‹åºæ—¶è¿ç§»è¿™äº›åˆ†ç»„æ›´åŠ ä¾¿æ·ã€‚æ³¨æ„ï¼Œé™¤äº†ä¸»è¦çš„main packageï¼Œå…¶ä»–Go packages ç¨‹åºä¸èƒ½å¤Ÿè¢«ç¼–è¯‘åˆ°å¯æ‰§è¡Œæ–‡ä»¶ã€‚è¿™æ„å‘³ç€å®ƒä»¬éœ€è¦è¢«main packageç›´æ¥æˆ–è€…é—´æ¥çš„å¼•ç”¨ã€‚å¦‚æœä½ æ‰§è¡Œä¸€ä¸ªè‡ªå·±çš„go packageï¼ˆä¸æ˜¯main packageï¼‰ã€‚å‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="err">$</span> <span class="k">go</span> <span class="nx">run</span> <span class="nx">aPackage</span><span class="p">.</span><span class="k">go</span>
<span class="k">go</span> <span class="nx">run</span><span class="p">:</span> <span class="nx">cannot</span> <span class="nx">run</span> <span class="nx">non</span><span class="o">-</span><span class="nx">main</span> <span class="kn">package</span>

</code></pre></div><h1 id="å…³äºgoå‡½æ•°">å…³äºGoå‡½æ•°</h1>
<p>å‡½æ•°åœ¨ä»»ä½•ç¼–ç¨‹è¯­è¨€ä¸­éƒ½æ˜¯éå¸¸é‡è¦çš„ä¸€ç¯ï¼Œå› ä¸ºå®ƒå…è®¸ä½ å¯ä»¥å°†å¤§çš„ç¨‹åºåˆ†å‰²æˆæ›´å°ã€æ›´ä¾¿äºç®¡ç†çš„éƒ¨åˆ†ã€‚å‡½æ•°å¿…é¡»å°½å¯èƒ½ç‹¬ç«‹ï¼Œå¿…é¡»åšå¥½ä¸€ä»¶å·¥ä½œï¼Œè€Œä¸”åªåšå¥½ä¸€ä»¶å·¥ä½œã€‚æ‰€ä»¥å¦‚æœä½ å‘ç°ä½ å†™ä¸€ä¸ªå‡½æ•°åšå¾ˆå¤šäº‹ï¼Œåº”è¯¥è€ƒè™‘ç”¨å¤šä¸ªå‡½æ•°å»æ›¿æ¢å®ƒã€‚ï¼ˆå•ä¸€èŒè´£åŸåˆ™ï¼‰</p>
<p>Goè¯­è¨€ä¸­æœ€æµè¡Œçš„å‡½æ•°å°±æ˜¯<code>main()</code>ï¼Œå®ƒæ˜¯æ¯ä¸ªç‹¬ç«‹çš„Goç¨‹åºéƒ½ä½¿ç”¨çš„ã€‚ä½ åº”è¯¥å·²ç»çŸ¥é“æ‰€æœ‰çš„å‡½æ•°å®šä¹‰éƒ½ä»¥<code>func</code>å…³é”®å­—å¼€å¤´ã€‚</p>
<h1 id="åŒ¿åå‡½æ•°">åŒ¿åå‡½æ•°</h1>
<p>åŒ¿åå‡½æ•°è¢«å®šä¹‰åœ¨å†…éƒ¨ï¼Œä¸éœ€è¦å‡½æ•°åï¼Œç»å¸¸ç”¨å®ƒæ¥å®ç°ä¸€æ®µä»£ç é‡å¾ˆå°‘çš„åŠŸèƒ½ã€‚åœ¨Goè¯­è¨€ä¸­ï¼Œå‡½æ•°èƒ½å¤Ÿè¿”å›ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œæˆ–è€…å°†ä¸€ä¸ªåŒ¿åå‡½æ•°ä½œä¸ºå‡½æ•°çš„ä¸€ä¸ªå‚æ•°ï¼Œæ­¤å¤–ï¼ŒåŒ¿åå‡½æ•°èƒ½å¤Ÿè¢«é™„åŠ åˆ°Goå˜é‡ã€‚æ³¨æ„åŒ¿åå‡½æ•°ä¹Ÿè¢«ç§°ä¸ºé—­åŒ…ï¼Œç‰¹åˆ«æ˜¯åœ¨å‡½æ•°å¼ç¼–ç¨‹æœ¯è¯­ä¸­ã€‚</p>
<blockquote>
<p>å¯¹äºä¸€ä¸ªåŒ¿åå‡½æ•°æ¥è¯´ï¼Œéœ€è¦å®ç°æœ€å°çš„ä¸€ä¸ªé‡ç‚¹ã€‚<strong>å¦‚æœåŒ¿åå‡½æ•°æ²¡æœ‰é‡ç‚¹ï¼Œä½ å°±è¦è€ƒè™‘å°†å®ƒæ”¹é€ ä¸ºä¸€ä¸ªå¸¸è§„çš„å‡½æ•°ã€‚</strong></p>
</blockquote>
<p>å½“ä¸€ä¸ªåŒ¿åå‡½æ•°åªæä¾›ä¸€ä¸ªåŠŸèƒ½æ—¶ï¼Œå®ƒç»å¯¹ä¼šä½¿ä½ çš„å·¥ä½œæ›´åŠ ç®€å•ä¾¿æ·ã€‚åªæ˜¯å¦‚æœæ²¡æœ‰åˆé€‚çš„åœºæ™¯æ—¶ï¼Œä¸è¦åœ¨ä½ çš„ç¨‹åºä¸­ä½¿ç”¨å¤ªå¤šçš„åŒ¿åå‡½æ•°ã€‚ç¨åä½ å°†ä¼šçœ‹åˆ°åŒ¿åå‡½æ•°çš„å®é™…ä½¿ç”¨ã€‚</p>
<h1 id="å¤šè¿”å›å€¼å‡½æ•°">å¤šè¿”å›å€¼å‡½æ•°</h1>
<p>å¦‚æœä½ å·²ç»çŸ¥é“äº†<code>strconv.Atoi()</code>å‡½æ•°ï¼Œæ­¤å‡½æ•°å¯ä»¥è¿”å›å¤šä¸ªä¸åŒçš„å€¼ï¼Œè¿™ä½¿æ‚¨ä¸å¿…ä¸ºå®ƒåˆ›å»ºä¸“ç”¨çš„ç»“æ„
ä¿å­˜å‡½æ•°è¿”å›çš„å¤šä¸ªå€¼ã€‚ä½ å¯ä»¥å®šä¹‰ä¸€ä¸ªè¿”å›4ä¸ªå€¼çš„å‡½æ•°ï¼Œå¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">aFunction</span><span class="p">()</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">float64</span><span class="p">,</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
<span class="p">}</span>
</code></pre></div><p>æ¥ä¸‹æ¥è§£é‡ŠåŒ¿åå‡½æ•°å’Œå¤šä¸ªè¿”å›å€¼çš„å‡½æ•°ï¼Œæ›´è¯¦ç»†å†…å®¹ä½¿ç”¨functions.goæ–‡ä»¶æ¥è¯´æ˜ï¼Œç”¨äº”éƒ¨åˆ†ä»£ç æ¥è¯´æ˜ã€‚</p>
<p>ç¬¬ä¸€éƒ¨åˆ†å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>
<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&#34;fmt&#34;</span>
    <span class="s">&#34;os&#34;</span>
    <span class="s">&#34;strconv&#34;</span>
    <span class="p">)</span>
</code></pre></div><p>ç¬¬äºŒéƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">doubleSquare</span><span class="p">(</span><span class="nx">x</span> <span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">x</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">x</span> <span class="o">*</span> <span class="nx">x</span>
<span class="p">}</span>
</code></pre></div><p>è¿™é‡Œæœ‰ä¸€ä¸ª<code>doubleSquare()</code>çš„å‡½æ•°ï¼Œå®ƒä¼ å…¥ä¸€ä¸ªintç±»å‹çš„å‚æ•°ï¼Œè¿”å›ä¸¤ä¸ªintç±»å‹çš„å€¼ï¼Œç¬¬ä¸‰éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">arguments</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Args</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">arguments</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;The program needs 1 argument!&#34;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="nx">y</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">strconv</span><span class="p">.</span><span class="nf">Atoi</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
    <span class="k">return</span>
 <span class="p">}</span>
</code></pre></div><p>ä¹‹å‰çš„ç¨‹åºæ˜¯ç”¨å‘½ä»¤è¡Œä¸­é™„åŠ çš„å‚æ•°æ¥å¤„ç†çš„ã€‚ç¬¬å››éƒ¨åˆ†åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"> <span class="nx">square</span> <span class="o">:=</span> <span class="kd">func</span><span class="p">(</span><span class="nx">s</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
 <span class="k">return</span> <span class="nx">s</span> <span class="o">*</span> <span class="nx">s</span>
 <span class="p">}</span>
 <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;The square of&#34;</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="s">&#34;is&#34;</span><span class="p">,</span> <span class="nf">square</span><span class="p">(</span><span class="nx">y</span><span class="p">))</span>
 <span class="nx">double</span> <span class="o">:=</span> <span class="kd">func</span><span class="p">(</span><span class="nx">s</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
 <span class="k">return</span> <span class="nx">s</span> <span class="o">+</span> <span class="nx">s</span>
 <span class="p">}</span>
 <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;The double of&#34;</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="s">&#34;is&#34;</span><span class="p">,</span> <span class="nf">double</span><span class="p">(</span><span class="nx">y</span><span class="p">))</span>
</code></pre></div><p>æ¯ä¸ªsquareå’ŒdoubleæŒ‡å‘ä¸€ä¸ªåŒ¿åå‡½æ•°çš„åœ°å€ã€‚ä¸å¤Ÿå¥½çš„éƒ¨åˆ†æ˜¯ä½ å¯ä»¥æ”¹å˜squareå’Œdoubleçš„å€¼ï¼Œæˆ–è€…å…¶ä»–å˜é‡åœ¨åŒ¿åå‡½æ•°å®šä¹‰ä¹‹åä¹Ÿå¯ä»¥æŒ‡å‘è¯¥åŒ¿åå‡½æ•°çš„åœ°å€ã€‚è¿™æ„å‘³ç€è¿™äº›å˜é‡èƒ½å¤Ÿæ”¹å˜å’Œè®¡ç®—å…¶ä»–å†…å®¹ã€‚</p>
<blockquote>
<p>æ”¹å˜ä¿å­˜åŒ¿åå‡½æ•°çš„å˜é‡ä»£ç ä¸æ˜¯å¥½çš„ç¼–ç¨‹å®è·µï¼Œå› ä¸ºè¿™å¯èƒ½æ˜¯äº§ç”Ÿbugçš„æ ¹æœ¬åŸå› ã€‚</p>
</blockquote>
<p>æœ€åä¸€éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nf">doubleSquare</span><span class="p">(</span><span class="nx">y</span><span class="p">))</span>
 <span class="nx">d</span><span class="p">,</span> <span class="nx">s</span> <span class="o">:=</span> <span class="nf">doubleSquare</span><span class="p">(</span><span class="nx">y</span><span class="p">)</span>
 <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span> <span class="nx">s</span><span class="p">)</span>
</code></pre></div><p>æ‰€ä»¥ï¼Œä½ èƒ½åŒæ—¶æ‰“å°å‡½æ•°çš„è¿”å›å€¼ï¼Œæˆ–è€…å°†å®ƒä»¬åˆ†é…ç»™å…¶ä»–å˜é‡ã€‚</p>
<p>æ‰§è¡Œfunctions.goåï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ go run functions.go <span class="m">1</span> <span class="m">21</span>
The program needs <span class="m">1</span> argument!
$ go run functions.go 10.2
strconv.Atoi: parsing <span class="s2">&#34;10.2&#34;</span>: invalid syntax
$ go run functions.go <span class="m">10</span>
The square of <span class="m">10</span> is <span class="m">100</span>
The double of <span class="m">10</span> is <span class="m">20</span>
<span class="m">20</span> <span class="m">100</span>
<span class="m">20</span> <span class="m">100</span>
</code></pre></div><h1 id="å‡½æ•°çš„è¿”å›å€¼å¯ä»¥è¢«å‘½å">å‡½æ•°çš„è¿”å›å€¼å¯ä»¥è¢«å‘½å</h1>
<p>ä¸åƒCè¯­è¨€ï¼ŒGoå…è®¸å°†å‡½æ•°çš„è¿”å›å€¼å‘½åã€‚å½“è¿™æ ·çš„å‡½æ•°æœ‰ä¸€ä¸ªä¸å¸¦ä»»ä½•å‚æ•°çš„returnè¯­å¥æ—¶ï¼Œ<strong>è¯¥å‡½æ•°ä¼šæŒ‰ç…§å‡½æ•°å®šä¹‰ä¸­å£°æ˜çš„é¡ºåºè‡ªåŠ¨è¿”å›æ¯ä¸ªå‘½åçš„è¿”å›å€¼çš„å½“å‰å€¼ã€‚</strong></p>
<p>returnNames.goæºç å°†ä¼šè¯´æ˜ï¼Œå·²ç»å‘½åäº†è¿”å›å€¼çš„å‡½æ•°æ˜¯æ€æ ·å·¥ä½œçš„ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
 <span class="s">&#34;fmt&#34;</span>
 <span class="s">&#34;os&#34;</span>
 <span class="s">&#34;strconv&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">namedMinMax</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span> <span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="nx">min</span><span class="p">,</span> <span class="nx">max</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nx">x</span> <span class="p">&gt;</span> <span class="nx">y</span> <span class="p">{</span>
        <span class="nx">min</span> <span class="p">=</span> <span class="nx">y</span>
        <span class="nx">max</span> <span class="p">=</span> <span class="nx">x</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">min</span> <span class="p">=</span> <span class="nx">x</span>
        <span class="nx">max</span> <span class="p">=</span> <span class="nx">y</span>
    <span class="p">}</span>
    <span class="k">return</span>
<span class="p">}</span>
</code></pre></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å®ç°äº†<code>namedMinMax()</code>çš„å‡½æ•°ï¼Œå®ƒä½¿ç”¨äº†å·²ç»å‘½åçš„è¿”å›å‚æ•°ã€‚ç„¶è€Œï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå®¹æ˜“å‡ºé”™çš„åœ°æ–¹ï¼š<code>namedMinMax()</code>å‡½æ•°åœ¨å®ƒçš„returnè¯­å¥ä¸­ï¼Œä¸èƒ½æ˜ç¡®çš„è¿”å›ä¸€äº›å˜é‡æˆ–å€¼ã€‚å°½ç®¡å¦‚æ­¤ï¼Œå½“å‡½æ•°åœ¨å‘½åæ—¶æŒ‡å®šäº†è¿”å›å€¼ï¼Œminå’Œmaxå‚æ•°å°†æŒ‰ç…§å®ƒä»¬æ”¾å…¥å‡½æ•°å®šä¹‰çš„é¡ºåºè‡ªåŠ¨è¿”å›ã€‚</p>
<p>ç¬¬äºŒæ®µä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">minMax</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span> <span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="nx">min</span><span class="p">,</span> <span class="nx">max</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nx">x</span> <span class="p">&gt;</span> <span class="nx">y</span> <span class="p">{</span>
        <span class="nx">min</span> <span class="p">=</span> <span class="nx">y</span>
        <span class="nx">max</span> <span class="p">=</span> <span class="nx">x</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">min</span> <span class="p">=</span> <span class="nx">x</span>
        <span class="nx">max</span> <span class="p">=</span> <span class="nx">y</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">min</span><span class="p">,</span> <span class="nx">max</span>
<span class="p">}</span>
</code></pre></div><p><code>minMax()</code>å‡½æ•°ä¹Ÿå‘½åäº†è¿”å›å€¼ï¼Œä½†æ˜¯å®ƒçš„returnè¯­å¥æ˜ç¡®å®šä¹‰äº†è¿”å›çš„é¡ºåºå’Œå˜é‡ã€‚</p>
<p>æœ€åä¸€éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">arguments</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Args</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">arguments</span><span class="p">)</span> <span class="p">&lt;</span> <span class="mi">3</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;The program needs at least 2 arguments!&#34;</span><span class="p">)</span>
    <span class="k">return</span>
    <span class="p">}</span>
    <span class="nx">a1</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">strconv</span><span class="p">.</span><span class="nf">Atoi</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="nx">a2</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">strconv</span><span class="p">.</span><span class="nf">Atoi</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nf">minMax</span><span class="p">(</span><span class="nx">a1</span><span class="p">,</span> <span class="nx">a2</span><span class="p">))</span>
    <span class="nx">min</span><span class="p">,</span> <span class="nx">max</span> <span class="o">:=</span> <span class="nf">minMax</span><span class="p">(</span><span class="nx">a1</span><span class="p">,</span> <span class="nx">a2</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">min</span><span class="p">,</span> <span class="nx">max</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nf">namedMinMax</span><span class="p">(</span><span class="nx">a1</span><span class="p">,</span> <span class="nx">a2</span><span class="p">))</span>
    <span class="nx">min</span><span class="p">,</span> <span class="nx">max</span> <span class="p">=</span> <span class="nf">namedMinMax</span><span class="p">(</span><span class="nx">a1</span><span class="p">,</span> <span class="nx">a2</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">min</span><span class="p">,</span> <span class="nx">max</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><p><code>main()</code>å‡½æ•°çš„ç›®çš„æ˜¯ä¸ºäº†éªŒè¯æ‰€æœ‰çš„æ–¹æ³•æ‰§è¡Œçš„ç»“æœæ˜¯å¦ç›¸åŒã€‚</p>
<p>æœ€åä¸€æ®µä»£ç æ‰§è¡Œåè¾“å…¥å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ go run returnNames.go -20 <span class="m">1</span>
-20 <span class="m">1</span>
-20 <span class="m">1</span>
-20 <span class="m">1</span>
-20 <span class="m">1</span>
</code></pre></div><h1 id="å¸¦æœ‰æŒ‡é’ˆå‚æ•°çš„å‡½æ•°">å¸¦æœ‰æŒ‡é’ˆå‚æ•°çš„å‡½æ•°</h1>
<p>åªè¦ç­¾åå…è®¸ï¼Œå‡½æ•°å¯ä»¥æ¥å—æŒ‡é’ˆå½¢å‚ã€‚ptrFun.goå°†ä¼šè®²è§£å¦‚ä½•åœ¨å‡½æ•°ä¸­ä½¿ç”¨æŒ‡é’ˆã€‚</p>
<p>ç¬¬ä¸€éƒ¨åˆ†:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>
<span class="kn">import</span> <span class="p">(</span>
 <span class="s">&#34;fmt&#34;</span>
<span class="p">)</span>
<span class="kd">func</span> <span class="nf">getPtr</span><span class="p">(</span><span class="nx">v</span> <span class="o">*</span><span class="kt">float64</span><span class="p">)</span> <span class="kt">float64</span> <span class="p">{</span>
 <span class="k">return</span> <span class="o">*</span><span class="nx">v</span> <span class="o">*</span> <span class="o">*</span><span class="nx">v</span>
<span class="p">}</span>
</code></pre></div><p><code>getPtr()</code>å‡½æ•°æ¥æ”¶ä¸€ä¸ªå€¼æŒ‡å‘ç±»å‹ä¸ºfloat64çš„æŒ‡é’ˆå˜é‡ã€‚ç¬¬äºŒéƒ¨åˆ†ä»£ç å±•ç¤ºå¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
 <span class="nx">x</span> <span class="o">:=</span> <span class="mf">12.2</span>
 <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nf">getPtr</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">x</span><span class="p">))</span>
 <span class="nx">x</span> <span class="p">=</span> <span class="mi">12</span>
 <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nf">getPtr</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">x</span><span class="p">))</span>
<span class="p">}</span>
</code></pre></div><p>æ¯”è¾ƒå¤æ‚çš„éƒ¨åˆ†æ˜¯å‡½æ•°å‚æ•°ä¸­éœ€è¦ä¼ å…¥å˜é‡çš„åœ°å€ï¼Œå› ä¸ºå®ƒæ˜¯æŒ‡é’ˆå‚æ•°æ‰€éœ€è¦çš„ç±»å‹ã€‚é€šè¿‡åœ¨å˜é‡å‰åŠ &quot;&amp;&ldquo;ç¬¦å·å®ç°ã€‚</p>
<p>æ‰§è¡Œ<code>ptrFun.go</code>åå°†ç”Ÿæˆå¦‚ä¸‹è¾“å‡ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ go run ptrFun.go
148.83999999999997
<span class="m">144</span>

</code></pre></div><p>å¦‚æœæƒ³ä¼ å…¥ä¸€ä¸ªç®€å•çš„å€¼åˆ°<code>getPtr()</code>å‡½æ•°ä¸­è°ƒç”¨ï¼Œç±»ä¼¼äº<code>getPtr(12.12)</code>ã€‚è¿™æ ·ç¨‹åºå°†ä¼šå¤±è´¥ï¼Œå¹¶å‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ go run ptrFun.go
<span class="c1"># command-line-arguments</span>
./ptrFun.go:15:21: cannot use 12.12 <span class="o">(</span><span class="nb">type</span> float64<span class="o">)</span> as <span class="nb">type</span> *float64 in argument to getPtr
</code></pre></div><h1 id="è¿”å›æŒ‡é’ˆçš„å‡½æ•°">è¿”å›æŒ‡é’ˆçš„å‡½æ•°</h1>
<p>ä»ç¬¬å››ç« å¼€å§‹ï¼Œ<code>pointerStruct.go</code>æ–‡ä»¶å°±ç”¨æ¥ä½œä¸ºæ¡ˆä¾‹ä»£ç ã€‚å¯¹äºå¤åˆç±»å‹çš„ä½¿ç”¨ï¼Œæœ€å¥½çš„åšæ³•æ˜¯ä½¿ç”¨å•ç‹¬çš„å‡½æ•°åˆ›å»ºæ–°çš„ç»“æ„å˜é‡ï¼Œå¹¶ä»è¯¥å‡½æ•°è¿”å›æŒ‡å‘å®ƒä»¬çš„æŒ‡é’ˆã€‚æ‰€ä»¥ï¼Œå‡½æ•°è¿”å›æŒ‡é’ˆæ˜¯å¾ˆå¸¸è§çš„ã€‚é€šå¸¸æ¥è¯´ï¼Œè¿™ç§å‡½æ•°ç®€åŒ–äº†ç¨‹åºç»“æ„ï¼Œå¹¶ä¸”å…è®¸å¼€å‘è€…é›†ä¸­äºæ›´å¤šé‡è¦çš„äº‹æƒ…ä¸Šï¼Œè€Œä¸æ˜¯æ€»æ˜¯å¤åˆ¶ä¸€äº›ç›¸åŒçš„ä»£ç ç‰‡æ®µã€‚(<code>Ctrl+C</code>å’Œ<code>Ctrl+v</code>ï¼Œé€ å°±äº†ä¸€ä»£åˆä¸€ä»£çš„ç¨‹åºå‘˜ï¼Œçš®ä¸€ä¸‹)ã€‚æ¥ä¸‹æ¥å°†é€šè¿‡<code>pointerStruct.go</code>çš„ä»£ç æ¥è¯´æ˜æœ¬å°èŠ‚çš„å†…å®¹ã€‚ç¬¬ä¸€éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
 <span class="s">&#34;fmt&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">returnPtr</span><span class="p">(</span><span class="nx">x</span> <span class="kt">int</span><span class="p">)</span> <span class="o">*</span><span class="kt">int</span> <span class="p">{</span>
    <span class="nx">y</span> <span class="o">:=</span> <span class="nx">x</span> <span class="o">*</span> <span class="nx">x</span>
    <span class="k">return</span> <span class="o">&amp;</span><span class="nx">y</span>
<span class="p">}</span>
</code></pre></div><p>è¿™ä¸ªå‡½æ•°è¿”å›äº†ä¸€ä¸ªæŒ‡å‘<code>int</code>å˜é‡çš„æŒ‡é’ˆã€‚å”¯ä¸€çš„åŠŸèƒ½å°±æ˜¯ä½¿ç”¨<code>&amp;y</code>è¿”å›yå˜é‡çš„å†…å­˜åœ°å€ã€‚ç¬¬äºŒéƒ¨åˆ†å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
 <span class="nx">sq</span> <span class="o">:=</span> <span class="nf">returnPtr</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
 <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;sq value:&#34;</span><span class="p">,</span> <span class="o">*</span><span class="nx">sq</span><span class="p">)</span>
</code></pre></div><p><code>â€œ*â€</code>è¿™ä¸ªç¬¦å·å¯ä»¥å¾—åˆ°æŒ‡é’ˆå˜é‡çš„å€¼ï¼Œè¿™æ„å‘³ç€å®ƒè¿”å›äº†ä¸€ä¸ªåœ¨å†…å­˜åœ°å€ä¸­å®é™…ä»£è¡¨çš„å€¼ã€‚ï¼ˆè€Œä¸æ˜¯å€¼çš„åœ°å€ï¼‰ï¼Œæœ€åä¸€æ®µä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;sq memory address:&#34;</span><span class="p">,</span> <span class="nx">sq</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><p>å‰é¢çš„ä»£ç å°†è¿”å›sqå˜é‡çš„å†…å­˜åœ°å€ã€‚è€Œä¸æ˜¯å­˜åœ¨å…¶å†…å­˜ä¸­çš„å€¼ã€‚</p>
<p>å¦‚æœæ‰§è¡Œ<code>returnPtr.go</code>ï¼Œä½ å°†çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºã€‚ä¸åŒçš„å†…å­˜åœ°å€ï¼Œï¼ˆå› ä¸ºæˆ‘ä»¬åœ¨ä¸åŒçš„æœºå™¨æ‰§è¡Œï¼Œæ‰€ä»¥å˜é‡å†…å­˜ä¸ä¸€å®šåˆ†é…åœ¨å“ªä¸€ç‰‡æ®µï¼‰</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ go run returnPtr.go
sq value: <span class="m">100</span>
sq memory address: 0xc00009a000
</code></pre></div><h1 id="è¿”å›å…¶ä»–å‡½æ•°çš„å‡½æ•°">è¿”å›å…¶ä»–å‡½æ•°çš„å‡½æ•°</h1>
<p>åœ¨è¿™ä¸ªç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¸€èµ·å­¦ä¹ å¦‚ä½•ç”¨Goè¯­è¨€å®ç°ä¸€ä¸ªè¿”å›å…¶ä»–å‡½æ•°çš„å‡½æ•°ã€‚åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†å±•ç¤ºï¼Œç¬¬ä¸€éƒ¨åˆ†<code>returnFunction.go</code>å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>
<span class="kn">import</span> <span class="p">(</span>
 <span class="s">&#34;fmt&#34;</span>
<span class="p">)</span>
<span class="kd">func</span> <span class="nf">funReturnFun</span><span class="p">()</span> <span class="kd">func</span><span class="p">()</span> <span class="kt">int</span> <span class="p">{</span>
    <span class="nx">i</span> <span class="o">:=</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="kd">func</span><span class="p">()</span> <span class="kt">int</span> <span class="p">{</span>
        <span class="nx">i</span><span class="o">++</span>
        <span class="k">return</span> <span class="nx">i</span> <span class="o">*</span> <span class="nx">i</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>funReturnFun()</code>çš„å®ç°ï¼Œå®ƒçš„è¿”å›å€¼æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°<code>function (func() int)</code>ã€‚</p>
<p>ç¬¬äºŒéƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
 <span class="nx">i</span> <span class="o">:=</span> <span class="nf">funReturnFun</span><span class="p">()</span>
 <span class="nx">j</span> <span class="o">:=</span> <span class="nf">funReturnFun</span><span class="p">()</span>
</code></pre></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œè°ƒç”¨funReturnFun()ä¸¤æ¬¡ï¼Œå¹¶å°†å…¶è¿”å›å€¼(ä¸€ä¸ªå‡½æ•°)èµ‹ç»™ä¸¤ä¸ªç‹¬ç«‹çš„å˜é‡iå’Œjã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¨‹åºè¾“å‡ºä¸­ï¼Œè¿™ä¸¤ä¸ªå˜é‡å®Œå…¨ä¸ç›¸å…³ã€‚æœ€åä¸€éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;1:&#34;</span><span class="p">,</span> <span class="nf">i</span><span class="p">())</span>
 <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;2:&#34;</span><span class="p">,</span> <span class="nf">i</span><span class="p">())</span>
 <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;j1:&#34;</span><span class="p">,</span> <span class="nf">j</span><span class="p">())</span>
 <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;j2:&#34;</span><span class="p">,</span> <span class="nf">j</span><span class="p">())</span>
 <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;3:&#34;</span><span class="p">,</span> <span class="nf">i</span><span class="p">())</span>
<span class="p">}</span>
</code></pre></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œä½¿ç”¨iå˜é‡3æ¬¡ï¼Œjå˜é‡2æ¬¡ã€‚ä½†æ˜¯å°½ç®¡iå’Œjéƒ½æ˜¯é€šè¿‡<code>funReturnFun()å‡½æ•°</code>è¢«åˆ›å»ºã€‚ä½†æ˜¯ä»–ä»¬å½¼æ­¤ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œæ²¡æœ‰ä»»ä½•ç›¸åŒä¹‹å¤„ã€‚</p>
<p>æ‰§è¡Œä»£ç åè¾“å‡ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="err">$</span> <span class="k">go</span> <span class="nx">run</span> <span class="nx">returnFunction</span><span class="p">.</span><span class="k">go</span>
<span class="mi">1</span><span class="p">:</span> <span class="mi">1</span>
<span class="mi">2</span><span class="p">:</span> <span class="mi">4</span>
<span class="nx">j1</span><span class="p">:</span> <span class="mi">1</span>
<span class="nx">j2</span><span class="p">:</span> <span class="mi">4</span>
<span class="mi">3</span><span class="p">:</span> <span class="mi">9</span>
</code></pre></div><p>ä»è¾“å‡ºå†…å®¹å¯ä»¥çœ‹å‡ºï¼Œåœ¨æ¯ä¸€æ¬¡è°ƒç”¨i()æˆ–j()ä¹‹åï¼Œiçš„å€¼ä¿æŒè‡ªå¢æ²¡æœ‰å˜ä¸º0ï¼Œ</p>
<h1 id="å°†å‡½æ•°ä½œä¸ºå‚æ•°çš„å‡½æ•°">å°†å‡½æ•°ä½œä¸ºå‚æ•°çš„å‡½æ•°</h1>
<p>Goå‡½æ•°èƒ½å¤Ÿæ¥å—å…¶ä»–Goå‡½æ•°ä½œä¸ºå…¶å‚æ•°ï¼Œå®ƒçš„ç‰¹å¾æ˜¯èƒ½å¤Ÿæ·»åŠ å…¶ä»–Goå‡½æ•°å®ç°çš„å…¶ä»–ç”¨é€”ã€‚ä¸¤ä¸ªæœ€å¸¸ç”¨çš„åŠŸèƒ½å°±æ˜¯å…ƒç´ æ’åºå’Œ<code>filepath.Walk()</code>å‡½æ•°ã€‚ç„¶è€Œï¼Œåœ¨å±•ç¤ºå‡ºçš„ä¾‹å­ä¸­ï¼Œå®ƒè¢«å‘½åä¸º<code>funFun.go</code>ã€‚æˆ‘ä»¬å°†å®ç°æœ€ç®€å•çš„å¤„ç†intå€¼çš„ä¾‹å­ã€‚æœ‰å…³å®ç°å°†åˆ†ä¸ºä¸‰éƒ¨åˆ†å®ç°ã€‚</p>
<p>ç¬¬ä¸€éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="s">&#34;fmt&#34;</span>

<span class="kd">func</span> <span class="nf">function1</span><span class="p">(</span><span class="nx">i</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">i</span> <span class="o">+</span> <span class="nx">i</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="nf">function2</span><span class="p">(</span><span class="nx">i</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">i</span> <span class="o">*</span> <span class="nx">i</span>
<span class="p">}</span>
</code></pre></div><p>æˆ‘ä»¬æœ‰ä¸¤ä¸ªå‡½æ•°éƒ½æ¥æ”¶intè¿”å›intã€‚è¿™äº›å‡½æ•°å°†åœ¨ä¸€æ®µæ—¶é—´å†…è¢«ä½œä¸ºå…¶ä»–å‡½æ•°çš„å‚æ•°æ¥ä½¿ç”¨ã€‚ç¬¬äºŒéƒ¨åˆ†ä»£ç å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">funFun</span><span class="p">(</span><span class="nx">f</span> <span class="kd">func</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">v</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
 <span class="k">return</span> <span class="nf">f</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><p><code>funFun()</code>å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªåä¸ºfçš„å‡½æ•°å‚æ•°ï¼Œä¸€ä¸ªåä¸ºvçš„intå‚æ•°ã€‚få½¢å‚åº”è¯¥æ˜¯ä¸€ä¸ªæ¥å—intå½¢å‚å¹¶è¿”å›ä¸€ä¸ªintå€¼çš„å‡½æ•°ã€‚æœ€åä¸€éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;function1:&#34;</span><span class="p">,</span> <span class="nf">funFun</span><span class="p">(</span><span class="nx">function1</span><span class="p">,</span> <span class="mi">123</span><span class="p">))</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;function2:&#34;</span><span class="p">,</span> <span class="nf">funFun</span><span class="p">(</span><span class="nx">function2</span><span class="p">,</span> <span class="mi">123</span><span class="p">))</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Inline:&#34;</span><span class="p">,</span> <span class="nf">funFun</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">i</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span><span class="k">return</span> <span class="nx">i</span> <span class="o">*</span> <span class="nx">i</span> <span class="o">*</span> <span class="nx">i</span><span class="p">},</span> <span class="mi">123</span><span class="p">))</span>
<span class="p">}</span>
</code></pre></div><p>The first fmt.Println() call uses funFun() with function1, without any parentheses,
as its first parameter, whereas the second fmt.Println() call uses funFun() with
function2 as its first parameter.</p>
<p>ç¬¬ä¸€ä¸ª<code>fmt.Println()</code>è°ƒç”¨<code>funFun()</code>ï¼Œç”¨ä¸å¸¦ä»»ä½•åœ†æ‹¬å·çš„<code>function1</code>ä½œä¸ºç¬¬ä¸€ä¸ªå½¢å‚ï¼Œè€Œç¬¬äºŒä¸ª<code>fmt.Println()</code>è°ƒç”¨<code>funFun()</code>å’Œ<code>function2</code>ä½œä¸ºå½¢å‚ã€‚</p>
<p>æœ€åä¸€ä¸ª<code>fmt.Println()</code>è¯­å¥ï¼Œæœ‰è¶£çš„äº‹æƒ…å‘ç”Ÿäº†ï¼Œå‡½æ•°çš„å®ç°æ”¾åœ¨äº†æ–¹æ³•<code>funFun()</code>ç¬¬ä¸€ä¸ªå‚æ•°çš„ä½ç½®ä¸Šï¼Œå°½ç®¡è¿™ç§æ–¹æ³•é€‚ç”¨äºç®€å•å’ŒåŠŸèƒ½å°çš„å‡½æ•°å‚æ•°ã€‚ä½†æ˜¯å¯¹äºåŒ…å«è®¸å¤šè¡ŒGoä»£ç çš„å‡½æ•°æ¥è¯´å°±ä¸é‚£ä¹ˆå¥½äº†ã€‚</p>
<p>æ‰§è¡Œä»£ç è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ go run funFun.go
function1: <span class="m">246</span>
function2: <span class="m">15129</span>
Inline: <span class="m">1860867</span>
</code></pre></div><h1 id="å‚æ•°å¯å˜å‡½æ•°">å‚æ•°å¯å˜å‡½æ•°</h1>
<p>Goä¹Ÿæ”¯æŒ<strong>å‚æ•°å¯å˜å‡½æ•°</strong>ï¼Œè¿™äº›å‡½æ•°èƒ½å¤Ÿæ¥æ”¶å¯å˜çš„å‚æ•°ä¸ªæ•°ã€‚æœ€ä¸ºæµè¡Œçš„å‡½æ•°åœ¨<code>fmt</code>åŒ…ä¸­å¯ä»¥æ‰¾åˆ°ã€‚æ¥ä¸‹æ¥é€šè¿‡<code>variadic.go</code>æ¥è®²è§£ã€‚å°†åˆ†3éƒ¨åˆ†å±•ç¤ºï¼Œç¬¬ä¸€éƒ¨åˆ†å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
 <span class="s">&#34;fmt&#34;</span>
 <span class="s">&#34;os&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">varFunc</span><span class="p">(</span><span class="nx">input</span> <span class="o">...</span><span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><p>è¿™éƒ¨åˆ†å±•ç¤ºäº†å‚æ•°å¯å˜(å˜é•¿)å‡½æ•°<code>varFunc()</code>çš„å®ç°ï¼Œå®ƒæ¥æ”¶stringç±»å‹çš„å¯å˜å‚æ•°ã€‚ä¼ å…¥çš„å‚æ•°<code>input</code>åœ¨å‡½æ•°<code>varFunc()</code>å‡½æ•°å†…éƒ¨ä½œä¸ºåˆ‡ç‰‡ä½¿ç”¨ã€‚è€Œâ€œ&hellip;â€æ“ä½œå«åšåŒ…è£…æ“ä½œã€‚è€Œæ‹†åŒ…æ“ä½œä»¥â€œ&hellip;â€ç»“å°¾ï¼Œä»¥åˆ‡ç‰‡ç±»å‹å¼€å§‹ã€‚å¯ä»¥å‚æ•°å‡½æ•°çš„åŒ…è£…æ“ä½œæœ€å¤šä¸€æ¬¡ã€‚ç¬¬äºŒéƒ¨åˆ†ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">oneByOne</span><span class="p">(</span><span class="nx">message</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">s</span> <span class="o">...</span><span class="kt">int</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span>
    <span class="nx">sum</span> <span class="o">:=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">a</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">s</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">a</span><span class="p">)</span>
        <span class="nx">sum</span> <span class="p">=</span> <span class="nx">sum</span> <span class="o">+</span> <span class="nx">a</span>
    <span class="p">}</span>
    <span class="nx">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">=</span> <span class="o">-</span><span class="mi">1000</span>
    <span class="k">return</span> <span class="nx">sum</span>
<span class="p">}</span>
</code></pre></div><p>è¿™é‡Œä½ èƒ½çœ‹åˆ°å…¶ä»–å¯å˜å‚æ•°å‡½æ•°<code>oneByOne()</code>ï¼Œå®ƒæ¥æ”¶å•ä¸ªstringå’Œä¸€ä¸ªintç±»å‹çš„å¯å˜å‚æ•°ã€‚å½¢å‚så…¶å®å°±æ˜¯ä¸€ä¸ªåˆ‡ç‰‡ã€‚æœ€åä¸€éƒ¨åˆ†ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">arguments</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Args</span>
    <span class="nf">varFunc</span><span class="p">(</span><span class="nx">arguments</span><span class="o">...</span><span class="p">)</span>
    <span class="nx">sum</span> <span class="o">:=</span> <span class="nf">oneByOne</span><span class="p">(</span><span class="s">&#34;Adding numbers...&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Sum:&#34;</span><span class="p">,</span> <span class="nx">sum</span><span class="p">)</span>
    <span class="nx">s</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">int</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">}</span>
    <span class="nx">sum</span> <span class="p">=</span> <span class="nf">oneByOne</span><span class="p">(</span><span class="s">&#34;Adding numbers...&#34;</span><span class="p">,</span> <span class="nx">s</span><span class="o">...</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><p><code>main</code>å‡½æ•°ä¸­ä½¿ç”¨äº†2ä¸ªå¯å˜å‚æ•°å‡½æ•°ã€‚å¯¹ç¬¬äºŒä¸ªå‡½æ•°<code>oneByOne()</code>ä½¿ç”¨äº†åˆ‡ç‰‡ã€‚å¯¹å¯å˜å‚æ•°å‡½æ•°å†…çš„åˆ‡ç‰‡æ‰€åšçš„ä»»ä½•æ›´æ”¹åœ¨å‡½æ•°é€€å‡ºåä»å°†ä¿ç•™ã€‚</p>
<p>æ‰§è¡Œä»£ç åè¾“å‡ºå¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ ./variadic <span class="m">1</span> <span class="m">2</span>
<span class="o">[</span>./variadic <span class="m">1</span> 2<span class="o">]</span>
Adding numbers...
<span class="m">0</span> <span class="m">1</span>
<span class="m">1</span> <span class="m">2</span>
<span class="m">2</span> <span class="m">3</span>
<span class="m">3</span> <span class="m">4</span>
<span class="m">4</span> <span class="m">5</span>
<span class="m">5</span> -1
<span class="m">6</span> <span class="m">10</span>
Sum: <span class="m">24</span>
Adding numbers...
<span class="m">0</span> <span class="m">1</span>
<span class="m">1</span> <span class="m">2</span>
<span class="m">2</span> <span class="m">3</span>
<span class="o">[</span>-1000 <span class="m">2</span> 3<span class="o">]</span>
</code></pre></div><h1 id="å¼€å‘è‡ªå·±çš„go-packages">å¼€å‘è‡ªå·±çš„Go packages</h1>
<p>Go packageçš„æºç ï¼Œå¯ä»¥åŒ…å«å¤šä¸ªæ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼Œèƒ½å¤Ÿåœ¨ä»¥åŒ…åå‘½åçš„å•ä¸ªç›®å½•å†…æ‰¾åˆ°ã€‚é™¤äº†æ˜¾è€Œæ˜“è§çš„mainåŒ…å¯ä»¥æ”¾åœ¨ä»»ä½•åœ°æ–¹ã€‚è¿™ç« çš„ç›®æ ‡ï¼Œæˆ‘ä»¬å°†å¼€å‘ä¸€ä¸ªåä¸º<code>aPackage</code>çš„Go packageã€‚åŒ…çš„æºæ–‡ä»¶ä¸º<code>aPackage.go</code>ï¼Œå®ƒçš„æºç åˆ†ä¸¤éƒ¨åˆ†å±•ç¤ºã€‚ç¬¬ä¸€éƒ¨åˆ†å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">aPackage</span>

<span class="kn">import</span> <span class="p">(</span>
 <span class="s">&#34;fmt&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">A</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;This is function A!&#34;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><p>åœ¨Go packageä¸­æ³¨æ„ä½¿ç”¨é¦–å†™å­—æ¯å¤§å†™ã€‚åœ¨è¿™é‡Œçš„<code>â€“ aPackage</code>ä»…ä»…æ˜¯ä½œä¸ºä¾‹å­åœ¨ä½¿ç”¨ã€‚ç¬¬äºŒéƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">B</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;privateConstant:&#34;</span><span class="p">,</span> <span class="nx">privateConstant</span><span class="p">)</span>
<span class="p">}</span>
<span class="kd">const</span> <span class="nx">MyConstant</span> <span class="p">=</span> <span class="mi">123</span>
<span class="kd">const</span> <span class="nx">privateConstant</span> <span class="p">=</span> <span class="mi">21</span>
</code></pre></div><p>å¯ä»¥çœ‹å‡ºï¼Œå¼€å‘ä¸€ä¸ªæ–°çš„Go packageéå¸¸ç®€å•ã€‚å½“å‰ï¼Œä½ ä¸èƒ½å•ç‹¬ä½¿ç”¨è¿™ä¸ªåŒ…ï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ªåä¸ºmainçš„åŒ…ï¼Œå…¶ä¸­åŒ…å«main()å‡½æ•°ï¼Œä»¥ä¾¿åˆ›å»ºä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°†ä½¿ç”¨aPackageçš„ä½œä¸ºusepackage.goçš„åŒ…å</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
 <span class="s">&#34;aPackage&#34;</span>
 <span class="s">&#34;fmt&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Using aPackage!&#34;</span><span class="p">)</span>
    <span class="nx">aPackage</span><span class="p">.</span><span class="nf">A</span><span class="p">()</span>
    <span class="nx">aPackage</span><span class="p">.</span><span class="nf">B</span><span class="p">()</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">aPackage</span><span class="p">.</span><span class="nx">MyConstant</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><p>å¦‚æœæ­¤æ—¶æ‰§è¡Œï¼Œä¼šå¾—åˆ°ä»¥ä¸‹é”™è¯¯ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬çš„ç¨‹åºè¿˜æ²¡æœ‰å®Œæˆã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ go run useAPackage.go
useAPackage.go:4:2: cannot find package <span class="s2">&#34;aPackage&#34;</span> in any of:
 /usr/local/Cellar/go/1.9.2/libexec/src/aPackage <span class="o">(</span>from <span class="nv">$GOROOT</span><span class="o">)</span>
 /Users/mtsouk/go/src/aPackage <span class="o">(</span>from <span class="nv">$GOPATH</span><span class="o">)</span>
</code></pre></div><p>è¿™é‡Œæœ‰å¦å¤–ä¸€ä»¶äº‹æƒ…éœ€è¦æˆ‘ä»¬å¤„ç†ã€‚å‡è®¾ä½ å·²ç»çŸ¥é“äº†ç¬¬ä¸€ç« çš„å†…å®¹å’Œæ“ä½œç³»ç»Ÿçš„çŸ¥è¯†ã€‚Goéœ€è¦åœ¨UNIXä¸­æ‰§è¡Œä¸€äº›ç‰¹æ®Šçš„shellå‘½ä»¤æ¥ä¸‹è½½æ‰€æœ‰çš„å¤–éƒ¨åŒ…ï¼Œå…¶ä¸­ä¹ŸåŒ…å«äº†ä½ æœ¬åœ°å¼€å‘çš„åŒ…ã€‚å› æ­¤ï¼Œåœ¨æ‰“åŒ…ä¹‹å‰ä½ è¦ç¡®ä¿å½“å‰çš„UNIXçš„ç”¨æˆ·æ˜¯å¯ç”¨çš„ï¼Œå¹¶ä¸”å°†ä¹‹å‰çš„åŒ…æ”¾åœ¨åˆé€‚çš„è·¯åŠ²ä¸‹ã€‚å› æ­¤ï¼Œä¸‹è½½ä½ è‡ªå·±çš„åŒ…æ¶‰åŠåˆ°æ‰§è¡Œä»¥ä¸‹UNIXçš„shellå‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ mkdir ~/go/src/aPackage
$ cp aPackage.go ~/go/src/aPackage/
$ go install aPackage
$ <span class="nb">cd</span> ~/go/pkg/darwin_amd64/
$ ls -l aPackage.a
-rw-r--r-- <span class="m">1</span> mtsouk staff <span class="m">4980</span> Dec <span class="m">22</span> 06:12 aPackage.a
</code></pre></div><blockquote>
<p>å¦‚æœ ~/go æ–‡ä»¶å¤¹ä¸æ˜¯å·²ç»å­˜åœ¨çš„, ä½ å°†éœ€è¦ç”¨<code>mkdir</code>å‘½ä»¤åˆ›å»ºä¸€ä¸ªã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ã€‚ä½ å°†éœ€è¦å’Œ <code>~/go/src</code>ç›¸ä¼¼çš„ç›®å½•ï¼Œä»£ç æ‰§è¡Œåå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ go run useAPackage.go
Using aPackage!
This is <span class="k">function</span> A!
privateConstant: <span class="m">21</span>
<span class="m">123</span>
</code></pre></div><h1 id="ç¼–è¯‘ä¸€ä¸ªgo-package">ç¼–è¯‘ä¸€ä¸ªGo package</h1>
<p>è™½ç„¶ä½ ä¸èƒ½æ‰§è¡Œä¸åœ¨mainå‡½æ•°å†…çš„Go packageï¼Œä½†æ˜¯ä½ ä»ç„¶å¯ä»¥ç¼–è¯‘å’Œåˆ›å»ºå¯¹åº”çš„ç›®æ ‡æ–‡ä»¶ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ go tool compile aPackage.go
$ ls -l aPackage.*
-rw-r--r--@ <span class="m">1</span> mtsouk staff <span class="m">201</span> Jan <span class="m">10</span> 22:08 aPackage.go
-rw-r--r-- <span class="m">1</span> mtsouk staff <span class="m">16316</span> Mar <span class="m">4</span> 20:01 aPackage.o#
</code></pre></div><h1 id="ç§æœ‰å˜é‡å’Œå‡½æ•°">ç§æœ‰å˜é‡å’Œå‡½æ•°</h1>
<p>ç§æœ‰å˜é‡å’Œå‡½æ•°ä¸å…¬å…±å˜é‡å’Œå‡½æ•°çš„åŒºåˆ«åœ¨äºï¼Œç§æœ‰å˜é‡å’Œå‡½æ•°å¯ä»¥åœ¨åŒ…çš„å†…éƒ¨ä¸¥æ ¼ä½¿ç”¨å’Œè°ƒç”¨ã€‚æ§åˆ¶å“ªäº›å‡½æ•°ã€å¸¸é‡å’Œå˜é‡æ˜¯å…¬å…±çš„ï¼Œä¹Ÿç§°ä¸ºå°è£…ã€‚Goä½¿ç”¨ä¸€ä¸ªç®€å•çš„è§„åˆ™åŒºåˆ†å‡½æ•°æˆ–è€…å˜é‡ç§æœ‰æˆ–æ˜¯å…±æœ‰ã€‚<strong>å…¬æœ‰çš„å‡½æ•°ï¼Œå˜é‡éƒ½æ˜¯ä»¥å¤§å†™å­—æ¯å¼€å¤´ï¼Œç›¸åï¼Œç§æœ‰çš„å‡½æ•°ï¼Œå˜é‡éƒ½æ˜¯ä»¥å°å†™å­—æ¯å¼€å¤´</strong>ï¼Œè¿™å°±æ˜¯<code>fmt.Println()</code>ä¸­ç”¨<code>Println()</code>è€Œä¸ç”¨<code>println()</code>çš„åŸå› ã€‚ç„¶è€Œï¼Œ<strong>è¿™ä¸ªè§„åˆ™ä¸å½±å“åŒ…åçš„å¤§å°å†™ã€‚</strong></p>
<h1 id="init-åˆå§‹åŒ–å‡½æ•°"><code>init()</code> åˆå§‹åŒ–å‡½æ•°</h1>
<p>ä»»ä½•ä¸€ä¸ªGo packageèƒ½å¤Ÿæ‹¥æœ‰ä¸€ä¸ªç§æœ‰å‡½æ•°<code>init()</code>ï¼Œè¯¥å‡½æ•°åœ¨å…¶ä»–æ–¹æ³•æ‰§è¡Œä¹‹å‰æœ€å¼€å§‹è‡ªåŠ¨æ‰§è¡Œã€‚</p>
<blockquote>
<p><code>init()</code>å‡½æ•°è¢«è®¾è®¡ä¸ºç§æœ‰å‡½æ•°ï¼Œè¿™æ„å‘³ç€ä¸èƒ½ä»åŒ…å¤–éƒ¨è°ƒç”¨å®ƒã€‚ä½œä¸ºpackageçš„ç”¨æˆ·ä¸èƒ½å®Œå…¨æ§åˆ¶<code>init()</code>å‡½æ•°ï¼Œä½ åº”è¯¥åœ¨ä½¿ç”¨å…¬å…±åŒ…æˆ–åœ¨<code>init()</code>å‡½æ•°ä¸­ä¿®æ”¹å…¨å±€çŠ¶æ€æ—¶ï¼Œä»”ç»†æ€è€ƒã€‚</p>
</blockquote>
<p>æˆ‘ä»¬å°†ä»å¤šä¸ªGo packagesä¸­å±•ç¤ºä¸€ä¸ªå¤šä¸ª<code>init()</code>å‡½æ•°çš„ä¾‹å­ã€‚æ¡ˆä¾‹ä»£ç çš„åŒ…åç®€åŒ–ä¸º<code>a</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">a</span>

<span class="kn">import</span> <span class="p">(</span>
 <span class="s">&#34;fmt&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;init() a&#34;</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">FromA</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;fromA()&#34;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><p>è¿™ä¸ªaåŒ…å®ç°äº†<code>init()</code>å‡½æ•°å’Œä¸€ä¸ªåä¸º<code>FromA()</code>çš„å‡½æ•°ã€‚åœ¨è¿™ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨å¦‚ä¸‹shellå‘½ä»¤è®©è¿™ä¸ªåŒ…æˆä¸ºå½“å‰UNIXç”¨æˆ·å¯ç”¨çš„åŒ…ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ mkdir ~/go/src/a
$ cp a.go ~/go/src/a/
$ go install a
</code></pre></div><p>ç°åœ¨ï¼Œæˆ‘ä»¬çœ‹ä¸‹ä¸€ä¸ªGoè¯­è¨€çš„åŒ…bã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">b</span>

<span class="kn">import</span> <span class="p">(</span>
 <span class="s">&#34;a&#34;</span>
 <span class="s">&#34;fmt&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;init() b&#34;</span><span class="p">)</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="nf">FromB</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;fromB()&#34;</span><span class="p">)</span>
    <span class="nx">a</span><span class="p">.</span><span class="nf">FromA</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div><p>è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼ŸaåŒ…ä½¿ç”¨äº†<code>fmt</code>çš„Goè¯­è¨€æ ‡å‡†åº“ã€‚ç„¶è€Œï¼ŒbåŒ…éœ€è¦å¯¼å…¥aåŒ…æ‰èƒ½ä½¿ç”¨<code>a.FromA()</code>å‡½æ•°ã€‚aå’Œbéƒ½æœ‰ä¸€ä¸ª<code>init()</code>å‡½æ•°ã€‚</p>
<p>åœ¨è¿™ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦ä¸‹è½½è¿™ä¸ªåŒ…ä½¿å¾—å®ƒåœ¨å½“å‰UNIXç”¨æˆ·ä¸‹å¯ç”¨ã€‚æ‰§è¡Œå¦‚ä¸‹shellè„šæœ¬ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ mkdir ~/go/src/b
$ cp b.go ~/go/src/b
$ go install b
</code></pre></div><p>å› æ­¤ï¼Œæˆ‘ä»¬å½“å‰æœ‰ä¸¤ä¸ªåŒ…å«<code>init()</code>åˆå§‹è¯å‡½æ•°çš„Go packagesã€‚ç°åœ¨æˆ‘ä»¬è¯•ç€çŒœæµ‹ä¸‹æ‰§è¡Œ<code>manyInit.go</code>åä¼šè¾“å‡ºä»€ä¹ˆï¼Œè¯·çœ‹ä»¥ä¸‹ä»£ç ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
 <span class="s">&#34;a&#34;</span>
 <span class="s">&#34;b&#34;</span>
 <span class="s">&#34;fmt&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;init() manyInit&#34;</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">a</span><span class="p">.</span><span class="nf">FromA</span><span class="p">()</span>
    <span class="nx">b</span><span class="p">.</span><span class="nf">FromB</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div><p>å®é™…çš„é—®é¢˜æ˜¯ï¼šåœ¨aåŒ…æ‰§è¡Œæ—¶<code>init()</code>å‡½æ•°æ‰§è¡Œäº†å‡ æ¬¡ï¼Ÿæ‰§<code>manyInit.go</code>ç”Ÿæˆå¦‚ä¸‹è¾“å‡ºï¼Œå¹¶å¯¹è¿™ä¸ªé—®é¢˜ç»™å‡ºä¸€äº›è§£é‡Š:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ go run manyInit.go
init<span class="o">()</span> a
init<span class="o">()</span> b
init<span class="o">()</span> manyInit
fromA<span class="o">()</span>
fromB<span class="o">()</span>
fromA<span class="o">()</span>
</code></pre></div><p>è™½ç„¶äº‹å®æ˜¯aåŒ…è¢«ä¸¤ä¸ªä¸åŒçš„åŒ…ä¸¤æ¬¡å¯¼å…¥ï¼Œä½†æ˜¯ä¹‹å‰çš„è¾“å‡ºè¯´æ˜äº†<code>init()</code>å‡½æ•°åªæ‰§è¡Œäº†ä¸€æ¬¡ã€‚ä½œä¸ºä»<code>manyInit.go</code>å¯¼å…¥çš„ç¬¬ä¸€æ¬¡æ‰§è¡Œçš„ä»£ç å—ï¼ŒåŒ…aå’ŒåŒ…bçš„<code>init()</code>å‡½æ•°åœ¨<code>manyInit.go</code>çš„<code>init()</code>å‡½æ•°ä¹‹å‰æ‰§è¡Œï¼Œè¿™æ¯”è¾ƒåˆç†ã€‚ä¸»è¦åŸå› æ˜¯<code>manyInit.go</code>çš„<code>init()</code>å‡½æ•°å…è®¸ä½¿ç”¨aæˆ–bä¸­çš„å…ƒç´ ã€‚</p>
<p>å½“ä½ æƒ³è¦è®¾ç½®ä¸€äº›ä¸éœ€è¦å¤–éƒ¨ä½¿ç”¨çš„å†…éƒ¨å˜é‡æ˜¯ï¼Œ<code>init()</code>å‡½æ•°æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨<code>init()</code>å‡½æ•°ä¸­æ‰¾åˆ°å½“å‰çš„æ—¶åŒºã€‚è®°ä½ï¼Œä¸€ä¸ªæ–‡ä»¶ä¸­å¯ä»¥æœ‰å¤šä¸ªinit()å‡½æ•°ï¼›ç„¶è€Œï¼ŒGoçš„è¿™ä¸ªç‰¹ç‚¹å¾ˆå°‘è¢«ä½¿ç”¨ã€‚</p>
<h1 id="go-modules">Go modules</h1>
<p>Go modulesåœ¨GO 1.11ç‰ˆæœ¬ä¸­ç¬¬ä¸€æ¬¡è¢«æåŠã€‚åœ¨å†™è¿™äº›å†…å®¹çš„æ—¶å€™æœ€æ–°çš„Goç‰ˆæœ¬æ˜¯1.13ã€‚ä½†åœ¨æœªæ¥çš„Goç‰ˆæœ¬ä¸­ï¼Œæ‰€ä»‹ç»çš„ä¸€äº›ç»†èŠ‚å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ã€‚</p>
<p>Go moduleç±»ä¼¼äºä¸€ä¸ªæœ‰ç‰ˆæœ¬å¥½çš„Go packageã€‚Goå¯¹ç‰ˆæœ¬æ§åˆ¶æ¨¡å—ä½¿ç”¨è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶ã€‚è¿™æ„å‘³ç€ç‰ˆæœ¬ä»å­—æ¯vå¼€å¤´åé¢åŠ ç‰ˆæœ¬å·ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæœ‰ä¸€äº›ç±»ä¼¼äºv1.0.0, v1.0.5, å’Œv2.0.2çš„ç‰ˆæœ¬å·ã€‚</p>
<p>ç¬¬ä¸€ä½ç‰ˆæœ¬å·ï¼Œv1, v2, or v3ä»£è¡¨ä¸å‘åå…¼å®¹çš„Go packageçš„å¤§ç‰ˆæœ¬ã€‚è¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬çš„ç¨‹åºå·¥ä½œåœ¨v1ç‰ˆæœ¬ï¼Œå®ƒä¸ä¸€å®šèƒ½åœ¨v2å’Œv3ç‰ˆæœ¬çš„Goç¯å¢ƒä¸‹æ­£å¸¸å·¥ä½œã€‚ç¬¬äºŒä½ç‰ˆæœ¬å·æ˜¯ç‰¹æ€§ç›¸å…³çš„ï¼Œé€šå¸¸v1.1.0ç‰ˆæœ¬è¦æ¯”v1.0.2æˆ–è€…v1.0.0æœ‰æ›´å¤šçš„æ–°çš„ç‰¹æ€§ï¼Œä¹Ÿæ¯”æ‰€æœ‰è€çš„ç‰ˆæœ¬æ›´åŠ å®Œæ•´ã€‚æœ€åä¸€ä½ç‰ˆæœ¬å·æ˜¯å’Œbug fixç›¸å…³çš„ã€‚æ²¡æœ‰æ–°çš„é¥¿ç‰¹æ€§ã€‚æ³¨æ„ï¼Œè¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶ä¹Ÿç”¨äºGoç‰ˆæœ¬ã€‚</p>
<p>æ³¨æ„Go moduleså…è®¸æˆ‘ä»¬åœ¨GOPATHè·¯å¾„å¤–å†™ä¸€äº›ä¸œè¥¿ã€‚</p>
<h1 id="go-moduleçš„åˆ›å»ºå’Œä½¿ç”¨">Go moduleçš„åˆ›å»ºå’Œä½¿ç”¨</h1>
<p>è¿™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†åˆ›å»ºç¬¬ä¸€ä¸ªåŸºç¡€ç‰ˆæœ¬çš„Go moduleï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªGithubä»“åº“æ¥å­˜å‚¨ä»£ç ã€‚åœ¨è¿™éƒ¨åˆ†å†…å®¹ä¸­ï¼Œä»£ç å°†æ”¾åœ¨<a class="link" href="https://github.com/mactsouk/myModule"  target="_blank" rel="noopener"
    >https://github.com/mactsouk/myModule</a>ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåªæœ‰<code>README.md</code>çš„ä»“åº“ã€‚æ‰€ä»¥ç¬¬ä¸€æ¬¡å°†åœ¨shellå‘½ä»¤è¡Œä¸‹æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ git clone git@github.com:mactsouk/myModule.git
Cloning into <span class="s1">&#39;myModule&#39;</span>...
remote: Enumerating objects: 7, <span class="k">done</span>.
remote: Counting objects: 100% <span class="o">(</span>7/7<span class="o">)</span>, <span class="k">done</span>.
remote: Compressing objects: 100% <span class="o">(</span>6/6<span class="o">)</span>, <span class="k">done</span>.
remote: Total <span class="m">7</span> <span class="o">(</span>delta 1<span class="o">)</span>, reused <span class="m">0</span> <span class="o">(</span>delta 0<span class="o">)</span>, pack-reused <span class="m">0</span>
Receiving objects: 100% <span class="o">(</span>7/7<span class="o">)</span>, <span class="k">done</span>.
Resolving deltas: 100% <span class="o">(</span>1/1<span class="o">)</span>, <span class="k">done</span>.
</code></pre></div><p>æ‰§è¡Œä¹‹åï¼Œæˆ‘ä»¬å°†æœ‰ä¸€ä¸ªä½œè€…çš„Githubä»“åº“ï¼Œå¦‚æœä½ æƒ³ä»å¤´åˆ›å»ºä½ è‡ªå·±çš„Goæ¨¡å—ï¼Œä½ éœ€è¦åˆ›å»ºä½ è‡ªå·±çš„ç©ºGitHubä»“åº“ã€‚</p>
<h1 id="åˆ›å»ºv100ç‰ˆæœ¬">åˆ›å»ºv1.0.0ç‰ˆæœ¬</h1>
<p>æˆ‘ä»¬å°†éœ€è¦æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æ¥åˆ›å»ºä¸€ä¸ªæˆ‘ä»¬è‡ªå·±çš„v1.0.0 Go moduleã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ go mod init
go: creating new go.mod: module github.com/mactsouk/myModule
$ touch myModule.go
$ vi myModule.go
$ git add .
$ git commit -a -m <span class="s2">&#34;Initial version 1.0.0&#34;</span>
$ git push
$ git tag v1.0.0
$ git push -q origin v1.0.0
$ go list
github.com/mactsouk/myModule
$ go list -m
github.com/mactsouk/myModule
</code></pre></div><p><code>myModule.go</code>æ–‡ä»¶å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">myModule</span>

<span class="kn">import</span> <span class="p">(</span>
 <span class="s">&#34;fmt&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">Version</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Version 1.0.0&#34;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><p><code>go.mod</code>ä¹‹å‰å°±è¢«åˆ›å»ºäº†ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ cat go.mod
module github.com/mactsouk/myModule
go 1.12
</code></pre></div><h1 id="ä½¿ç”¨v100ç‰ˆæœ¬">ä½¿ç”¨v1.0.0ç‰ˆæœ¬</h1>
<p>åœ¨è¿™ç« ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨ä¹‹å‰åˆ›å»ºçš„v1.0.0çš„Go moduleã€‚ä¸ºäº†ä½¿ç”¨Go modulesï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªGoç¨‹åºï¼Œ<code>useModule.go</code>æ–‡ä»¶å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
 <span class="nx">v1</span> <span class="s">&#34;github.com/mactsouk/myModule&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">v1</span><span class="p">.</span><span class="nf">Version</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div><p>æˆ‘ä»¬éœ€è¦åŒ…å«Go moduleï¼ˆgithub.com/mactsouk/myModuleï¼‰è·¯å¾„ã€‚åœ¨è¿™ä¾‹å­è¿™ä¸ªè·¯å¾„çš„åˆ«åä¸ºv1ã€‚åœ¨Goè¯­è¨€ä¸­ä½¿ç”¨åˆ«åæ˜¯ä¸æ•´æ´çš„ã€‚ä¸ºä½¿é˜…è¯»æ–¹ä¾¿æ‰€ä»¥ä½¿ç”¨äº†åˆ«åã€‚è™½ç„¶å¦‚æ­¤ï¼Œè¿™ä¸ªç‰¹å¾ä¹Ÿä¸æ¨èç”¨åœ¨ç”Ÿäº§ä»£ç ä¸­ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬è¯•ç€åœ¨<code>/tmp</code>è·¯å¾„ä¸‹æ‰§è¡Œ<code>useModule.go</code>ã€‚å®ƒå°†æŠ¥â€œæ‰¾ä¸åˆ°github.com/mactsouk/myModuleâ€é”™è¯¯ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ <span class="nb">pwd</span>
/tmp
$ go run useModule.go
useModule.go:4:2: cannot find package <span class="s2">&#34;github.com/mactsouk/myModule&#34;</span> in any
of:
 /usr/local/Cellar/go/1.12/libexec/src/github.com/mactsouk/myModule
<span class="o">(</span>from <span class="nv">$GOROOT</span><span class="o">)</span>
 /Users/mtsouk/go/src/github.com/mactsouk/myModule <span class="o">(</span>from <span class="nv">$GOPATH</span><span class="o">)</span>
</code></pre></div><p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è·å¾—Go modulesï¼Œç„¶åæˆåŠŸæ‰§è¡Œ<code>useModule.go</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ <span class="nb">export</span> <span class="nv">GO111MODULE</span><span class="o">=</span>on
$ go run useModule.go
go: finding github.com/mactsouk/myModule v1.0.0
go: downloading github.com/mactsouk/myModule v1.0.0
go: extracting github.com/mactsouk/myModule v1.0.0
Version 1.0.0
</code></pre></div><p>æ‰€ä»¥ï¼Œ<code>useModule.go</code>æ˜¯æ­£ç¡®çš„ä¸”èƒ½è¢«æ‰§è¡Œï¼Œç°åœ¨æ˜¯æ—¶å€™è®©<code>useModule.go</code>æ›´åŠ è§„èŒƒäº†ã€‚å»å‘½åå¹¶åˆ›å»ºå®ƒã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ go mod init hello
go: creating new go.mod: module hello
$ go build
</code></pre></div><p>æœ€åä¸€éƒ¨åˆ†å‘½ä»¤æ˜¯åœ¨<code>/tmp</code>ä¸‹ç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»¥åŠä¸¤ä¸ªé¢å¤–çš„åä¸º<code>go.mod</code>å’Œ<code>go.dum</code>æ–‡ä»¶ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ cat go.sum
github.com/mactsouk/myModule v1.0.0
h1:eTCn2Jewnajw0REKONrVhHmeDEJ0Q5TAZ0xsSbh8kFs<span class="o">=</span>
github.com/mactsouk/myModule v1.0.0/go.mod
h1:s3ziarTDDvaXaHWYYOf/ULi97aoBd6JfnvAkM8rSuzg<span class="o">=</span>
</code></pre></div><p><code>go.sum</code>æ–‡ä»¶çš„ä½œç”¨æ˜¯æ£€æŸ¥æ‰€æœ‰çš„moduleæ˜¯å¦å·²ç»ä¸‹è½½ï¼Œå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ cat go.mod
module hello
go 1.12
require github.com/mactsouk/myModule v1.0.0
</code></pre></div><blockquote>
<p>æ³¨æ„å¦‚æœ<code>go.mod</code>æ–‡ä»¶åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­åˆ¶å®šäº†v1.3.0 Go moduleç‰ˆæœ¬ï¼Œå³ä½¿æœ‰æœ€æ–°ç‰ˆæœ¬çš„Go moduleå¯ä»¥ä½¿ç”¨ï¼Œé¡¹ç›®ä¹Ÿä¸ä¼šç”¨åˆ°æœ€æ–°çš„Go moduleã€‚</p>
</blockquote>
<h1 id="åˆ›å»ºv110ç‰ˆæœ¬">åˆ›å»ºv1.1.0ç‰ˆæœ¬</h1>
<p>åœ¨è¿™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†ç”¨ä¸åŒçš„tagåˆ›å»ºä¸€ä¸ªæ–°ç‰ˆæœ¬çš„<code>myModule</code>æ–‡ä»¶ã€‚ç„¶è€Œï¼Œè¿™ä¸€æ¬¡ä¸éœ€è¦æ‰§è¡Œå‘½ä»¤<code>go mod init</code>ï¼Œåƒä¹‹å‰é‚£æ ·ã€‚æˆ‘ä»¬å°†éœ€è¦æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ vi myModule.go
$ git commit -a -m <span class="s2">&#34;v1.1.0&#34;</span>
<span class="o">[</span>master ddd0742<span class="o">]</span> v1.1.0
<span class="m">1</span> file changed, <span class="m">1</span> insertion<span class="o">(</span>+<span class="o">)</span>, <span class="m">1</span> deletion<span class="o">(</span>-<span class="o">)</span>
$ git push
$ git tag v1.1.0
$ git push -q origin v1.1.0
</code></pre></div><p><code>myModule.go</code>æ–‡ä»¶å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">myModule</span>

<span class="kn">import</span> <span class="p">(</span>
 <span class="s">&#34;fmt&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">Version</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Version 1.1.0&#34;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><h1 id="ä½¿ç”¨v110ç‰ˆæœ¬">ä½¿ç”¨v1.1.0ç‰ˆæœ¬</h1>
<p>åœ¨è¿™ç« ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨æˆ‘ä»¬åˆ›å»ºçš„Go module v1.1.0ã€‚è¿™ä¸€æ¬¡ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨Dockeré•œåƒï¼Œä»¥ä¾¿å°½å¯èƒ½ç‹¬ç«‹ç”¨äºå¼€å‘æ¨¡å—çš„æœºå™¨ã€‚ä¸‹é¢çš„å‘½ä»¤ä¼šä½¿æˆ‘ä»¬å¾—åˆ°Dockeré•œåƒç„¶åè¿›å…¥è¿™ä¸ªç¨‹åºçš„è¿è¡Œç¯å¢ƒä¸­ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ docker run --rm -it golang:latest
root@884c0d188694:/go# <span class="nb">cd</span> /tmp
root@58c5688e3ee0:/tmp# go version
go version go1.13 linux/amd64
</code></pre></div><p>æ­£å¦‚æˆ‘ä»¬æ‰€è§ï¼ŒDockeré•œåƒä½¿ç”¨æœ€æ–°çš„Goç‰ˆæœ¬ï¼Œåœ¨å†™æœ¬æ–‡æ—¶å°±æ˜¯1.13ç‰ˆæœ¬ã€‚ä¸ºäº†ä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªGo modulesã€‚æˆ‘ä»¬å°†éœ€è¦åˆ›å»ºä¸€ä¸ªGoç¨‹åºï¼Œå‘½åä¸º<code>useUpdatedModule.go</code>ã€‚å†…å®¹å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go">
<span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="nx">v1</span> <span class="s">&#34;github.com/mactsouk/myModule&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">v1</span><span class="p">.</span><span class="nf">Version</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div><p><code>useUpdatedModule.go</code>å’Œ<code>useModule.go</code>æ¯”è¾ƒç›¸ä¼¼ã€‚éå¸¸æ£’çš„ä¸€ä»¶äº‹æƒ…å°±æ˜¯æˆ‘ä»¬å°†è‡ªåŠ¨æ›´æ–°åˆ°æœ€æ–°çš„v1ç‰ˆæœ¬ã€‚åœ¨Dockeré•œåƒä¸­å†™å®Œä»£ç åï¼Œæˆ‘ä»¬åšå¦‚ä¸‹æ“ä½œã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">root@58c5688e3ee0:/tmp# ls -l
total <span class="m">4</span>
-rw-r--r-- <span class="m">1</span> root root <span class="m">91</span> Mar <span class="m">2</span> 19:59 useUpdatedModule.go
root@58c5688e3ee0:/tmp# <span class="nb">export</span> <span class="nv">GO111MODULE</span><span class="o">=</span>on
root@58c5688e3ee0:/tmp# go run useUpdatedModule.go
go: finding github.com/mactsouk/myModule v1.1.0
go: downloading github.com/mactsouk/myModule v1.1.0
go: extracting github.com/mactsouk/myModule v1.1.0
Version 1.1.0
</code></pre></div><p>è¿™æ„å‘³ç€<code>useUpdatedModule.go</code>è¢«è‡ªåŠ¨ä½¿ç”¨æœ€æ–°çš„v1ç‰ˆæœ¬çš„Go moduleã€‚å½“ä½ å¼€å¯moduleæ”¯æŒ<code>GO111MODULE=on</code>æ—¶æ˜¯æ¯”è¾ƒå±é™©çš„ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬å°è¯•æ‰§åœ¨æœ¬åœ°æœºå™¨ä¸Š<code>/tmp</code>æ‰§è¡Œ<code>useModule.go</code>æ—¶ï¼Œä¼šå¾—åˆ°å¦‚ä¸‹è¾“å‡ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ ls -l go.mod go.sum useModule.go
-rw------- <span class="m">1</span> mtsouk wheel <span class="m">67</span> Mar <span class="m">2</span> 21:29 go.mod
-rw------- <span class="m">1</span> mtsouk wheel <span class="m">175</span> Mar <span class="m">2</span> 21:29 go.sum
-rw-r--r-- <span class="m">1</span> mtsouk wheel <span class="m">92</span> Mar <span class="m">2</span> 21:12 useModule.go
$ go run useModule.go
Version 1.0.0
</code></pre></div><p>è¿™æ„å‘³ç€<code>useModule.go</code>ä¾æ—§ä½¿ç”¨è€ç‰ˆæœ¬çš„Go moduleã€‚å¦‚æœæƒ³ä½¿ç”¨æœ€æ–°çš„Go moduleï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ rm go.mod go.sum
$ go run useModule.go
go: finding github.com/mactsouk/myModule v1.1.0
go: downloading github.com/mactsouk/myModule v1.1.0
go: extracting github.com/mactsouk/myModule v1.1.0
Version 1.1.0
</code></pre></div><p>å¦‚æœåˆæƒ³ä½¿ç”¨v1.0.0çš„Go moduleæ—¶ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ go mod init hello
go: creating new go.mod: module hello
$ go build
$ go run useModule.go
Version 1.1.0
$ cat go.mod
module hello
go 1.12
require github.com/mactsouk/myModule v1.1.0
$ vi go.mod
$ cat go.mod
module hello
go 1.12
require github.com/mactsouk/myModule v1.0.0
$ go run useModule.go
Version 1.0.0
</code></pre></div><p>ä¸‹ä¸€ç« èŠ‚å°†ä¼šåˆ›å»ºä¸€ä¸ªæ–°Go moduleçš„å¤§ç‰ˆæœ¬ï¼Œè¿™æ„å‘³ç€ç”¨ä¸åŒçš„tagä»£æ›¿ã€‚æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ä¸ªä¸åŒçš„Githubåˆ†æ”¯ã€‚</p>
<h1 id="åˆ›å»ºv200ç‰ˆæœ¬">åˆ›å»ºv2.0.0ç‰ˆæœ¬</h1>
<p>åœ¨è¿™ç« ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªç¬¬äºŒå¤§çš„myModuleç‰ˆæœ¬ã€‚æ³¨æ„ï¼Œå¯¹äºä¸»è¦ç‰ˆæœ¬ï¼Œæ‚¨éœ€è¦åœ¨importè¯­å¥ä¸­æ˜ç¡®è¡¨ç¤ºã€‚</p>
<p>æ‰€ä»¥<code>github.com/mactsouk/myModule</code>å°†æˆä¸ºv2ç‰ˆæœ¬çš„<code>github.com/mactsouk/myModule/v2</code>å’Œv3ç‰ˆæœ¬çš„<code>github.com/mactsouk/myModule/v3</code>ã€‚ç¬¬ä¸€ä»¶äº‹æƒ…å°±æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„Githubåˆ†æ”¯ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ git checkout -b v2
Switched to a new branch <span class="s1">&#39;v2&#39;</span>
$ git push --set-upstream origin v2
</code></pre></div><p>ç„¶åè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ vi go.mod
$ cat go.mod
module github.com/mactsouk/myModule/v2
go 1.12
$ git commit -a -m <span class="s2">&#34;Using 2.0.0&#34;</span>
<span class="o">[</span>v2 5af2269<span class="o">]</span> Using 2.0.0
<span class="m">2</span> files changed, <span class="m">2</span> insertions<span class="o">(</span>+<span class="o">)</span>, <span class="m">2</span> deletions<span class="o">(</span>-<span class="o">)</span>
$ git tag v2.0.0
$ git push --tags origin v2
Counting objects: 4, <span class="k">done</span>.
Delta compression using up to <span class="m">8</span> threads.
Compressing objects: 100% <span class="o">(</span>3/3<span class="o">)</span>, <span class="k">done</span>.
Writing objects: 100% <span class="o">(</span>4/4<span class="o">)</span>, <span class="m">441</span> bytes <span class="p">|</span> 441.00 KiB/s, <span class="k">done</span>.
Total <span class="m">4</span> <span class="o">(</span>delta 1<span class="o">)</span>, reused <span class="m">0</span> <span class="o">(</span>delta 0<span class="o">)</span>
remote: Resolving deltas: 100% <span class="o">(</span>1/1<span class="o">)</span>, completed with <span class="m">1</span> <span class="nb">local</span> object.
To github.com:mactsouk/myModule.git
* <span class="o">[</span>new branch<span class="o">]</span> v2 -&gt; v2
* <span class="o">[</span>new tag<span class="o">]</span> v2.0.0 -&gt; v2.0.0
$ git --no-pager branch -a
 master
* v2
 remotes/origin/HEAD -&gt; origin/master
 remotes/origin/master
 remotes/origin/v2
</code></pre></div><p>è¿™ä¸ªå¤§ç‰ˆæœ¬çš„å†…å®¹<code>myModule.go</code>å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">myModule</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&#34;fmt&#34;</span>
<span class="p">)</span>
<span class="kd">func</span> <span class="nf">Version</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Version 2.0.0&#34;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><h1 id="ä½¿ç”¨v200ç‰ˆæœ¬">ä½¿ç”¨v2.0.0ç‰ˆæœ¬</h1>
<p>Once again, in order to use our Go modules, we will need to create a Go program, which is called useV2.go and contains the following Go code:</p>
<p>ä¸ºäº†ä½¿ç”¨æˆ‘ä»¬çš„Go moduleï¼Œæˆ‘ä»¬å°†éœ€è¦åˆ›å»ºä¸€ä¸ªåä¸º<code>useV2.go</code>çš„Goç¨‹åºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="nx">v</span> <span class="s">&#34;github.com/mactsouk/myModule/v2&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">v</span><span class="p">.</span><span class="nf">Version</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div><p>æˆ‘ä»¬å°†ä½¿ç”¨Dockeré•œåƒã€‚è¿™æ˜¯æœ€ä¾¿æ·çš„ä½¿ç”¨Go moduleçš„æ–¹å¼ï¼Œå› ä¸ºæˆ‘ä»¬ä¼šä»ä¸€ä¸ªæ–°çš„goç¯å¢ƒä¸‹å®‰è£…ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ docker run --rm -it golang:latest
root@191d84fc5571:/go# <span class="nb">cd</span> /tmp
root@191d84fc5571:/tmp# cat &gt; useV2.go
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="nx">v</span> <span class="s">&#34;github.com/mactsouk/myModule/v2&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">v</span><span class="p">.</span><span class="nf">Version</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">root@191d84fc5571:/tmp# <span class="nb">export</span> <span class="nv">GO111MODULE</span><span class="o">=</span>on
root@191d84fc5571:/tmp# go run useV2.go
go: finding github.com/mactsouk/myModule/v2 v2.0.0
go: downloading github.com/mactsouk/myModule/v2 v2.0.0
go: extracting github.com/mactsouk/myModule/v2 v2.0.0
Version 2.0.0
</code></pre></div><p>Dockeré•œåƒä¸‹ä½¿ç”¨v2.0.0ç‰ˆæœ¬çš„myModuleå·¥ä½œæ­£å¸¸ã€‚</p>
<h1 id="åˆ›å»ºv210ç‰ˆæœ¬">åˆ›å»ºv2.1.0ç‰ˆæœ¬</h1>
<p>ç°åœ¨æˆ‘ä»¬è¦åˆ›å»º<code>myModule.go</code>çš„æ›´æ–°ç‰ˆæœ¬ã€‚è¿™ä¸ä½¿ç”¨ä¸åŒçš„GitHubæ ‡ç­¾æœ‰å…³ã€‚æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ vi myModule.go
$ git commit -a -m <span class="s2">&#34;v2.1.0&#34;</span>
$ git push
$ git tag v2.1.0
$ git push -q origin v2.1.0
</code></pre></div><p>The updated contents of myModule.go will be as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">myModule</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&#34;fmt&#34;</span>
<span class="p">)</span>
<span class="kd">func</span> <span class="nf">Version</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Version 2.1.0&#34;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><h1 id="ä½¿ç”¨v210ç‰ˆæœ¬">ä½¿ç”¨v2.1.0ç‰ˆæœ¬</h1>
<p>æˆ‘ä»¬ç›®å‰å·²ç»çŸ¥é“ï¼Œä¸ºäº†ä½¿ç”¨æˆ‘ä»¬çš„Go moduleï¼Œæˆ‘ä»¬å°†éœ€è¦åˆ›å»ºä¸€ä¸ªåä¸º<code>useUpdatedV2.go</code>çš„Goç¨‹åºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="nx">v</span> <span class="s">&#34;github.com/mactsouk/myModule/v2&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">v</span><span class="p">.</span><span class="nf">Version</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div><p>è¿™é‡Œä¸éœ€è¦å®šä¹‰æˆ‘ä»¬æƒ³è¦ä½¿ç”¨çš„æœ€æ–°çš„v2ç‰ˆæœ¬çš„Go moduleï¼Œå› ä¸ºè¿™æ˜¯ç”±Goå¤„ç†çš„ï¼Œè¿™æ˜¯ä½¿ç”¨<code>useUpdatedV2.go</code>çš„ä¸»è¦åŸå› ã€‚<code>useV2.go</code>å’Œå®ƒéƒ½æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>ä½¿ç”¨Dockeré•œåƒçš„åŸå› å°±æ˜¯å› ä¸ºå®ƒè¶³å¤Ÿç®€å•ã€‚ä½¿ç”¨vcat(1)å‘½ä»¤åˆ›å»º<code>useUpdatedV2.go</code>çš„åŸå› æ˜¯å› ä¸ºDokeré•œåƒçš„ç‹¬ç«‹çš„ï¼Œå…¶ä¸­å¹¶æ²¡æœ‰vi(1)è¢«ä¸‹è½½ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ docker run --rm -it golang:1.12
root@ccfcd675e333:/go# <span class="nb">cd</span> /tmp/
root@ccfcd675e333:/tmp# cat &gt; useUpdatedV2.go
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="nx">v</span> <span class="s">&#34;github.com/mactsouk/myModule/v2&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">v</span><span class="p">.</span><span class="nf">Version</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">root@ccfcd675e333:/tmp# ls -l
total <span class="m">4</span>
-rw-r--r-- <span class="m">1</span> root root <span class="m">92</span> Mar <span class="m">2</span> 20:34 useUpdatedV2.go
root@ccfcd675e333:/tmp# go run useUpdatedV2.go
useUpdatedV2.go:4:2: cannot find package <span class="s2">&#34;github.com/mactsouk/myModule/v2&#34;</span>
in any of:
 /usr/local/go/src/github.com/mactsouk/myModule/v2 <span class="o">(</span>from <span class="nv">$GOROOT</span><span class="o">)</span>
 /go/src/github.com/mactsouk/myModule/v2 <span class="o">(</span>from <span class="nv">$GOPATH</span><span class="o">)</span>
root@ccfcd675e333:/tmp# <span class="nb">export</span> <span class="nv">GO111MODULE</span><span class="o">=</span>on
root@ccfcd675e333:/tmp# go run useUpdatedV2.go
go: finding github.com/mactsouk/myModule/v2 v2.1.0
go: downloading github.com/mactsouk/myModule/v2 v2.1.0
go: extracting github.com/mactsouk/myModule/v2 v2.1.0
Version 2.1.0
</code></pre></div><blockquote>
<p>æˆ‘ä»¬å°†åœ¨ç¬¬7ç« åå°„å’Œæ¥å£ä¸­å­¦ä¹ æ›´å¤šçš„å…³äºgit(1)å’ŒGithubçš„å‘½ä»¤ã€‚</p>
</blockquote>
<h1 id="ä¸€ä¸ªgo-moduleä½¿ç”¨ä¸åŒçš„ç‰ˆæœ¬">ä¸€ä¸ªGo moduleä½¿ç”¨ä¸åŒçš„ç‰ˆæœ¬</h1>
<p>åœ¨è¿™ç« ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ ä¸€ä¸ªGo moduleä½¿ç”¨çš„ä¸¤ä¸ªä»¥ä¸Šä¸»è¦ç‰ˆæœ¬ã€‚å¦‚æœä½ æƒ³åŒæ—¶ä½¿ç”¨ä¸€ä¸ªGoæ¨¡å—çš„ä¸¤ä¸ªä»¥ä¸Šä¸»è¦ç‰ˆæœ¬ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç›¸åŒçš„æŠ€æœ¯ã€‚</p>
<p>Goæ–‡ä»¶<code>useTwo.go</code>å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="nx">v1</span> <span class="s">&#34;github.com/mactsouk/myModule&#34;</span>
    <span class="nx">v2</span> <span class="s">&#34;github.com/mactsouk/myModule/v2&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">v1</span><span class="p">.</span><span class="nf">Version</span><span class="p">()</span>
    <span class="nx">v2</span><span class="p">.</span><span class="nf">Version</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ˜ç¡®çš„å¯¼å…¥æƒ³ä½¿ç”¨çš„ä¸åŒçš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”è¦ç»™å®ƒèµ·åˆ«åã€‚</p>
<p>æ‰§è¡Œ<code>useTwo.go</code>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ <span class="nb">export</span> <span class="nv">GO111MODULE</span><span class="o">=</span>on
$ go run useTwo.go
go: creating new go.mod: module github.com/PacktPublishing/Mastering-GoSecond-Edition
go: finding github.com/mactsouk/myModule/v2 v2.1.0
go: downloading github.com/mactsouk/myModule/v2 v2.1.0
go: extracting github.com/mactsouk/myModule/v2 v2.1.0
Version 1.1.0
Version 2.1.0
</code></pre></div><h1 id="goä»£ç å’Œgo-moduleçš„å­˜å‚¨">Goä»£ç å’ŒGo moduleçš„å­˜å‚¨</h1>
<p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†äº†è§£Goå¦‚ä½•å­˜å‚¨ä»£ç å’Œæ­£åœ¨ä½¿ç”¨çš„Goæ¨¡å—çš„ä¿¡æ¯ã€‚ä½¿ç”¨æˆ‘ä»¬çš„Go moduleä½œä¸ºä¸€ä¸ªä¾‹å­ã€‚åœ¨æˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬çš„Go moduleå°±ä¼šç”Ÿæˆä¸€äº›å†…å®¹åœ¨æœ¬åœ°çš„macOSæœºå™¨çš„<code>~/go/pkg/mod/github.com/mactsouk</code>æ–‡ä»¶å¤¹ä¸‹é¢ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ ls -lR ~/go/pkg/mod/github.com/mactsouk
total <span class="m">0</span>
drwxr-xr-x <span class="m">3</span> mtsouk staff 96B Mar <span class="m">2</span> 22:38 my!module
dr-x------ <span class="m">6</span> mtsouk staff 192B Mar <span class="m">2</span> 21:18 my!module@v1.0.0
dr-x------ <span class="m">6</span> mtsouk staff 192B Mar <span class="m">2</span> 22:07 my!module@v1.1.0
/Users/mtsouk/go/pkg/mod/github.com/mactsouk/my!module:
total <span class="m">0</span>
dr-x------ <span class="m">6</span> mtsouk staff 192B Mar <span class="m">2</span> 22:38 v2@v2.1.0
/Users/mtsouk/go/pkg/mod/github.com/mactsouk/my!module/v2@v2.1.0:
total <span class="m">24</span>
-r--r--r-- <span class="m">1</span> mtsouk staff 28B Mar <span class="m">2</span> 22:38 README.md
-r--r--r-- <span class="m">1</span> mtsouk staff 48B Mar <span class="m">2</span> 22:38 go.mod
-r--r--r-- <span class="m">1</span> mtsouk staff 86B Mar <span class="m">2</span> 22:38 myModule.go
/Users/mtsouk/go/pkg/mod/github.com/mactsouk/my!module@v1.0.0:
total <span class="m">24</span>
-r--r--r-- <span class="m">1</span> mtsouk staff 28B Mar <span class="m">2</span> 21:18 README.md
-r--r--r-- <span class="m">1</span> mtsouk staff 45B Mar <span class="m">2</span> 21:18 go.mod
-r--r--r-- <span class="m">1</span> mtsouk staff 86B Mar <span class="m">2</span> 21:18 myModule.go
/Users/mtsouk/go/pkg/mod/github.com/mactsouk/my!module@v1.1.0:
total <span class="m">24</span>
-r--r--r-- <span class="m">1</span> mtsouk staff 28B Mar <span class="m">2</span> 22:07 README.md
-r--r--r-- <span class="m">1</span> mtsouk staff 45B Mar <span class="m">2</span> 22:07 go.mod
-r--r--r-- <span class="m">1</span> mtsouk staff 86B Mar <span class="m">2</span> 22:07 myModule.go
</code></pre></div><blockquote>
<p>æœ€å¥½çš„å­¦ä¹ Go moduleçš„æ–¹å¼å°±æ˜¯å»å®éªŒå°è¯•ï¼ˆå¤šå†™å¤šç”¨ï¼‰ã€‚ä½ ç”¨æˆ–ä¸ç”¨ï¼ŒGo moduleå°±åœ¨é‚£é‡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å¼€å§‹ä½¿ç”¨ä»–ä»¬å§ã€‚</p>
</blockquote>
<h1 id="go-mod-vendorå‘½ä»¤">go mod vendorå‘½ä»¤</h1>
<p>æœ‰æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†æ‰€æœ‰ä¾èµ–é¡¹å­˜å‚¨åœ¨åŒä¸€ä¸ªåœ°æ–¹ï¼Œå¹¶å°†å®ƒä»¬ä¿å­˜åœ¨é¡¹ç›®æ–‡ä»¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹<code>go mod vendor</code>å‘½ä»¤ä¼šå¸®åŠ©æˆ‘ä»¬å‡†ç¡®çš„å®Œæˆï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ <span class="nb">cd</span> useTwoVersions
$ go mod init useV1V2
go: creating new go.mod: module useV1V2
$ go mod vendor
$ ls -l
total <span class="m">24</span>
-rw------- <span class="m">1</span> mtsouk staff 114B Mar <span class="m">2</span> 22:43 go.mod
-rw------- <span class="m">1</span> mtsouk staff 356B Mar <span class="m">2</span> 22:43 go.sum
-rw-r--r--@ <span class="m">1</span> mtsouk staff 143B Mar <span class="m">2</span> 19:36 useTwo.go
drwxr-xr-x <span class="m">4</span> mtsouk staff 128B Mar <span class="m">2</span> 22:43 vendor
$ ls -l vendor/github.com/mactsouk/myModule
total <span class="m">24</span>
-rw-r--r-- <span class="m">1</span> mtsouk staff 28B Mar <span class="m">2</span> 22:43 README.md
-rw-r--r-- <span class="m">1</span> mtsouk staff 45B Mar <span class="m">2</span> 22:43 go.mod
-rw-r--r-- <span class="m">1</span> mtsouk staff 86B Mar <span class="m">2</span> 22:43 myModule.go
drwxr-xr-x <span class="m">6</span> mtsouk staff 192B Mar <span class="m">2</span> 22:43 v2
$ ls -l vendor/github.com/mactsouk/myModule/v2
total <span class="m">24</span>
-rw-r--r-- <span class="m">1</span> mtsouk staff 28B Mar <span class="m">2</span> 22:43 README.md
-rw-r--r-- <span class="m">1</span> mtsouk staff 48B Mar <span class="m">2</span> 22:43 go.mod
-rw-r--r-- <span class="m">1</span> mtsouk staff 86B Mar <span class="m">2</span> 22:43 myModule.go
</code></pre></div><p>å…³é”®ç‚¹åœ¨äºåœ¨æ‰§è¡Œ<code>go mod vendor</code>å‘½ä»¤ä¹‹å‰å»æ‰§è¡Œ<code>go mod init &lt;package name&gt;</code></p>
<h1 id="åˆ›å»ºä¼˜ç§€çš„go-packages">åˆ›å»ºä¼˜ç§€çš„Go packages</h1>
<p>è¿™ç« å°†æä¾›ä¸€äº›å¥½çš„çš„å»ºè®®å¸®åŠ©æˆ‘ä»¬å¼€å‘æ›´å¥½çš„Go packagesã€‚æˆ‘ä»¬å±è”½Go packageså°†å…¶ç»„ç»‡åœ¨æ–‡ä»¶å¤¹ä¸­ï¼Œèƒ½å¤ŸåŒ…å«ä¸€äº›å…±æœ‰å’Œç§æœ‰çš„å…ƒç´ ã€‚å…¬æœ‰å…ƒç´ å¯ä»¥åœ¨åŒ…å†…éƒ¨æˆ–è€…åŒ…å¤–éƒ¨ä½¿ç”¨ï¼Œç§æœ‰å…ƒç´ åªèƒ½åœ¨åŒ…çš„å†…éƒ¨ä½¿ç”¨ã€‚</p>
<ul>
<li>
<p>è¿™é‡Œæœ‰ä¸€äº›åˆ›å»ºgo packageä¼˜ç§€çš„è§„åˆ™:ç¬¬ä¸€ç‚¹éå®˜æ–¹çš„è§„åˆ™å°±æ˜¯å…ƒç´ ä¹‹é—´å¿…é¡»æœ‰ä¸€å®šçš„å…³è”ã€‚å› æ­¤ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªæ”¯æŒcarçš„åŒ…ï¼Œä½†æ˜¯åˆ›å»ºä¸€ä¸ªåŒ…å«æœ‰carå’Œbicyclesçš„åŒ…å°±ä¸æ˜¯é‚£ä¹ˆåˆç†äº†ã€‚ç®€å•æ¥è¯´ï¼Œæœ€å¥½çš„æ–¹å¼å°±æ˜¯å°†ä¸å¿…è¦çš„packageæ”¾åœ¨å¤šä¸ªpackageä¸­ï¼Œè€Œä¸æ˜¯åœ¨ä¸€ä¸ªå•ç‹¬çš„åŒ…ä¸­æ·»åŠ å¾ˆå¤šå‡½æ•°ã€‚æ­¤å¤–ï¼Œpackageåº”è¯¥ç®€å•å’Œæ˜“ç”¨ï¼Œä½†ä¸èƒ½å¤ªè¿‡äºç®€å•å’Œå‡Œä¹±ã€‚ï¼ˆåŒ…ä¸­åŠŸèƒ½çš„ç²’åº¦ä¸èƒ½å¤ªå°ï¼Œå°†åŒç±»çš„åŠŸèƒ½æ”¾ä¸€ä¸ªåŒ…ä¸­å³å¯ï¼‰</p>
</li>
<li>
<p>ç¬¬äºŒéƒ¨åˆ†å®é™…çš„è§„åˆ™å°±æ˜¯æˆ‘ä»¬åº”è¯¥å¤šæ¬¡ä½¿ç”¨è‡ªå·±çš„packageï¼Œåœ¨ä½¿ç”¨å¤šæ¬¡æ²¡æœ‰é—®é¢˜ç„¶ååœ¨æä¾›ç»™åˆ«äººä½¿ç”¨ã€‚è¿™å°†ä¼šå¸®åŠ©æˆ‘ä»¬å‘ç°ä¸€äº›æ„šè ¢çš„bugï¼Œç¡®ä¿packageçš„ä½¿ç”¨æ˜¯æˆ‘ä»¬é¢„æœŸçš„ç»“æœã€‚åœ¨æ­¤ä¹‹åï¼Œåœ¨å…¬å¼€packageä¹‹å‰ï¼Œå°†packageäº¤ç»™å…¶ä»–å¼€å‘äººå‘˜è¿›è¡Œé¢å¤–çš„æµ‹è¯•ã€‚</p>
</li>
<li>
<p>ç´§æ¥ç€ï¼Œå°è¯•å‡è®¾ä¸€äº›æ„‰å¿«åœ°ä½¿ç”¨æˆ‘ä»¬packageçš„ç”¨æˆ·ç±»å‹ï¼Œç¡®ä¿æˆ‘ä»¬çš„packageåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œä¼šç»™ä»–ä»¬å¸¦æ¥è¶…å‡ºä»–ä»¬èƒ½åŠ›èŒƒå›´çš„é—®é¢˜ã€‚</p>
</li>
<li>
<p>é™¤éæˆ‘ä»¬æœ‰å¾ˆå¥½çš„ç†ç”±ï¼Œå¦åˆ™packageä¸åº”è¯¥è¾“å‡ºæ— ç©·å°½çš„å‡½æ•°åˆ—è¡¨ã€‚ä½ çš„packageå†…çš„å¾ˆå°‘çš„å‡½æ•°åˆ—è¡¨ï¼Œä¼šä½¿æˆ‘ä»¬å¾ˆå¥½çš„ç†è§£ï¼Œä½¿ç”¨çš„æ–¹ä¾¿ã€‚åœ¨æ­¤ä¹‹åï¼Œå°è¯•ä½¿ç”¨ç®€çŸ­çš„åå­—å‘½ä»¤ä½ çš„å‡½æ•°åç§°è€Œä¸æ˜¯å¾ˆé•¿çš„åå­—ã€‚</p>
</li>
<li>
<p>æ¥å£èƒ½å¤Ÿæé«˜å‡½æ•°çš„å¯ç”¨æ€§ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬è®¤ä¸ºåˆé€‚çš„æ—¶å€™ï¼Œä½¿ç”¨æ¥å£ä»£æ›¿å•ä¸€ç±»å‹çš„å‡½æ•°å‚æ•°æˆ–è€…è¿”å›ç±»å‹ã€‚</p>
</li>
<li>
<p>å½“æ›´æ–°ä¸€ä¸ªåŒ…æ—¶ï¼Œé™¤éç»å¯¹å¿…è¦ï¼Œå°½é‡ä¸è¦ç ´åå…¶ä»–packageï¼Œä¹Ÿä¸è¦åˆ›å»ºä¸æ—§ç‰ˆæœ¬äº§ç”Ÿä¸å…¼å®¹çš„ä»£ç ã€‚</p>
</li>
<li>
<p>å½“å¼€å‘ä¸€ä¸ªæ–°çš„Go packageæ—¶ï¼Œå°è¯•ä½¿ç”¨å¤šä¸ªæ–‡ä»¶ï¼Œä¸ºäº†å°†ç›¸ä¼¼çš„ä»»åŠ¡æˆ–è€…æ¦‚å¿µåˆ†ç»„ã€‚</p>
</li>
<li>
<p>æ­¤å¤–ï¼Œå°è¯•ä»¿ç…§æ ‡å‡†åº“çš„Go packageçš„è§„åˆ™ï¼Œé˜…è¯»æ ‡å‡†åº“çš„ä»£ç å°†ä¼šå¯¹æˆ‘ä»¬æœ‰ç›Šã€‚</p>
</li>
<li>
<p>ä¸è¦åˆ›å»ºä¸€ä¸ªå·²ç»åœ¨ä¹‹å‰å­˜åœ¨çš„packageã€‚å¯¹ç°æœ‰çš„åŒ…è¿›è¡Œæ›´æ”¹ï¼Œå¹¶åˆ›å»ºè‡ªå·±çš„ç‰ˆæœ¬ã€‚</p>
</li>
<li>
<p>æ²¡æœ‰äººæƒ³è¦ä¸€ä¸ªåœ¨å±å¹•ä¸Šæ‰“å°æ—¥å¿—ä¿¡æ¯çš„Go packageã€‚åœ¨éœ€è¦ç”¨åˆ°çš„æ—¶å€™è®¾ç½®ä¸€ä¸ªæ—¥å¿—æ‰“å¼€æ ‡è®°æ¥æ‰“å¼€æ—¥å¿—è®°å½•ä¼šæ›´ä¸“ä¸šã€‚</p>
</li>
<li>
<p>åœ¨Goä»£ç é‡Œå¼•ç”¨çš„Go packageä½¿ç”¨è¦å’Œè°ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä½ çœ‹åˆ°ä¸€ä¸ªä½¿ç”¨ä½ çš„åŒ…å’Œå‡½æ•°åçš„ç¨‹åºåœ¨ä»£ç ä¸­ä»¥ä¸€ç§ç³Ÿç³•çš„æ–¹å¼å‡ºç°ï¼Œæœ€å¥½æ›´æ”¹å‡½æ•°çš„åç§°ã€‚ç”±äºpackageåç§°å‡ ä¹åœ¨ä»»ä½•åœ°æ–¹éƒ½è¢«ä½¿ç”¨ï¼Œæ‰€ä»¥å°½é‡ä½¿ç”¨ç®€æ´è€Œå¯Œæœ‰è¡¨ç°åŠ›çš„åŒ…åã€‚</p>
</li>
<li>
<p>å¦‚æœä½ å°†æ–°çš„Goç±»å‹å®šä¹‰æ”¾åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨å®ƒä»¬çš„åœ°æ–¹é™„è¿‘ï¼Œä¼šæ›´æ–¹ä¾¿ï¼Œå› ä¸ºåŒ…æ‹¬æ‚¨åœ¨å†…çš„ä»»ä½•äººéƒ½ä¸å¸Œæœ›åœ¨æºæ–‡ä»¶ä¸­æœç´¢æ–°æ•°æ®ç±»å‹çš„å®šä¹‰ã€‚</p>
</li>
<li>
<p>è¯•ç€åœ¨æˆ‘ä»¬çš„åŒ…é‡Œåˆ›å»ºæµ‹è¯•æ–‡ä»¶ï¼Œå› ä¸ºæœ‰æµ‹è¯•æ–‡ä»¶packageæ¯”æ²¡æœ‰çš„è¦æ›´åŠ æ ‡å‡†ï¼Œä¸“ä¸šã€‚å°å°çš„ç»†èŠ‚å°†ä¼šç»™ä½¿ç”¨çš„äººäº§ç”Ÿå¾ˆå¤§çš„ä¾¿æ·ï¼Œè¯´æ˜ä½ æ˜¯ä¸€ä¸ªå¾ˆè®¤çœŸçš„å¼€å‘è€…ï¼è¯·æ³¨æ„ï¼Œä¸ºåŒ…ç¼–å†™æµ‹è¯•æ˜¯ä¸æ˜¯éšä¾¿çš„ï¼Œæ‚¨åº”è¯¥é¿å…ä½¿ç”¨ä¸åŒ…å«æµ‹è¯•çš„åŒ…ã€‚åœ¨11ç« å°†å­¦åˆ°æ›´å¤šå…³äºæµ‹è¯•çš„å†…å®¹ã€‚</p>
</li>
<li>
<p>æœ€åï¼Œä¸è¦å†™GoåŒ…ï¼Œå› ä¸ºä½ æ²¡æœ‰æ›´å¥½çš„äº‹æƒ…åš-åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‰¾ä¸€äº›æ›´å¥½çš„äº‹æƒ…åšï¼Œä¸è¦æµªè´¹ä½ çš„æ—¶é—´!</p>
</li>
</ul>
<blockquote>
<p>æ°¸è¿œè®°ä½ï¼Œé™¤äº†åŒ…ä¸­çš„å®é™…Goä»£ç åº”è¯¥æ˜¯æ²¡æœ‰bugçš„è¿™ä¸€äº‹å®ä¹‹å¤–ï¼Œä¼˜ç§€packageä¸­æœ€é‡è¦çš„å…ƒç´ å°±æ˜¯å®ƒçš„æ–‡æ¡£ä»¥åŠä¸€äº›ä»£ç ç¤ºä¾‹,æ¾„æ¸…å…¶ä½¿ç”¨å’Œå±•ç¤ºçš„åŠŸèƒ½åŒ…çš„ç‰¹æ€§ã€‚</p>
</blockquote>
<h1 id="syscallåŒ…">syscallåŒ…</h1>
<p>è¿™ç« å°†å±•ç¤ºä¸€å°éƒ¨åˆ†çš„<code>syscall</code>æ ‡å‡†åŒ…ä¸­å‡½æ•°çš„ä½¿ç”¨ã€‚æ³¨æ„<code>syscall</code>æä¾›äº†å¾ˆå¤šçš„å’Œæ“ä½œç³»ç»Ÿåº•å±‚ç›¸å…³çš„å‡½æ•°å’Œç±»å‹ã€‚æ­¤å¤–ï¼Œ<code>syscall</code>åŒ…ä¹Ÿè¢«å¾ˆå¤šçš„Go packageä½¿ç”¨ï¼Œç±»ä¼¼äº<code>os</code>ã€<code>net</code>ã€<code>time</code>ã€‚è¿™äº›æä¾›äº†æ§åˆ¶æ“ä½œç³»ç»Ÿçš„ä¸€éƒ¨åˆ†æ¥å£ã€‚è¿™æ„å‘³ç€<code>syscall</code>åŒ…ä¸æ˜¯æœ€ä¾¿æ·çš„Goæ ‡å‡†åº“ï¼Œè¿™ä¸æ˜¯å®ƒçš„å·¥ä½œã€‚</p>
<p>è™½ç„¶UNIXç³»ç»Ÿæœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ï¼Œä»–ä»¬ä¹Ÿå±•ç¤ºäº†å„ä¸ªæ–¹é¢çš„ä¸åŒï¼Œå°¤å…¶æ˜¯æˆ‘ä»¬åœ¨è°ˆè®ºæ“ä½œç³»ç»Ÿå†…éƒ¨æ—¶ï¼Œ<code>syscall</code>åŒ…å°½å¯èƒ½èªæ˜çš„å¤„ç†ä»–ä»¬ä¹‹é—´çš„ä¸å…¼å®¹é—®é¢˜ã€‚è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªç§˜å¯†ï¼Œå¹¶ä¸”æœ‰å¾ˆå¥½çš„æ–‡æ¡£ï¼Œè¿™ä½¿å¾—<code>sycall</code>æˆä¸ºä¸€ä¸ªæˆåŠŸçš„åŒ…ã€‚</p>
<p>ä¸¥æ ¼æ¥è®²ï¼Œç¨‹åºè°ƒç”¨ç³»ç»Ÿçš„æ–¹å¼å°±æ˜¯åº”ç”¨ç¨‹åºä»æ“ä½œç³»ç»Ÿå†…æ ¸è¯·æ±‚ä¸€äº›å†…å®¹ã€‚å¯ä»¥æ¨æ–­å‡ºï¼Œç³»ç»Ÿè°ƒç”¨çš„è´£ä»»å°±æ˜¯å­˜å–å¹¶æ‰§è¡ŒUNIXä¸‹æœ€åº•å±‚çš„å…ƒç´ ï¼Œå¦‚ç¨‹åºï¼Œå­˜å‚¨è®¾å¤‡ã€æ‰“å°æ•°æ®ï¼Œç½‘ç»œæ¥å£ï¼Œä»»ä½•ç§ç±»çš„æ–‡ä»¶ã€‚ç®€å•æ¥è¯´ï¼Œåœ¨UNIXç³»ç»Ÿä¸‹ä¸ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨æˆ‘ä»¬å°†ä¸èƒ½å·¥ä½œã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€äº›ç±»ä¼¼äºstrace(1) and dtrace(1)çš„å·¥å…·æ¥æ£€æŸ¥UNIXè¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨ã€‚è¿™äº›å·¥å…·åœ¨ç¬¬2ç« ã€Šç†è§£Goå†…éƒ¨ã€‹æœ‰æåˆ°ã€‚</p>
<p><code>syscall</code>åŒ…çš„ä½¿ç”¨å°†åœ¨<code>useSyscall.go</code>ä¸­åˆ†4ä¸ªéƒ¨åˆ†è¯´æ˜ï¼š</p>
<blockquote>
<p>ä½ å¯èƒ½ä¸éœ€è¦ç›´æ¥ä½¿ç”¨<code>syscall</code>åŒ…ï¼Œé™¤éä½ çš„å·¥ä½œçš„å†…å®¹åå‘äºè®¡ç®—æœºåº•å±‚ã€‚ä¸æ˜¯æ‰€æœ‰çš„GoåŒ…å¯¹äºæ‰€æœ‰äººéƒ½æ˜¯é€‚ç”¨çš„ã€‚</p>
</blockquote>
<p>ç¬¬ä¸€éƒ¨åˆ†ä»£ç <code>useSyscall.go</code>å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>
<span class="kn">import</span> <span class="p">(</span>
 <span class="s">&#34;fmt&#34;</span>
 <span class="s">&#34;os&#34;</span>
 <span class="s">&#34;syscall&#34;</span>
<span class="p">)</span>
</code></pre></div><p>è¿™éƒ¨åˆ†å†…å®¹å¯¼å…¥äº†ç¨‹åºéœ€è¦çš„åŒ…ï¼Œç¬¬äºŒéƒ¨åˆ†å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">pid</span><span class="p">,</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">syscall</span><span class="p">.</span><span class="nf">Syscall</span><span class="p">(</span><span class="mi">39</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;My pid is&#34;</span><span class="p">,</span> <span class="nx">pid</span><span class="p">)</span>
    <span class="nx">uid</span><span class="p">,</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">syscall</span><span class="p">.</span><span class="nf">Syscall</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;User ID:&#34;</span><span class="p">,</span> <span class="nx">uid</span><span class="p">)</span>
</code></pre></div><p>åœ¨è¿™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨çš„ä¸¤ä¸ªæ–¹æ³•<code>syscall.Syscall()</code>æ‰¾åˆ°ä¸€äº›å…³äºè¿›ç¨‹IDå’Œuser Idçš„ä¿¡æ¯ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°å†³å®šè¯·æ±‚çš„ä¿¡æ¯ã€‚</p>
<p>ç¬¬ä¸‰éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go">    <span class="nx">message</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">{</span><span class="sc">&#39;H&#39;</span><span class="p">,</span> <span class="sc">&#39;e&#39;</span><span class="p">,</span> <span class="sc">&#39;l&#39;</span><span class="p">,</span> <span class="sc">&#39;l&#39;</span><span class="p">,</span> <span class="sc">&#39;o&#39;</span><span class="p">,</span> <span class="sc">&#39;!&#39;</span><span class="p">,</span> <span class="sc">&#39;\n&#39;</span><span class="p">}</span>
    <span class="nx">fd</span> <span class="o">:=</span> <span class="mi">1</span>
    <span class="nx">syscall</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="nx">fd</span><span class="p">,</span> <span class="nx">message</span><span class="p">)</span>
</code></pre></div><p>åœ¨è¿™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<code>syscall.Write()</code>å‡½æ•°åœ¨å±å¹•ä¸Šæ‰“å°ä¸€äº›ä¿¡æ¯ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æˆ‘ä»¬å°†è¦å†™çš„æ–‡ä»¶æè¿°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ‰¿è½½ç€å®é™…ä¿¡æ¯çš„<code>byte</code>åˆ‡ç‰‡ã€‚<code>syscall.Write()</code>å‡½æ•°ååˆ†ä¾¿æ·ã€‚</p>
<p>æœ€åä¸€éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go">    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Using syscall.Exec()&#34;</span><span class="p">)</span>
    <span class="nx">command</span> <span class="o">:=</span> <span class="s">&#34;/bin/ls&#34;</span>
    <span class="nx">env</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nf">Environ</span><span class="p">()</span>
    <span class="nx">syscall</span><span class="p">.</span><span class="nf">Exec</span><span class="p">(</span><span class="nx">command</span><span class="p">,</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">&#34;ls&#34;</span><span class="p">,</span> <span class="s">&#34;-a&#34;</span><span class="p">,</span> <span class="s">&#34;-x&#34;</span><span class="p">},</span> <span class="nx">env</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><p>æœ€åä¸€éƒ¨åˆ†ä»£ç ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•ä½¿ç”¨<code>syscall.Exec()</code>å‡½æ•°æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬ä¸èƒ½å®Œå…¨æ§åˆ¶è¾“å…¥çš„å‘½ä»¤ï¼Œå®ƒæ˜¯è‡ªåŠ¨æ‰“å°åœ¨å±å¹•ä¸Šçš„ã€‚</p>
<p>åœ¨macOS Mojaveä¸Šæ‰§è¡Œä»£ç å‡ºç°å¦‚ä¸‹è¾“å‡ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ go run useSyscall.go
My pid is <span class="m">14602</span>
User ID: <span class="m">501</span>
Hello!
Using syscall.Exec<span class="o">()</span>
. .. a.go
funFun.go functions.go html.gohtml
htmlT.db htmlT.go manyInit.go
ptrFun.go returnFunction.go returnNames.go
returnPtr.go text.gotext textT.go
useAPackage.go useSyscall.go
</code></pre></div><p>åœ¨ Debian Linuxä¸Šæ‰§è¡Œä»£ç å‡ºç°å¦‚ä¸‹è¾“å‡ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ go run useSyscall.go
My pid is <span class="m">20853</span>
User ID: <span class="m">0</span>
Hello!
Using syscall.Exec<span class="o">()</span>
. .. a.go
funFun.go functions.go html.gohtml
htmlT.db htmlT.go manyInit.go
ptrFun.go returnFunction.go returnNames.go
returnPtr.go text.gotext textT.go
useAPackage.go useSyscall.go
</code></pre></div><p>æ‰€ä»¥ï¼Œè™½ç„¶å¤§å¤šæ•°çš„è¾“å‡ºå’Œä¹‹å‰çš„è¾“å‡ºç›¸ä¼¼ï¼Œä½†æ˜¯<code>syscall.Syscall(39, 0, 0, 0)</code>ä¸èƒ½å·¥ä½œåœ¨Linuxä¸Šé¢ï¼Œå› ä¸ºåœ¨Linuxä¸Šuser idä¸èƒ½ä¸º0ï¼Œè¿™æ„å‘³ç€å‘½ä»¤ä¸æ˜¯å¾ˆä¾¿æ·ã€‚</p>
<p>å¦‚æœæƒ³è¦æ‰¾åˆ°Goæ ‡å‡†åŒ…çš„<code>syscall</code>ï¼Œåœ¨UNIX shellä¸‹æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ grep <span class="se">\&#34;</span>syscall<span class="se">\&#34;</span> <span class="sb">`</span>find /usr/local/Cellar/go/1.12/libexec/src -name
<span class="s2">&#34;*.go&#34;</span><span class="sb">`</span>
</code></pre></div><p>è¯·æ›¿æ¢<code>/usr/local/Cellar/go/1.12/libexec/src</code>ä¸ºåˆé€‚çš„è·¯å¾„ã€‚</p>
<h1 id="fmtprintlnæ˜¯å¦‚ä½•å·¥ä½œçš„"><code>fmt.Println()</code>æ˜¯å¦‚ä½•å·¥ä½œçš„</h1>
<p>å¦‚æœä½ çœŸçš„æƒ³æŒæ¡<code>syscall</code>çš„ä½¿ç”¨ï¼Œé€šè¿‡å®ç°<code>fmt.Println()</code>å‡½æ•°(å¯ä»¥åœ¨<a class="link" href="https://golang.org/src/fmt/print.go"  target="_blank" rel="noopener"
    >https://golang.org/src/fmt/print.go</a>)ä¸­æ‰¾åˆ°ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">Println</span><span class="p">(</span><span class="nx">a</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">n</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nf">Fprintln</span><span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">Stdout</span><span class="p">,</span> <span class="nx">a</span><span class="o">...</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><p>è¿™æ„å‘³ç€<code>fmt.Println()</code>å‡½æ•°è°ƒç”¨äº†<code>fmt.Fprintln()</code>åšäº†ä¸€äº›å·¥ä½œã€‚<code>fmt.Fprintln()</code>çš„å®ç°ï¼Œåœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­å¯ä»¥æ‰¾åˆ°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">Fprintln</span><span class="p">(</span><span class="nx">w</span> <span class="nx">io</span><span class="p">.</span><span class="nx">Writer</span><span class="p">,</span> <span class="nx">a</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">n</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">p</span> <span class="o">:=</span> <span class="nf">newPrinter</span><span class="p">()</span>
    <span class="nx">p</span><span class="p">.</span><span class="nf">doPrintln</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span>
    <span class="nx">n</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">w</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">buf</span><span class="p">)</span>
    <span class="nx">p</span><span class="p">.</span><span class="nf">free</span><span class="p">()</span>
    <span class="k">return</span>
<span class="p">}</span>
</code></pre></div><p>è¿™æ„å‘³ç€åœ¨<code>fmt.Fprintln()</code>å‡½æ•°ä¸­ï¼Œå®é™…çš„å»å†™æ˜¯é€šè¿‡å®ç°<code>io.Writer</code>æ¥å£çš„<code>Write()</code>å‡½æ•°å»å†™çš„ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ã€‚<code>io.Writer</code>çš„æ¥å£æ˜¯<code>os.Stdout</code>ã€‚å®šä¹‰åœ¨<a class="link" href="https://golang.org/src/os/file.go"  target="_blank" rel="noopener"
    >https://golang.org/src/os/file.go</a>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">var</span> <span class="p">(</span>
    <span class="nx">Stdin</span> <span class="p">=</span> <span class="nf">NewFile</span><span class="p">(</span><span class="nb">uintptr</span><span class="p">(</span><span class="nx">syscall</span><span class="p">.</span><span class="nx">Stdin</span><span class="p">),</span> <span class="s">&#34;/dev/stdin&#34;</span><span class="p">)</span>
    <span class="nx">Stdout</span> <span class="p">=</span> <span class="nf">NewFile</span><span class="p">(</span><span class="nb">uintptr</span><span class="p">(</span><span class="nx">syscall</span><span class="p">.</span><span class="nx">Stdout</span><span class="p">),</span> <span class="s">&#34;/dev/stdout&#34;</span><span class="p">)</span>
    <span class="nx">Stderr</span> <span class="p">=</span> <span class="nf">NewFile</span><span class="p">(</span><span class="nb">uintptr</span><span class="p">(</span><span class="nx">syscall</span><span class="p">.</span><span class="nx">Stderr</span><span class="p">),</span> <span class="s">&#34;/dev/stderr&#34;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div><p>ç°åœ¨çœ‹<code>NewFile()</code>çš„å®ç°ï¼Œåœ¨<a class="link" href="ttps://golang.org/src/os/file_plan9.go" >ttps://golang.org/src/os/file_plan9.go</a>ä¸­å¯ä»¥æ‰¾åˆ°ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">NewFile</span><span class="p">(</span><span class="nx">fd</span> <span class="kt">uintptr</span><span class="p">,</span> <span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="o">*</span><span class="nx">File</span> <span class="p">{</span>
    <span class="nx">fdi</span> <span class="o">:=</span> <span class="nb">int</span><span class="p">(</span><span class="nx">fd</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">fdi</span> <span class="p">&lt;</span> <span class="mi">0</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">nil</span>
    <span class="p">}</span>
    <span class="nx">f</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">File</span><span class="p">{</span><span class="o">&amp;</span><span class="nx">file</span><span class="p">{</span><span class="nx">fd</span><span class="p">:</span> <span class="nx">fdi</span><span class="p">,</span> <span class="nx">name</span><span class="p">:</span> <span class="nx">name</span><span class="p">}}</span>
    <span class="nx">runtime</span><span class="p">.</span><span class="nf">SetFinalizer</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">file</span><span class="p">,</span> <span class="p">(</span><span class="o">*</span><span class="nx">file</span><span class="p">).</span><span class="nx">close</span><span class="p">)</span>
    <span class="k">return</span> <span class="nx">f</span>
<span class="p">}</span>
</code></pre></div><p>å½“ä½ çœ‹åˆ°åä¸º<code>file_plan9.go</code>çš„æºæ–‡ä»¶æ—¶ï¼Œä½ åº”è¯¥æ€€ç–‘å®ƒæ˜¯å¦åŒ…å«ç‰¹æ®ŠUNIXå˜ä½“çš„å‘½ä»¤ï¼Œè¿™æ„å‘³ç€å®ƒåŒ…å«çš„ä»£ç ä¸æ˜¯å¾ˆä¾¿æ·ã€‚</p>
<p>æˆ‘ä»¬è¿™é‡Œæœ‰ä¸€ä¸ªæ–‡ä»¶ç»“æ„ç±»å‹ï¼Œå®ƒåµŒå…¥åœ¨æ–‡ä»¶ç±»å‹ä¸­ï¼Œå› ä¸ºå®ƒçš„åå­—è€Œè¢«å¯¼å‡ºã€‚æ‰€ä»¥ï¼Œå¼€å§‹åœ¨<a class="link" href="https://golang.org/src/os/file_plan9.go"  target="_blank" rel="noopener"
    >https://golang.org/src/os/file_plan9.go</a>å¯»æ‰¾åº”ç”¨åœ¨æ–‡ä»¶ç»“æ„æˆ–è€…æŒ‡å‘æ–‡ä»¶ç»“æ„çš„æŒ‡é’ˆï¼Œå®ƒå…è®¸æˆ‘ä»¬å†™å…¥æ•°æ®ã€‚ä½œä¸ºæˆ‘ä»¬å¯»æ‰¾çš„åä¸º<code>Write()</code>çš„å‡½æ•°ï¼Œçœ‹<code>Fprintln()</code>çš„å®ç°ï¼Œæˆ‘ä»¬å°†ä¸å¾—ä¸åœ¨<code>os</code>åŒ…ä¸­çš„æ‰€æœ‰çš„æºæ–‡ä»¶ä¸­å¯»æ‰¾å®ƒä»¬ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ grep <span class="s2">&#34;func (f \*File) Write(&#34;</span> *.go
file.go:func <span class="o">(</span>f *File<span class="o">)</span> Write<span class="o">(</span>b <span class="o">[]</span>byte<span class="o">)</span> <span class="o">(</span>n int, err error<span class="o">)</span> <span class="o">{</span>
</code></pre></div><p>åœ¨<a class="link" href="https://golang.org/src/os/file.go"  target="_blank" rel="noopener"
    >https://golang.org/src/os/file.go</a>ä¸­<code>Write()</code>çš„å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">File</span><span class="p">)</span> <span class="nf">Write</span><span class="p">(</span><span class="nx">b</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="nx">n</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">f</span><span class="p">.</span><span class="nf">checkValid</span><span class="p">(</span><span class="s">&#34;write&#34;</span><span class="p">);</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">err</span>
    <span class="p">}</span>
    <span class="nx">n</span><span class="p">,</span> <span class="nx">e</span> <span class="o">:=</span> <span class="nx">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">n</span> <span class="p">&lt;</span> <span class="mi">0</span> <span class="p">{</span>
        <span class="nx">n</span> <span class="p">=</span> <span class="mi">0</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="nx">n</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">err</span> <span class="p">=</span> <span class="nx">io</span><span class="p">.</span><span class="nx">ErrShortWrite</span>
    <span class="p">}</span>
    <span class="nf">epipecheck</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">e</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">e</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">err</span> <span class="p">=</span> <span class="nx">f</span><span class="p">.</span><span class="nf">wrapErr</span><span class="p">(</span><span class="s">&#34;write&#34;</span><span class="p">,</span> <span class="nx">e</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">err</span>
<span class="p">}</span>
</code></pre></div><p>è¿™æ„å‘³ç€æˆ‘ä»¬ç°åœ¨ä¸å¾—ä¸å¯»æ‰¾<code>write()</code>å‡½æ•°ã€‚å¯»æ‰¾åœ¨<a class="link" href="https://golang.org/src/os/file_plan9.go"  target="_blank" rel="noopener"
    >https://golang.org/src/os/file_plan9.go</a>ä¸­çš„write stringï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">File</span><span class="p">)</span> <span class="nf">write</span><span class="p">(</span><span class="nx">b</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="nx">n</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
         <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">nil</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nf">fixCount</span><span class="p">(</span><span class="nx">syscall</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">fd</span><span class="p">,</span> <span class="nx">b</span><span class="p">))</span>
<span class="p">}</span>
</code></pre></div><p>å¯¹<code>fmt.Println()</code>å‡½æ•°çš„è°ƒç”¨æ˜¯ä½¿ç”¨å¯¹<code>syscall.Write()</code>çš„è°ƒç”¨å®ç°çš„ã€‚è¿™è¯´æ˜äº†<code>syscall</code>åŒ…æ˜¯å¾ˆé‡è¦çš„ã€‚</p>
<h1 id="goscanner-goparser-å’ŒgotokenåŒ…"><code>go/scanner, go/parser, å’Œgo/token</code>åŒ…</h1>
<p>è¿™ç« å°†è®²è§£å…³äº<code>go/scanner, go/parser, å’Œgo/token</code>åŒ…çš„å†…å®¹ï¼Œå’Œ<code>go/ast</code>ä¸€æ ·ï¼Œè¿™æ˜¯æœ‰å…³Goæ‰«ç å’Œè§£æGoä»£ç çš„åº•å±‚çŸ¥è¯†ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç†è§£Goæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ç„¶è€Œï¼Œå¦‚æœåº•å±‚çŸ¥è¯†å¤ªéš¾ï¼Œä½ å¯èƒ½æƒ³è¦è·³è¿‡è¿™ä¸€ç« ã€‚</p>
<p>è§£æè¯­æ³•éœ€è¦ä¸¤ä¸ªé˜¶æ®µã€‚ç¬¬ä¸€ä¸ªé˜¶æ®µæ˜¯å°†è¾“å…¥åˆ†è§£ä¸ºæ ‡è®°(è¯æ³•åˆ†æ)ï¼Œç¬¬äºŒä¸ªé˜¶æ®µæ˜¯å°†æ‰€æœ‰è¿™äº›æ ‡è®°æä¾›ç»™è§£æå™¨ï¼Œä»¥ç¡®ä¿è¿™äº›æ ‡è®°æœ‰æ„ä¹‰ä¸”é¡ºåºæ­£ç¡®ï¼ˆè¯­æ³•åˆ†æï¼‰ã€‚ä»…ä»…ç»“åˆè‹±è¯­å•è¯å¹¶ä¸æ€»èƒ½åˆ›é€ å‡ºæœ‰æ•ˆçš„å¥å­ã€‚</p>
<h1 id="goaståŒ…"><code>go/ast</code>åŒ…</h1>
<p>æŠ½è±¡è¯­æ³•æ ‘(AST)æ˜¯Goæºä»£ç çš„ç»“æ„åŒ–è¡¨ç¤ºçš„ç¨‹åºã€‚è¿™ä¸ªæ ‘æ˜¯æ ¹æ®è¯­è¨€ä¸­æŒ‡å®šçš„ä¸€äº›è§„åˆ™æ„é€ çš„è§„èŒƒã€‚<code>go/ast</code>åœ¨goä¸­ä¸€èˆ¬ç”¨åœ¨å®šä¹‰æ•°æ®ç±»å‹ã€‚å¦‚æœä½ æƒ³è¦æ‰¾åˆ°æ›´å¤šçš„æœ‰å…³<code>ast.*</code>ç±»å‹ã€‚<code>go/ast</code>åŒ…çš„æºç å°†æ˜¯ä½ å­¦ä¹ çš„å¥½åœ°æ–¹ã€‚</p>
<h1 id="goscanneråŒ…"><code>go/scanner</code>åŒ…</h1>
<p>æ‰«æå™¨å°±æ˜¯ä¸€ä¸ªåœ¨ç¨‹åºä¸­èƒ½å¤Ÿè¯»å–å†™å…¥çš„ç»„ä»¶ã€‚åœ¨æ¡ˆä¾‹ä¸­ç”¨æ¥ç”Ÿæˆtokenã€‚<code>go/scanner</code>åŒ…ç”¨äºè¯»å–goç¨‹åºå¹¶ç”Ÿæˆä¸€ç³»åˆ—tokenã€‚<code>go/scanner</code>çš„ä½¿ç”¨å°†åœ¨<code>goScanner.go</code>ä¸­åˆ†ä¸‰éƒ¨åˆ†è§£é‡Šè¯´æ˜ã€‚ç¬¬ä¸€éƒ¨åˆ†å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
 <span class="s">&#34;fmt&#34;</span>
 <span class="s">&#34;go/scanner&#34;</span>
 <span class="s">&#34;go/token&#34;</span>
 <span class="s">&#34;io/ioutil&#34;</span>
 <span class="s">&#34;os&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">Args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Not enough arguments!&#34;</span><span class="p">)</span>
    <span class="k">return</span>
    <span class="p">}</span>
</code></pre></div><p><code>go/token</code>åŒ…å®šä¹‰äº†ä¸€äº›Goç¨‹åºä¸­çš„è¡¨ç¤ºå­—å…¸tokençš„å¸¸é‡ã€‚ç¬¬äºŒéƒ¨åˆ†å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go">    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">file</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Processing:&#34;</span><span class="p">,</span> <span class="nx">file</span><span class="p">)</span>
        <span class="nx">f</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">ioutil</span><span class="p">.</span><span class="nf">ReadFile</span><span class="p">(</span><span class="nx">file</span><span class="p">)</span>
        <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="nx">One</span> <span class="o">:=</span> <span class="nx">token</span><span class="p">.</span><span class="nf">NewFileSet</span><span class="p">()</span>
    <span class="nx">files</span> <span class="o">:=</span> <span class="nx">one</span><span class="p">.</span><span class="nf">AddFile</span><span class="p">(</span><span class="nx">file</span><span class="p">,</span> <span class="nx">one</span><span class="p">.</span><span class="nf">Base</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="nx">f</span><span class="p">))</span>
</code></pre></div><p>å°†è¢«æ ‡è®°åŒ–çš„æºæ–‡ä»¶å­˜å‚¨åœ¨fileå˜é‡ä¸­è€Œå…¶å†…å®¹å­˜å‚¨åœ¨fï¼Œæœ€åä¸€éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go">    <span class="kd">var</span> <span class="nx">myScanner</span> <span class="nx">scanner</span><span class="p">.</span><span class="nx">Scanner</span>
    <span class="nx">myScanner</span><span class="p">.</span><span class="nf">Init</span><span class="p">(</span><span class="nx">files</span><span class="p">,</span> <span class="nx">f</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">scanner</span><span class="p">.</span><span class="nx">ScanComments</span><span class="p">)</span>
    <span class="k">for</span> <span class="p">{</span>
        <span class="nx">pos</span><span class="p">,</span> <span class="nx">tok</span><span class="p">,</span> <span class="nx">lit</span> <span class="o">:=</span> <span class="nx">myScanner</span><span class="p">.</span><span class="nf">Scan</span><span class="p">()</span>
        <span class="k">if</span> <span class="nx">tok</span> <span class="o">==</span> <span class="nx">token</span><span class="p">.</span><span class="nx">EOF</span> <span class="p">{</span>
            <span class="k">break</span>
        <span class="p">}</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;%s\t%s\t%q\n&#34;</span><span class="p">,</span> <span class="nx">one</span><span class="p">.</span><span class="nf">Position</span><span class="p">(</span><span class="nx">pos</span><span class="p">),</span> <span class="nx">tok</span><span class="p">,</span> <span class="nx">lit</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p><code>for</code>å¾ªç¯ç”¨æ¥éå†è¾“å…¥çš„æ–‡ä»¶ã€‚æºç ä¸­ç”¨<code>toker.EOF</code>è¡¨ç¤ºç»“å°¾é€€å‡º<code>for</code>å¾ªç¯ã€‚<code>scanner.Scan()</code>å‡½æ•°è¿”å›å½“å‰æ–‡ä»¶çš„ä¸‹æ ‡ã€tokenã€å’Œæ–‡ä»¶åã€‚<code>scanner.Init()</code>çš„<code>scanner.ScanComments</code>çš„ä½¿ç”¨å‘Šè¯‰æ‰«æå™¨è¿”å›tokençš„æ³¨è§£ã€‚ä½ å¯ä»¥ä½¿ç”¨1ä»£æ›¿<code>scanner.ScanComments</code>ï¼Œå¦‚æœä½ ä¸æƒ³çœ‹åˆ°tokençš„æ³¨è§£è¾“å‡ºï¼Œç”¨0ä»£æ›¿<code>scanner.ScanComments</code>ã€‚buildåæ‰§è¡Œä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ ./goScanner a.go
Processing: a.go
a.go:1:1 package <span class="s2">&#34;package&#34;</span>
a.go:1:9 IDENT <span class="s2">&#34;a&#34;</span>
a.go:1:10 <span class="p">;</span> <span class="s2">&#34;\n&#34;</span>
a.go:3:1 import <span class="s2">&#34;import&#34;</span>
a.go:3:8 <span class="o">(</span> <span class="s2">&#34;&#34;</span>
a.go:4:2 STRING <span class="s2">&#34;\&#34;fmt\&#34;&#34;</span>
a.go:4:7 <span class="p">;</span> <span class="s2">&#34;\n&#34;</span>
a.go:5:1 <span class="o">)</span> <span class="s2">&#34;&#34;</span>
a.go:5:2 <span class="p">;</span> <span class="s2">&#34;\n&#34;</span>
a.go:7:1 func <span class="s2">&#34;func&#34;</span>
a.go:7:6 IDENT <span class="s2">&#34;init&#34;</span>
a.go:7:10 <span class="o">(</span> <span class="s2">&#34;&#34;</span>
a.go:7:11 <span class="o">)</span> <span class="s2">&#34;&#34;</span>
a.go:7:13 <span class="o">{</span> <span class="s2">&#34;&#34;</span>
a.go:8:2 IDENT <span class="s2">&#34;fmt&#34;</span>
a.go:8:5 . <span class="s2">&#34;&#34;</span>
a.go:8:6 IDENT <span class="s2">&#34;Println&#34;</span>
a.go:8:13 <span class="o">(</span> <span class="s2">&#34;&#34;</span>
a.go:8:14 STRING <span class="s2">&#34;\&#34;init() a\&#34;&#34;</span>
a.go:8:24 <span class="o">)</span> <span class="s2">&#34;&#34;</span>
a.go:8:25 <span class="p">;</span> <span class="s2">&#34;\n&#34;</span>
a.go:9:1 <span class="o">}</span> <span class="s2">&#34;&#34;</span>
a.go:9:2 <span class="p">;</span> <span class="s2">&#34;\n&#34;</span>
a.go:11:1 func <span class="s2">&#34;func&#34;</span>
a.go:11:6 IDENT <span class="s2">&#34;FromA&#34;</span>
a.go:11:11 <span class="o">(</span> <span class="s2">&#34;&#34;</span>
a.go:11:12 <span class="o">)</span> <span class="s2">&#34;&#34;</span>
a.go:11:14 <span class="o">{</span> <span class="s2">&#34;&#34;</span>
a.go:12:2 IDENT <span class="s2">&#34;fmt&#34;</span>
a.go:12:5 . <span class="s2">&#34;&#34;</span>
a.go:12:6 IDENT <span class="s2">&#34;Println&#34;</span>
a.go:12:13 <span class="o">(</span> <span class="s2">&#34;&#34;</span>
a.go:12:14 STRING <span class="s2">&#34;\&#34;fromA()\&#34;&#34;</span>
a.go:12:23 <span class="o">)</span> <span class="s2">&#34;&#34;</span>
a.go:12:24 <span class="p">;</span> <span class="s2">&#34;\n&#34;</span>
a.go:13:1 <span class="o">}</span> <span class="s2">&#34;&#34;</span>
a.go:13:2 <span class="p">;</span> <span class="s2">&#34;\n&#34;</span>
</code></pre></div><p><code>goScanner.go</code>è¾“å‡ºåå¾ˆç®€å•ã€‚æ³¨æ„<code>goScanner.go</code>å¯ä»¥æ‰«æä»»ä½•ç±»å‹çš„æ–‡ä»¶ï¼Œå³ä½¿æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ç„¶è€Œï¼Œå¦‚æœä½ æ‰«æäºŒè¿›åˆ¶æ–‡ä»¶ã€‚ä½ å¯èƒ½å¾—åˆ°çœ‹ä¸æ‡‚çš„è¾“å‡ºã€‚ä»è¾“å‡ºä¸­å¯ä»¥çœ‹åˆ°ï¼ŒGoæ‰«æå™¨è‡ªåŠ¨åŠ äº†åˆ†éš”ç¬¦ã€‚è¯·æ³¨æ„ï¼ŒIDENTé€šçŸ¥ä¸€ä¸ªæ ‡è¯†ç¬¦ï¼Œè¿™æ˜¯æœ€æµè¡Œçš„tokenç±»å‹ã€‚</p>
<p>ä¸‹ä¸€ç« å°†å¤„ç†è§£æè¿‡ç¨‹</p>
<h1 id="goparseråŒ…"><code>go/parser</code>åŒ…</h1>
<p>è§£æå™¨è¯»å–scannerçš„è¾“å‡ºä¸ºäº†ç”Ÿæˆè¿™äº›tokençš„ç»“æ„ã€‚è§£æå™¨ä½¿ç”¨è¯­æ³•å™¨æè¿°è¯­æ³•ï¼Œä¸ºäº†ç¡®ä¿ç»™çš„tokenæ˜¯æœ‰æ•ˆçš„è¯­æ³•ã€‚è¿™ä¸ªç»“æ„å±•ç¤ºå‡ºæ¥å¦‚åŒæ ‘çš„ç»“æ„ï¼Œå®ƒå°±æ˜¯ASTã€‚</p>
<p><code>goParser.go</code>è¯´æ˜äº†å¤„ç†<code>go/token</code>è¾“å‡ºçš„<code>go/parser</code>åŒ…çš„ä½¿ç”¨ã€‚æ¥ä¸‹æ¥é€šè¿‡4ä¸ªéƒ¨åˆ†å±•ç¤ºè¯´æ˜ï¼š</p>
<p>ç¬¬ä¸€éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
 <span class="s">&#34;fmt&#34;</span>
 <span class="s">&#34;go/ast&#34;</span>
 <span class="s">&#34;go/parser&#34;</span>
 <span class="s">&#34;go/token&#34;</span>
 <span class="s">&#34;os&#34;</span>
 <span class="s">&#34;strings&#34;</span>
<span class="p">)</span>

<span class="kd">type</span> <span class="nx">visitor</span> <span class="kt">int</span>
</code></pre></div><p>ç¬¬äºŒéƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">v</span> <span class="nx">visitor</span><span class="p">)</span> <span class="nf">Visit</span><span class="p">(</span><span class="nx">n</span> <span class="nx">ast</span><span class="p">.</span><span class="nx">Node</span><span class="p">)</span> <span class="nx">ast</span><span class="p">.</span><span class="nx">Visitor</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nx">n</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">nil</span>
    <span class="p">}</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;%s%T\n&#34;</span><span class="p">,</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">Repeat</span><span class="p">(</span><span class="s">&#34;\t&#34;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nx">v</span><span class="p">)),</span> <span class="nx">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="nx">v</span> <span class="o">+</span> <span class="mi">1</span>
<span class="p">}</span>
</code></pre></div><p><code>Visit()</code>å‡½æ•°å°†è¢«ASTçš„æ¯ä¸ªNodeè°ƒç”¨ã€‚ç¬¬ä¸‰éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">Args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Not enough arguments!&#34;</span><span class="p">)</span>
    <span class="k">return</span>
 <span class="p">}</span>
</code></pre></div><p>æœ€åä¸€éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go">    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">file</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Processing:&#34;</span><span class="p">,</span> <span class="nx">file</span><span class="p">)</span>
    <span class="nx">one</span> <span class="o">:=</span> <span class="nx">token</span><span class="p">.</span><span class="nf">NewFileSet</span><span class="p">()</span>
    <span class="kd">var</span> <span class="nx">v</span> <span class="nx">visitor</span>
    <span class="nx">f</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">parser</span><span class="p">.</span><span class="nf">ParseFile</span><span class="p">(</span><span class="nx">one</span><span class="p">,</span> <span class="nx">file</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">parser</span><span class="p">.</span><span class="nx">AllErrors</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="nx">ast</span><span class="p">.</span><span class="nf">Walk</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">f</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p><code>Walk()</code>å‡½æ•°è¢«é€’å½’è°ƒç”¨ï¼Œç”¨æ·±åº¦éå†ä¼˜å…ˆéå†ASTï¼Œè®¿é—®æ‰€æœ‰çš„èŠ‚ç‚¹ã€‚</p>
<p>buildingå’Œæ‰§è¡Œ<code>goParser.go</code>å»æ‰¾åˆ°ç®€å•åˆä¾¿æ·çš„ASTã€‚è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ ./goParser a.go
Processing: a.go
*ast.File
 *ast.Ident
 *ast.GenDecl
 *ast.ImportSpec
 *ast.BasicLit
 *ast.FuncDecl
 *ast.Ident
 *ast.FuncType
 *ast.FieldList
 *ast.BlockStmt
 *ast.ExprStmt
 *ast.CallExpr
 *ast.SelectorExpr
 *ast.Ident
 *ast.Ident
 *ast.BasicLit
 *ast.FuncDecl
 *ast.Ident
 *ast.FuncType
 *ast.FieldList
 *ast.BlockStmt
 *ast.ExprStmt
 *ast.CallExpr
 *ast.SelectorExpr
 *ast.Ident
 *ast.Ident
 *ast.BasicLit
</code></pre></div><p><code>goParser.go</code>ç®€å•çš„è¾“å‡ºå°±å¾—åˆ°äº†ã€‚ç„¶è€Œå®ƒå’Œ<code>goScanner.go.</code>çš„è¾“å‡ºå®Œå…¨ä¸åŒã€‚</p>
<p>ç°åœ¨ä½ å·²ç»çŸ¥é“äº†Goæ‰«æå™¨å’ŒGoè§£æå™¨çš„è¾“å‡ºç»“æœï¼Œæ¥ä¸‹æ¥å‡†å¤‡çœ‹ä¸€äº›æ›´å®ç”¨çš„ä¾‹å­ã€‚</p>
<h1 id="å®ç”¨æ¡ˆä¾‹">å®ç”¨æ¡ˆä¾‹</h1>
<p>åœ¨è¿™ç« ä¸­ï¼Œæˆ‘ä»¬å°†å†™ä¸€ä¸ªåœ¨è¾“å…¥æ–‡ä»¶ä¸­è®¡ç®—å…³é”®å­—å‡ºç°æ¬¡æ•°çš„Goç¨‹åºã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå…³é”®å­—ä¸ºâ€œvarâ€ã€‚åŠŸèƒ½çš„åå­—ä¸º<code>varTimes.go</code>ï¼Œå®ƒå°†åˆ†4éƒ¨åˆ†å±•ç¤ºã€‚ç¬¬ä¸€éƒ¨åˆ†å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
 <span class="s">&#34;fmt&#34;</span>
 <span class="s">&#34;go/scanner&#34;</span>
 <span class="s">&#34;go/token&#34;</span>
 <span class="s">&#34;io/ioutil&#34;</span>
 <span class="s">&#34;os&#34;</span>
<span class="p">)</span>

<span class="kd">var</span> <span class="nx">KEYWORD</span> <span class="p">=</span> <span class="s">&#34;var&#34;</span>
<span class="kd">var</span> <span class="nx">COUNT</span> <span class="p">=</span> <span class="mi">0</span>
</code></pre></div><p>ä½ å¯ä»¥æœç´¢ä»»ä½•ä½ æƒ³è¦çš„Goå…³é”®å­—â€”â€”å¦‚æœä½ ä¿®æ”¹äº†<code>varTimes.go</code>ï¼Œä½ ç”šè‡³å¯ä»¥åœ¨è¿è¡Œæ—¶è®¾ç½®å…¨å±€å…³é”®å­—å˜é‡çš„å€¼ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">Args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Not enough arguments!&#34;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">file</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Processing:&#34;</span><span class="p">,</span> <span class="nx">file</span><span class="p">)</span>
    <span class="nx">f</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">ioutil</span><span class="p">.</span><span class="nf">ReadFile</span><span class="p">(</span><span class="nx">file</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
        <span class="nx">sreturn</span>
    <span class="p">}</span>
    <span class="nx">one</span> <span class="o">:=</span> <span class="nx">token</span><span class="p">.</span><span class="nf">NewFileSet</span><span class="p">()</span>
    <span class="nx">files</span> <span class="o">:=</span> <span class="nx">one</span><span class="p">.</span><span class="nf">AddFile</span><span class="p">(</span><span class="nx">file</span><span class="p">,</span> <span class="nx">one</span><span class="p">.</span><span class="nf">Base</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="nx">f</span><span class="p">))</span>
</code></pre></div><p>ç¬¬ä¸‰éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go">    <span class="kd">var</span> <span class="nx">myScanner</span> <span class="nx">scanner</span><span class="p">.</span><span class="nx">Scanner</span>
    <span class="nx">myScanner</span><span class="p">.</span><span class="nf">Init</span><span class="p">(</span><span class="nx">files</span><span class="p">,</span> <span class="nx">f</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">scanner</span><span class="p">.</span><span class="nx">ScanComments</span><span class="p">)</span>
    <span class="nx">localCount</span> <span class="o">:=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="p">{</span>
        <span class="nx">_</span><span class="p">,</span> <span class="nx">tok</span><span class="p">,</span> <span class="nx">lit</span> <span class="o">:=</span> <span class="nx">myScanner</span><span class="p">.</span><span class="nf">Scan</span><span class="p">()</span>
        <span class="k">if</span> <span class="nx">tok</span> <span class="o">==</span> <span class="nx">token</span><span class="p">.</span><span class="nx">EOF</span> <span class="p">{</span>
        <span class="k">break</span>
        <span class="p">}</span>
</code></pre></div><p>åœ¨æœ¬ä¾‹ä¸­ï¼Œå‘ç°æ ‡è®°çš„ä½ç½®è¢«å¿½ç•¥ï¼Œå› ä¸ºè¿™ä¸é‡è¦ã€‚ä½†æ˜¯ï¼Œè¦æ‰¾å‡ºæ–‡ä»¶çš„ç»“å°¾ï¼Œéœ€è¦ä½¿ç”¨tokå˜é‡ã€‚</p>
<p>æœ€åä¸€éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go">    <span class="k">if</span> <span class="nx">lit</span> <span class="o">==</span> <span class="nx">KEYWORD</span> <span class="p">{</span>
    <span class="nx">COUNT</span><span class="o">++</span>
    <span class="nx">localCount</span><span class="o">++</span>
    <span class="p">}</span>
  <span class="p">}</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Found _%s_ %d times\n&#34;</span><span class="p">,</span> <span class="nx">KEYWORD</span><span class="p">,</span> <span class="nx">localCount</span><span class="p">)</span>
 <span class="p">}</span>
 <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Found _%s_ %d times in total\n&#34;</span><span class="p">,</span> <span class="nx">KEYWORD</span><span class="p">,</span> <span class="nx">COUNT</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><p>ç¼–è¯‘æ‰§è¡Œå<code>varTimes.go</code>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ go build varTimes.go
$ ./varTimes varTimes.go variadic.go a.go
Processing: varTimes.go
Found _var_ <span class="m">3</span> <span class="nb">times</span>
Processing: variadic.go
Found _var_ <span class="m">0</span> <span class="nb">times</span>
Processing: a.go
Found _var_ <span class="m">0</span> <span class="nb">times</span>
Found _var_ <span class="m">3</span> <span class="nb">times</span> in total
</code></pre></div><h1 id="æŸ¥æ‰¾å…·æœ‰ç»™å®šå­—ç¬¦ä¸²é•¿åº¦çš„å˜é‡å">æŸ¥æ‰¾å…·æœ‰ç»™å®šå­—ç¬¦ä¸²é•¿åº¦çš„å˜é‡å</h1>
<p>è¿™ç« å°†å±•ç¤ºå…¶ä»–ä½¿ç”¨æ¡ˆä¾‹ï¼Œå°†ä¼šæ¯”ä¹‹å‰åœ¨<code>varTimes.go</code>çš„æ¡ˆä¾‹æ›´åŠ é«˜çº§ã€‚ä½ å°†çœ‹åˆ°å¦‚ä½•æŸ¥æ‰¾å…·æœ‰ç»™å®šå­—ç¬¦ä¸²é•¿åº¦çš„å˜é‡åï¼Œä½ èƒ½ä½¿ç”¨ä»»ä½•ä½ æƒ³è¦çš„å­—ç¬¦ä¸²é•¿åº¦ã€‚æ­¤å¤–ï¼Œè¯¥ç¨‹åºå°†èƒ½å¤ŸåŒºåˆ†å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡ã€‚</p>
<p>æœ¬åœ°å˜é‡å®šä¹‰åœ¨å‡½æ•°å†…éƒ¨ï¼Œè€Œå…¨å±€å˜é‡å®šä¹‰åœ¨å‡½æ•°å¤–éƒ¨ã€‚å…¨å±€å˜é‡ä¹Ÿç§°ä¸ºåŒ…å˜é‡ã€‚</p>
<p>The name of the utility is varSize.go and it will be presented in four parts. The first part of varSize.go is as follows:
åä¸º<code>varSize.go</code>çš„ç¨‹åºå°†åˆ†ä¸º4ä¸ªéƒ¨åˆ†ã€‚ç¬¬ä¸€éƒ¨åˆ†å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
 <span class="s">&#34;fmt&#34;</span>
 <span class="s">&#34;go/ast&#34;</span>
 <span class="s">&#34;go/parser&#34;</span>
 <span class="s">&#34;go/token&#34;</span>
 <span class="s">&#34;os&#34;</span>
 <span class="s">&#34;strconv&#34;</span>
<span class="p">)</span>

<span class="kd">var</span> <span class="nx">SIZE</span> <span class="p">=</span> <span class="mi">2</span>
<span class="kd">var</span> <span class="nx">GLOBAL</span> <span class="p">=</span> <span class="mi">0</span>
<span class="kd">var</span> <span class="nx">LOCAL</span> <span class="p">=</span> <span class="mi">0</span>

<span class="kd">type</span> <span class="nx">visitor</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">Package</span> <span class="kd">map</span><span class="p">[</span><span class="o">*</span><span class="nx">ast</span><span class="p">.</span><span class="nx">GenDecl</span><span class="p">]</span><span class="kt">bool</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">makeVisitor</span><span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">ast</span><span class="p">.</span><span class="nx">File</span><span class="p">)</span> <span class="nx">visitor</span> <span class="p">{</span>
    <span class="nx">k1</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">map</span><span class="p">[</span><span class="o">*</span><span class="nx">ast</span><span class="p">.</span><span class="nx">GenDecl</span><span class="p">]</span><span class="kt">bool</span><span class="p">)</span>
    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">aa</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">f</span><span class="p">.</span><span class="nx">Decls</span> <span class="p">{</span>
        <span class="nx">v</span><span class="p">,</span> <span class="nx">ok</span> <span class="o">:=</span> <span class="nx">aa</span><span class="p">.(</span><span class="o">*</span><span class="nx">ast</span><span class="p">.</span><span class="nx">GenDecl</span><span class="p">)</span>
        <span class="k">if</span> <span class="nx">ok</span> <span class="p">{</span>
            <span class="nx">k1</span><span class="p">[</span><span class="nx">v</span><span class="p">]</span> <span class="p">=</span> <span class="kc">true</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">visitor</span><span class="p">{</span><span class="nx">k1</span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>ä¸ºäº†åŒºåˆ†æœ¬åœ°å˜é‡å’Œå…¨å±€å˜é‡ä¹‹é—´çš„å…³ç³»ï¼Œæˆ‘ä»¬å®šä¹‰äº†å…¨å±€å˜é‡GLOBALå’Œæœ¬åœ°å˜é‡LOCALä¿æŒä»–ä»¬çš„è®¡æ•°ã€‚<code>visitor</code>ç»“æ„ä½“çš„ä½¿ç”¨å°†å¸®åŠ©æˆ‘ä»¬åŒºåˆ†æœ¬åœ°å˜é‡å’Œå…¨å±€å˜é‡ã€‚å› æ­¤mapå­—æ®µå®šä¹‰åœ¨<code>visitor</code>ç»“æ„ä½“ï¼Œ<code>makeVisitor()</code>å‡½æ•°çš„ä½œç”¨æ˜¯æ ¹æ®å‚æ•°çš„å€¼åˆå§‹åŒ–<code>visitor</code>ç»“æ„ä½“ï¼Œå®ƒæ˜¯ä¸€ä¸ªä»£è¡¨æ•´ä¸ªæ–‡ä»¶çš„æ–‡ä»¶èŠ‚ç‚¹ã€‚ç¬¬äºŒéƒ¨åˆ†ä»£ç çš„å®ç°å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">v</span> <span class="nx">visitor</span><span class="p">)</span> <span class="nf">Visit</span><span class="p">(</span><span class="nx">n</span> <span class="nx">ast</span><span class="p">.</span><span class="nx">Node</span><span class="p">)</span> <span class="nx">ast</span><span class="p">.</span><span class="nx">Visitor</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nx">n</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">nil</span>
    <span class="p">}</span>
    <span class="k">switch</span> <span class="nx">d</span> <span class="o">:=</span> <span class="nx">n</span><span class="p">.(</span><span class="kd">type</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="o">*</span><span class="nx">ast</span><span class="p">.</span><span class="nx">AssignStmt</span><span class="p">:</span>
            <span class="k">if</span> <span class="nx">d</span><span class="p">.</span><span class="nx">Tok</span> <span class="o">!=</span> <span class="nx">token</span><span class="p">.</span><span class="nx">DEFINE</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">v</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">name</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">d</span><span class="p">.</span><span class="nx">Lhs</span> <span class="p">{</span>
                <span class="nx">v</span><span class="p">.</span><span class="nf">isItLocal</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="o">*</span><span class="nx">ast</span><span class="p">.</span><span class="nx">RangeStmt</span><span class="p">:</span>
            <span class="nx">v</span><span class="p">.</span><span class="nf">isItLocal</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">Key</span><span class="p">)</span>
            <span class="nx">v</span><span class="p">.</span><span class="nf">isItLocal</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">Value</span><span class="p">)</span>
        <span class="k">case</span> <span class="o">*</span><span class="nx">ast</span><span class="p">.</span><span class="nx">FuncDecl</span><span class="p">:</span>
            <span class="k">if</span> <span class="nx">d</span><span class="p">.</span><span class="nx">Recv</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
                <span class="nx">v</span><span class="p">.</span><span class="nf">CheckAll</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">Recv</span><span class="p">.</span><span class="nx">List</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="nx">v</span><span class="p">.</span><span class="nf">CheckAll</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">Type</span><span class="p">.</span><span class="nx">Params</span><span class="p">.</span><span class="nx">List</span><span class="p">)</span>
            <span class="k">if</span> <span class="nx">d</span><span class="p">.</span><span class="nx">Type</span><span class="p">.</span><span class="nx">Results</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
                <span class="nx">v</span><span class="p">.</span><span class="nf">CheckAll</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">Type</span><span class="p">.</span><span class="nx">Results</span><span class="p">.</span><span class="nx">List</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="o">*</span><span class="nx">ast</span><span class="p">.</span><span class="nx">GenDecl</span><span class="p">:</span>
            <span class="k">if</span> <span class="nx">d</span><span class="p">.</span><span class="nx">Tok</span> <span class="o">!=</span> <span class="nx">token</span><span class="p">.</span><span class="nx">VAR</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">v</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">spec</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">d</span><span class="p">.</span><span class="nx">Specs</span> <span class="p">{</span>
            <span class="nx">value</span><span class="p">,</span> <span class="nx">ok</span> <span class="o">:=</span> <span class="nx">spec</span><span class="p">.(</span><span class="o">*</span><span class="nx">ast</span><span class="p">.</span><span class="nx">ValueSpec</span><span class="p">)</span>
            <span class="k">if</span> <span class="nx">ok</span> <span class="p">{</span>
                <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">name</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">value</span><span class="p">.</span><span class="nx">Names</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="nx">name</span><span class="p">.</span><span class="nx">Name</span> <span class="o">==</span> <span class="s">&#34;_&#34;</span> <span class="p">{</span>
                        <span class="k">continue</span>
                    <span class="p">}</span>
                    <span class="k">if</span> <span class="nx">v</span><span class="p">.</span><span class="nx">Package</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">name</span><span class="p">.</span><span class="nx">Name</span><span class="p">)</span> <span class="o">==</span> <span class="nx">SIZE</span> <span class="p">{</span>
                            <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;** %s\n&#34;</span><span class="p">,</span> <span class="nx">name</span><span class="p">.</span><span class="nx">Name</span><span class="p">)</span>
                            <span class="nx">GLOBAL</span><span class="o">++</span>
                        <span class="p">}</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">name</span><span class="p">.</span><span class="nx">Name</span><span class="p">)</span> <span class="o">==</span> <span class="nx">SIZE</span> <span class="p">{</span>
                            <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;* %s\n&#34;</span><span class="p">,</span> <span class="nx">name</span><span class="p">.</span><span class="nx">Name</span><span class="p">)</span>
                            <span class="nx">LOCAL</span><span class="o">++</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">v</span>
<span class="p">}</span>
</code></pre></div><p><code>Visit()</code>ä¸»è¦çš„å·¥ä½œæ˜¯å†³å®šnodeçš„ç±»å‹ï¼Œä»¥ä¾¿é‡‡å–ç›¸åº”çš„è¡ŒåŠ¨ã€‚è¿™éœ€è¦ä½¿ç”¨åˆ°<code>switch</code>è¯­å¥çš„å¸®åŠ©ã€‚</p>
<p><code>ast.AssignStmt</code>èŠ‚ç‚¹ä»£è¡¨ä½œä¸šæˆ–è€…å®šä¹‰çš„çŸ­å˜é‡ã€‚<code>ast.RangeStmt</code>èŠ‚ç‚¹æ˜¯ä¸€ç§ç»“æ„ç±»å‹ï¼Œç”¨äºè¡¨ç¤ºå¸¦æœ‰rangeå­å¥çš„forè¯­å¥ã€‚è¿™æ˜¯å¦ä¸€ä¸ªå£°æ˜æ–°çš„å±€éƒ¨å˜é‡çš„åœ°æ–¹ã€‚</p>
<p><code>ast.FuncDecl</code>æ˜¯ä¸€ä¸ªä»£è¡¨å‡½æ•°å®šä¹‰çš„ç»“æ„ä½“ç±»å‹ï¼Œè¢«å®šä¹‰åœ¨å‡½æ•°å†…éƒ¨çš„æ¯ä¸ªå˜é‡éƒ½æ˜¯æœ¬åœ°å˜é‡ã€‚æœ€åï¼Œ<code>ast.GenDecl</code>æ˜¯ä¸€ä¸ªä»£è¡¨<code>import, constant, type</code>æˆ–è€…å˜é‡çš„ç»“æ„ä½“ç±»å‹ã€‚
ç„¶è€Œæˆ‘ä»¬ä»…ä»…éœ€è¦å…³æ³¨åœ¨<code>token.VAR</code>é‡Œçš„tokensã€‚ç¬¬ä¸‰éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">v</span> <span class="nx">visitor</span><span class="p">)</span> <span class="nf">isItLocal</span><span class="p">(</span><span class="nx">n</span> <span class="nx">ast</span><span class="p">.</span><span class="nx">Node</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">identifier</span><span class="p">,</span> <span class="nx">ok</span> <span class="o">:=</span> <span class="nx">n</span><span class="p">.(</span><span class="o">*</span><span class="nx">ast</span><span class="p">.</span><span class="nx">Ident</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">ok</span> <span class="o">==</span> <span class="kc">false</span> <span class="p">{</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="nx">identifier</span><span class="p">.</span><span class="nx">Name</span> <span class="o">==</span> <span class="s">&#34;_&#34;</span> <span class="o">||</span> <span class="nx">identifier</span><span class="p">.</span><span class="nx">Name</span> <span class="o">==</span> <span class="s">&#34;&#34;</span> <span class="p">{</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="nx">identifier</span><span class="p">.</span><span class="nx">Obj</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="o">&amp;&amp;</span> <span class="nx">identifier</span><span class="p">.</span><span class="nx">Obj</span><span class="p">.</span><span class="nf">Pos</span><span class="p">()</span> <span class="o">==</span> <span class="nx">identifier</span><span class="p">.</span><span class="nf">Pos</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">identifier</span><span class="p">.</span><span class="nx">Name</span><span class="p">)</span> <span class="o">==</span> <span class="nx">SIZE</span> <span class="p">{</span>
            <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;* %s\n&#34;</span><span class="p">,</span> <span class="nx">identifier</span><span class="p">.</span><span class="nx">Name</span><span class="p">)</span>
            <span class="nx">LOCAL</span><span class="o">++</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">v</span> <span class="nx">visitor</span><span class="p">)</span> <span class="nf">CheckAll</span><span class="p">(</span><span class="nx">fs</span> <span class="p">[]</span><span class="o">*</span><span class="nx">ast</span><span class="p">.</span><span class="nx">Field</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">f</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">fs</span> <span class="p">{</span>
        <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">name</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">f</span><span class="p">.</span><span class="nx">Names</span> <span class="p">{</span>
            <span class="nx">v</span><span class="p">.</span><span class="nf">isItLocal</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>è¿™ä¸¤ä¸ªå‡½æ•°æ˜¯å¸®åŠ©æ–¹æ³•ã€‚ç¬¬ä¸€ä¸ªèŠ‚ç‚¹å†³å®šæ ‡è¯†ç¬¦èŠ‚ç‚¹æ˜¯å¦æ˜¯å±€éƒ¨å˜é‡ï¼Œç¬¬äºŒä¸ªèŠ‚ç‚¹è®¿é—®<code>ast.Field</code>èŠ‚ç‚¹æ£€æŸ¥å…¶å†…å®¹æ˜¯å¦åŒ…å«å±€éƒ¨å˜é‡ã€‚æœ€åä¸€éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">Args</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Not enough arguments!&#34;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="nx">temp</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">strconv</span><span class="p">.</span><span class="nf">Atoi</span><span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">Args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">SIZE</span> <span class="p">=</span> <span class="mi">2</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Using default SIZE:&#34;</span><span class="p">,</span> <span class="nx">SIZE</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">SIZE</span> <span class="p">=</span> <span class="nx">temp</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">v</span> <span class="nx">visitor</span>
    <span class="nx">all</span> <span class="o">:=</span> <span class="nx">token</span><span class="p">.</span><span class="nf">NewFileSet</span><span class="p">()</span>
    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">file</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Args</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Processing:&#34;</span><span class="p">,</span> <span class="nx">file</span><span class="p">)</span>
        <span class="nx">f</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">parser</span><span class="p">.</span><span class="nf">ParseFile</span><span class="p">(</span><span class="nx">all</span><span class="p">,</span> <span class="nx">file</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">parser</span><span class="p">.</span><span class="nx">AllErrors</span><span class="p">)</span>
        <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="p">}</span>
        <span class="nx">v</span> <span class="p">=</span> <span class="nf">makeVisitor</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span>
        <span class="nx">ast</span><span class="p">.</span><span class="nf">Walk</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">f</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Local: %d, Global:%d with a length of %d.\n&#34;</span><span class="p">,</span> <span class="nx">LOCAL</span><span class="p">,</span> <span class="nx">GLOBAL</span><span class="p">,</span> <span class="nx">SIZE</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><p>è¿™ç¨‹åºç”Ÿæˆäº†å®ƒè¾“å…¥çš„ASTï¼Œä¸ºäº†é€‰å‡ºå¤–éƒ¨éœ€è¦çš„ä¿¡æ¯ã€‚åˆ†å‰²äº†<code>Visit()</code>æ–¹æ³•ï¼Œå®ƒæ˜¯æ¥å£çš„ä¸€éƒ¨åˆ†ï¼Œä¼‘æ¯çš„é€»è¾‘åœ¨<code>main()</code>å‡½æ•°ä¸­çš„<code>ast.Walk()</code>å‘ç”Ÿï¼Œè¿™ä¸ªå‡½æ•°è‡ªåŠ¨è®¿é—®äº†æ¯ä¸ªæ–‡ä»¶çš„æ‰€æœ‰çš„ASTèŠ‚ç‚¹ã€‚æ‰§è¡Œä»£ç ç”Ÿæˆå¦‚ä¸‹è¾“å‡ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ go build varSize.go
$ ./varSize
Not enough arguments!
$ ./varSize <span class="m">2</span> varSize.go variadic.go
Processing: varSize.go
* k1
* aa
* ok
* ok
* ok
* fs
Processing: variadic.go
Local: 6, Global:0 with a length of 2.
$ ./varSize <span class="m">3</span> varSize.go variadic.go
Processing: varSize.go
* err
* all
* err
Processing: variadic.go
* sum
* sum
Local: 5, Global:0 with a length of 3.
$ ./varSize <span class="m">7</span> varSize.go variadic.go
Processing: varSize.go
Processing: variadic.go
* message
Local: 1, Global:0 with a length of 7.
</code></pre></div><p>ä½ å¯ä»¥ç§»é™¤ä¸€äº›<code>fmt.Println()</code>è°ƒç”¨ï¼Œè¿™æ ·å°±ä¼šå°‘ä¸€äº›æ‚ä¹±çš„è¾“å‡ºã€‚</p>
<p>ä½ ç°åœ¨åœ¨Goä¸­åšäº†å¾ˆèªæ˜çš„äº‹æƒ…ï¼Œä½ çŸ¥é“å¦‚ä½•è§£æGoé™ˆåºï¼Œä½ ç”šè‡³å¯ä»¥å†™å‡ºä½ è‡ªå·±è§£æå™¨å’Œä½ è‡ªå·±çš„è¯­è¨€ã€‚å¦‚æœä½ çœŸçš„è¿›å…¥è§£æï¼Œä½ åº”è¯¥çœ‹ä¸€çœ¼<code>go/ast</code>è¿™ç« çš„å†…å®¹ï¼Œå®ƒçš„æºç åœ¨<a class="link" href="https://golang.org/pkg/go/ast/"  target="_blank" rel="noopener"
    >https://golang.org/pkg/go/ast/</a>å’Œ<a class="link" href="https://github.com/golang/go/tree/master/src/go/ast"  target="_blank" rel="noopener"
    >https://github.com/golang/go/tree/master/src/go/ast</a></p>
<h1 id="textå’Œhtmlæ¨¡æ¿">Textå’ŒHTMLæ¨¡æ¿</h1>
<p>è¿™ç« çš„ä¸»é¢˜å°†ä¼šæƒŠè‰³åˆ°ä½ ã€‚å› ä¸ºå½“å‰å±•ç¤ºçš„åŒ…ä¼šå¸¦ç»™ä½ å¾ˆå¤§çš„çµæ´»æ€§ï¼Œæˆ‘ç¡®ä¿¡ä½ å°†ä¼šæ‰¾åˆ°åˆ›é€ æ€§çš„æ–¹å¼å»ä½¿ç”¨å®ƒä»¬ï¼Œæ¨¡æ¿ä¸»è¦ç”¨äºåˆ†ç¦»è¾“å‡ºçš„æ ¼å¼åŒ–éƒ¨åˆ†å’Œæ•°æ®éƒ¨åˆ†ã€‚è¯·æ³¨æ„Goæ¨¡æ¿èƒ½å¤Ÿæˆä¸ºæ–‡ä»¶æˆ–è€…stringï¼Œä¸€èˆ¬çš„æƒ³æ³•æ˜¯å¯¹è¾ƒå°çš„æ¨¡æ¿ä½¿ç”¨å†…è”å­—ç¬¦ä¸²ï¼Œå¯¹è¾ƒå¤§çš„æ¨¡æ¿ä½¿ç”¨å¤–éƒ¨æ–‡ä»¶ã€‚</p>
<p>åœ¨Goè¯­è¨€ä¸­ï¼Œä¸èƒ½åŒæ—¶å¯¼å…¥<code>text/template</code>å’Œ<code>html/template</code>ï¼Œå› ä¸ºä¸¤ä¸ªåŒ…å…±äº«ç›¸ä¼¼çš„åŒ…å(<code>template</code>)ã€‚å¦‚æœç»å¯¹éœ€è¦çš„è¯ï¼Œä½ å¯ä»¥å°†å…¶ä¸­ä¸€ä¸ªèµ·ä¸€ä¸ªåˆ«åã€‚åœ¨ç¬¬å››ç« å¯ä»¥çœ‹<code>useStrings.go</code>çš„ä½¿ç”¨ï¼Œå¤åˆç±»å‹çš„ä½¿ç”¨ã€‚</p>
<p>Textçš„è¾“å‡ºç»å¸¸å±•ç¤ºåœ¨ä½ çš„å±å¹•ä¸Šï¼Œå› æ­¤htmlçš„è¾“å‡ºéœ€è¦æµè§ˆå™¨çš„å¸®åŠ©ã€‚ç„¶è€Œï¼Œtextçš„è¾“å‡ºè¦æ¯”htmlçš„è¾“å‡ºæ›´å¥½äº›ã€‚å¦‚æœä½ è®¤ä¸ºä½ å°†éœ€è¦ä½¿ç”¨å…¶ä»–UNIXçš„å‘½ä»¤è¡Œå·¥å…·æ‰§è¡ŒGoå·¥å…·çš„è¾“å‡ºï¼Œä½ åº”è¯¥ç”¨<code>text/template</code>ä»£æ›¿<code>html/template</code></p>
<p><code>text/template</code>å’Œ<code>html/template</code>ä¼šå‘Šè¯‰ä½ GoåŒ…æœ‰å¤šä¹ˆå¤æ‚ã€‚ä½ å¾ˆå¿«å°±ä¼šçœ‹åˆ°ï¼Œè¿™ä¸¤ä¸ªåŒ…éƒ½æ”¯æŒå®ƒä»¬è‡ªå·±çš„ç¼–ç¨‹è¯­è¨€â€”â€”å¥½çš„è½¯ä»¶ä½¿å¤æ‚çš„ä¸œè¥¿çœ‹èµ·æ¥ç®€å•è€Œä¼˜é›…ã€‚</p>
<h1 id="ç”Ÿæˆtextè¾“å‡º">ç”Ÿæˆtextè¾“å‡º</h1>
<p>å¦‚æœéœ€è¦åˆ›å»ºç®€å•çš„è¾“å‡ºï¼Œä½¿ç”¨<code>text/template</code>åŒ…æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚<code>text/templat</code>åŒ…å°†åœ¨<code>textT.go</code>æ–‡ä»¶ä¸­åˆ†5éƒ¨åˆ†è¯´æ˜ã€‚</p>
<p>templateç»å¸¸å­˜å‚¨åœ¨å¤–éƒ¨æ–‡ä»¶ä¸­ï¼Œä¾‹å­å°†å±•ç¤º<code>text.gotext</code>æ¨¡æ¿æ–‡ä»¶ï¼Œå°†åˆ†3ä¸ªéƒ¨åˆ†åˆ†æã€‚æ•°æ®æ˜¯åœ¨textä¸­æˆ–è€…ç½‘ç»œä¸­æ˜¯ç±»å‹å¯è¯»çš„ã€‚ç„¶è€Œæœ€ç®€å•çš„åŸå› å°±æ˜¯<code>text.gotext</code>æ–‡ä»¶ä¸­çš„æ•°æ®è¢«ç¨‹åºä½¿ç”¨åˆ‡ç‰‡è½¬æˆç¡¬ç¼–ç ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†çœ‹<code>textT.go</code>çš„Goä»£ç ã€‚ç¬¬ä¸€éƒ¨åˆ†ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
 <span class="s">&#34;fmt&#34;</span>
 <span class="s">&#34;os&#34;</span>
 <span class="s">&#34;text/template&#34;</span>
<span class="p">)</span>
</code></pre></div><p>ç¬¬äºŒéƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">Entry</span> <span class="kd">struct</span> <span class="p">{</span>
 <span class="nx">Number</span> <span class="kt">int</span>
 <span class="nx">Square</span> <span class="kt">int</span>
<span class="p">}</span>
</code></pre></div><p>ä½ å°†éœ€è¦å®šä¹‰ä¸€ä¸ªæ–°çš„æ•°æ®ç±»å‹å­˜å‚¨ä½ çš„æ•°æ®ï¼Œé™¤éä½ å¤„ç†éå¸¸ç®€å•çš„æ•°æ®ã€‚ç¬¬ä¸‰éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">arguments</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Args</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">arguments</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Need the template file!&#34;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="nx">tFile</span> <span class="o">:=</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="nx">DATA</span> <span class="o">:=</span> <span class="p">[][]</span><span class="kt">int</span><span class="p">{{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">},</span> <span class="p">{</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">},</span> <span class="p">{</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">16</span><span class="p">}}</span>
</code></pre></div><p><code>DATA</code>å˜é‡æ˜¯ä¸€ä¸ªäºŒç»´åˆ‡ç‰‡ï¼Œç”¨æ¥åˆå§‹åŒ–ä½ çš„æ•°æ®çš„ç‰ˆæœ¬ã€‚</p>
<p>ç¬¬å››éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go">    <span class="kd">var</span> <span class="nx">Entries</span> <span class="p">[]</span><span class="nx">Entry</span>
    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">i</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">DATA</span> <span class="p">{</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">{</span>
            <span class="nx">temp</span> <span class="o">:=</span> <span class="nx">Entry</span><span class="p">{</span><span class="nx">Number</span><span class="p">:</span> <span class="nx">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">Square</span><span class="p">:</span> <span class="nx">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
            <span class="nx">Entries</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">Entries</span><span class="p">,</span> <span class="nx">temp</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div><p>è¿™ä¸ªç¨‹åºä»<code>DATA</code>å˜é‡ä¸­åˆ›å»ºäº†ä¸€ä¸ªåˆ‡ç‰‡çš„æ•°æ®ç»“æ„ã€‚</p>
<p>æœ€åä¸€éƒ¨åˆ†<code>textT.go</code>çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go">    <span class="nx">t</span> <span class="o">:=</span> <span class="nx">template</span><span class="p">.</span><span class="nf">Must</span><span class="p">(</span><span class="nx">template</span><span class="p">.</span><span class="nf">ParseGlob</span><span class="p">(</span><span class="nx">tFile</span><span class="p">))</span>
    <span class="nx">t</span><span class="p">.</span><span class="nf">Execute</span><span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">Stdout</span><span class="p">,</span> <span class="nx">Entries</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><p><code>template.Must()</code>ç”¨åœ¨äº†åˆå§‹åŒ–ã€‚å®ƒè¿”å›çš„æ•°æ®ç±»å‹æ˜¯ä¸€ä¸ªTemplateï¼Œå®ƒæ§åˆ¶ä¸€ä¸ªè§£æåçš„å±•ç¤ºå†…å®¹ã€‚<code>template.ParseGlob()</code>å‡½æ•°è¯»å–å¤–éƒ¨templateæ–‡ä»¶ã€‚æ³¨æ„å¯¹äºå¤–éƒ¨templateæ–‡ä»¶æˆ‘æ›´å–œæ¬¢ä½¿ç”¨<code>gohtml</code>æ‰©å±•ã€‚ä½†æ˜¯ä½ èƒ½ä½¿ç”¨ä»»ä½•ä½ æƒ³è¦çš„ï¼Œç›®çš„ä¸€è‡´å°±å¥½äº†ã€‚</p>
<p>æœ€åï¼Œ<code>template.Execute()</code>å‡½æ•°ä¸èƒ½å…¨éƒ¨å·¥ä½œï¼Œå®ƒåŒ…æ‹¬æ‰§è¡Œç¨‹åºå’Œæ‰“å°è¾“å‡ºåˆ°æŒ‡å®šçš„æ–‡ä»¶ï¼Œä½¿ç”¨<code>os.Stdout</code>ã€‚</p>
<p>ç°åœ¨æ˜¯æ—¶å€™çœ‹ä¸€ä¸‹templateæ–‡ä»¶çš„ä»£ç ï¼Œç¬¬ä¸€éƒ¨åˆ†text templateå¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html">Calculating the squares of some integers
</code></pre></div><p>æ³¨æ„ç©ºè¡Œåœ¨text templateæ–‡ä»¶ä¸­ä¹Ÿæ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒå°†ä½œä¸ºç©ºè¡Œåœ¨æœ€åçš„æ–‡ä»¶ä¸­å±•ç¤ºå‡ºæ¥ã€‚</p>
<p>ç¬¬äºŒéƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html">{{ range . }} The square of {{ printf &#34;%d&#34; .Number}} is {{ printf
 &#34;%d&#34; .Square}}
</code></pre></div><p>åœ¨è¿™é‡Œå°†ä¼šæœ‰å¾ˆå¤šæœ‰è¶£çš„äº‹æƒ…å‘ç”Ÿã€‚å…³é”®å­—çš„èŒƒå›´å…è®¸ä½ è¿­ä»£è¾“å…¥çš„è¡Œï¼Œä½œä¸ºä¸€ä¸ªç»™å®šçš„åˆ‡ç‰‡ç»“æ„ã€‚ç®€å•çš„textåƒè¿™æ ·ä¼šè¢«æ‰“å°ï¼Œå› æ­¤å˜é‡å’ŒåŠ¨æ€çš„textå¿…é¡»ä»¥â€œ{{â€å¼€å§‹ä»¥â€œ}}â€ç»“æŸã€‚æ•°æ®ç»“æ„çš„ å­˜å–å¯ä»¥ç”¨<code>.Number</code>å’Œ<code>.Square</code>ã€‚æ³¨æ„â€œ.â€å­—ç¬¦åœ¨åœ¨è¿™ä¸ªæ•°æ®ç±»å‹çš„å‰é¢ã€‚æœ€å,æ ¼å¼åŒ–æ‰“å°å‘½ä»¤ä¼šå°†æœ€åçš„è¾“å‡ºæ–‡ä»¶æ ¼å¼åŒ–ã€‚</p>
<p>ç¬¬ä¸‰éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html">{{ end }}
</code></pre></div><p><code>{{ range }}</code>å‘½ä»¤ä»¥<code>{{ end }}</code>ç»“å°¾ï¼Œæ„å¤–çš„å°†<code>{{ end }}</code>æ”¾åœ¨é”™è¯¯çš„åœ°æ–¹å°†ä¼šå½±å“ä½ çš„è¾“å‡ºã€‚ç¬¬ä¸€æ¬¡ï¼Œåœ¨text templateæ¨¡æ¿ä¸­æ—¶åˆ»æ³¨æ„ç©ºè¡Œçš„æœ‰æ•ˆæ€§ï¼Œå› ä¸ºå®ƒå°†ä¼šè¾“å‡ºåœ¨æœ€åçš„æ–‡ä»¶ä¸­ã€‚</p>
<p>Executing textT.go will generate the following type of output:
æ‰§è¡Œ<code>textT.go</code>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ go run textT.go text.gotext
Calculating the squares of some integers
The square of -1 is <span class="m">1</span>
The square of -2 is <span class="m">4</span>
The square of -3 is <span class="m">9</span>
The square of -4 is <span class="m">16</span>
</code></pre></div><h1 id="æ„é€ ä¸€ä¸ªhtmlè¾“å‡º">æ„é€ ä¸€ä¸ªHTMLè¾“å‡º</h1>
<p>è¿™éƒ¨åˆ†ç”¨<code>htmlT.go</code>æ–‡ä»¶è§£é‡Šè¯´æ˜äº†<code>html/template</code>çš„ä½¿ç”¨ã€‚å®ƒå°†åˆ†6ä¸ªéƒ¨åˆ†å±•ç¤ºã€‚<code>html/template</code>çš„å“²å­¦å’Œ<code>text/template</code>ä¸€æ ·ã€‚è¿™ä¸¤ä¸ªåŒ…ä¸åŒä¹‹å¤„åœ¨äº<code>html/template</code>ä»£ç ç”ŸæˆHTMLçš„è¾“å‡ºæ—¶æ˜¯å®‰å…¨çš„ï¼Œä¸å…è®¸ä»£ç æ³¨å…¥ã€‚</p>
<p>è™½ç„¶ä½ èƒ½ç”¨<code>text/template</code>åˆ›å»ºHTMLè¾“å‡ºã€‚æ¯•ç«Ÿï¼ŒHTMLå°±æ˜¯ä¸€ä¸ªç®€å•çš„textã€‚å¦‚æœä½ æƒ³åˆ›å»ºHTMLè¾“å‡ºï¼Œç„¶åä½ åº”è¯¥ä½¿ç”¨<code>html/template</code>ä»£æ›¿ã€‚</p>
<p>æ¥ä¸‹æ¥çš„å†…å®¹å°†ä»SQLiteæ•°æ®åº“è¯»å–æ•°æ®ï¼Œä½†æ˜¯ä½ èƒ½ä½¿ç”¨ä»»ä½•ä½ æƒ³ç”¨çš„æ•°æ®åº“ï¼Œæä¾›ä½ æœ‰çš„æˆ–è€…ä½ èƒ½å¤Ÿå†™å‡ºé€‚å½“çš„Goé©±åŠ¨ã€‚ä¸ºäº†è®©äº‹æƒ…æ›´åŠ ç®€å•ï¼Œæ¡ˆä¾‹åœ¨è¯»å–ä¹‹å‰å°†å¯¼å…¥åˆ°æ•°æ®åº“ã€‚</p>
<p>ç¬¬ä¸€éƒ¨åˆ†å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
 <span class="s">&#34;database/sql&#34;</span>
 <span class="s">&#34;fmt&#34;</span>
 <span class="nx">_</span> <span class="s">&#34;github.com/mattn/go-sqlite3&#34;</span>
 <span class="s">&#34;html/template&#34;</span>
 <span class="s">&#34;net/http&#34;</span>
 <span class="s">&#34;os&#34;</span>
<span class="p">)</span>

<span class="kd">type</span> <span class="nx">Entry</span> <span class="kd">struct</span> <span class="p">{</span>
 <span class="nx">Number</span> <span class="kt">int</span>
 <span class="nx">Double</span> <span class="kt">int</span>
 <span class="nx">Square</span> <span class="kt">int</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">DATA</span> <span class="p">[]</span><span class="nx">Entry</span>
<span class="kd">var</span> <span class="nx">tFile</span> <span class="kt">string</span>
</code></pre></div><p>ä½ èƒ½çœ‹å‡ºä¸€ä¸ªå¯¼å…¥äº†ä¸€ä¸ªæ–°åŒ…<code>net/http</code>ï¼Œç”¨æ¥å®ƒåˆ›å»ºHTTPæœåŠ¡å’ŒclientæœåŠ¡ã€‚ä½ å°†å­¦åˆ°æ›´å¤šçš„å…³äºç½‘ç»œç¼–ç¨‹çš„å†…å®¹ã€‚å°†åœ¨12ç« å­¦åˆ°<code>net</code>å’Œ<code>net/http</code>Goæ ‡å‡†åº“çš„ä½¿ç”¨ã€‚åœ¨13ç« è®²Goè¯­è¨€ç½‘ç»œç¼–ç¨‹çš„åŸºç¡€â€”â€”æ„å»ºä½ è‡ªå·±çš„Serverså’ŒClientã€‚</p>
<p>åˆ†ç¦»å‡º<code>net/http</code>ï¼Œä½ èƒ½å¤Ÿçœ‹åˆ°<code>Entry</code>æ•°æ®ç±»å‹çš„å®šä¹‰ã€‚å®ƒå°†æ¥æ”¶ä»SQLiteæ•°æ®åº“è¡¨å•ä¸­æŸ¥è¯¢å‡ºå¾—æ•°æ®ã€‚å…¶ä¸­ä¹Ÿè¦2ä¸ªå…¨å±€å˜é‡<code>DATA</code>å’Œ&rsquo;tFile'ï¼ŒæŒæœ‰çš„æ•°æ®åˆ†åˆ«è¢«ä¼ é€’åˆ°æ¨¡æ¿æ–‡ä»¶å’Œæ¨¡æ¿æ–‡ä»¶çš„æ–‡ä»¶åã€‚</p>
<p>æœ€åï¼Œä½ å¯ä»¥çœ‹<a class="link" href="https://github.com/mattn/go-sqlite3"  target="_blank" rel="noopener"
    >https://github.com/mattn/go-sqlite3</a>çš„ä½¿ç”¨ï¼Œé€šè¿‡<code>database/sql</code>æ¥å£å’Œ<code>SQLite3</code>æ•°æ®åº“äº¤äº’</p>
<p>ç¬¬äºŒéƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">myHandler</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Host: %s Path: %s\n&#34;</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">Host</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">URL</span><span class="p">.</span><span class="nx">Path</span><span class="p">)</span>
    <span class="nx">myT</span> <span class="o">:=</span> <span class="nx">template</span><span class="p">.</span><span class="nf">Must</span><span class="p">(</span><span class="nx">template</span><span class="p">.</span><span class="nf">ParseGlob</span><span class="p">(</span><span class="nx">tFile</span><span class="p">))</span>
    <span class="nx">myT</span><span class="p">.</span><span class="nf">ExecuteTemplate</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">tFile</span><span class="p">,</span> <span class="nx">DATA</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><p>ç®€å•é«˜æ•ˆçš„<code>myHandler()</code>å‡½æ•°å¾ˆæƒŠäººï¼Œå°¤å…¶æ˜¯ä½ è€ƒè™‘å‡½æ•°çš„å¤§å°ã€‚<code>template.ExecuteTemplate()</code>å‡½æ•°å¹¶ä¸æ˜¯å…¨éƒ½ä¸ºæˆ‘ä»¬å·¥ä½œã€‚å®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°å˜é‡ï¼Œç”¨æ¥è¿æ¥HTTPå®¢æˆ·ç«¯ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ¨¡æ¿æ–‡ä»¶ï¼Œè¿™ä¸ªæ¨¡æ¿æ–‡ä»¶ç”¨æ¥æ ¼å¼åŒ–æ•°æ®æ ¼å¼ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å¸¦æœ‰æ•°æ®çš„ç»“æ„åˆ‡ç‰‡ã€‚</p>
<p>ç¬¬ä¸‰éƒ¨åˆ†ä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">arguments</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Args</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">arguments</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Need Database File + Template File!&#34;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="nx">database</span> <span class="o">:=</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="nx">tFile</span> <span class="p">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</code></pre></div><p>ç¬¬å››éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼Œè¿™éƒ¨åˆ†ä½ å°†å¼€å§‹å¤„ç†æ•°æ®åº“ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go">    <span class="nx">db</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">sql</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span><span class="s">&#34;sqlite3&#34;</span><span class="p">,</span> <span class="nx">database</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="kc">nil</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Emptying database table.&#34;</span><span class="p">)</span>
    <span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">db</span><span class="p">.</span><span class="nf">Exec</span><span class="p">(</span><span class="s">&#34;DELETE FROM data&#34;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="kc">nil</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Populating&#34;</span><span class="p">,</span> <span class="nx">database</span><span class="p">)</span>
    <span class="nx">stmt</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">db</span><span class="p">.</span><span class="nf">Prepare</span><span class="p">(</span><span class="s">&#34;INSERT INTO data(number, double, square) values(?,?,?)&#34;</span><span class="p">)</span>
    <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">20</span><span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="mi">50</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
        <span class="nx">_</span><span class="p">,</span> <span class="nx">_</span> <span class="p">=</span> <span class="nx">stmt</span><span class="p">.</span><span class="nf">Exec</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="nx">i</span><span class="p">,</span> <span class="nx">i</span><span class="o">*</span><span class="nx">i</span><span class="p">)</span>
    <span class="p">}</span>
</code></pre></div><p><code>sql.Open()</code>å‡½æ•°è¿æ¥æ•°æ®åº“ï¼Œç”¨<code>db.Exec()</code>å‡½æ•°ï¼Œä½ èƒ½æ‰§è¡Œæ•°æ®åº“å‘½ä»¤ï¼Œå¦‚æœæ²¡æœ‰å¼‚å¸¸åé¦ˆã€‚æœ€å<code>db.Prepare()</code>å‡½æ•°èƒ½å¤Ÿé€šè¿‡å®ƒçš„å‚æ•°å¤šæ¬¡å¤„ç†è¯¥è¡¨æ•°æ®ï¼Œç„¶åè°ƒç”¨<code>Exec()</code>å‡½æ•°ã€‚</p>
<p>ç¬¬äº”éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go">    <span class="nx">rows</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">db</span><span class="p">.</span><span class="nf">Query</span><span class="p">(</span><span class="s">&#34;SELECT * FROM data&#34;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="kc">nil</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">n</span> <span class="kt">int</span>
    <span class="kd">var</span> <span class="nx">d</span> <span class="kt">int</span>
    <span class="kd">var</span> <span class="nx">s</span> <span class="kt">int</span>
    <span class="k">for</span> <span class="nx">rows</span><span class="p">.</span><span class="nf">Next</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">err</span> <span class="p">=</span> <span class="nx">rows</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">n</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">d</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">s</span><span class="p">)</span>
    <span class="nx">temp</span> <span class="o">:=</span> <span class="nx">Entry</span><span class="p">{</span><span class="nx">Number</span><span class="p">:</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">Double</span><span class="p">:</span> <span class="nx">d</span><span class="p">,</span> <span class="nx">Square</span><span class="p">:</span> <span class="nx">s</span><span class="p">}</span>
    <span class="nx">DATA</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">DATA</span><span class="p">,</span> <span class="nx">temp</span><span class="p">)</span>
 <span class="p">}</span>
</code></pre></div><p>åœ¨è¿™ç¨‹åºè¿™éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>db.Query()</code>å‡½æ•°å’Œå¤šæ¬¡è°ƒç”¨<code>Next()</code>å’Œ<code>Scan()</code>ä»æ•°æ®åº“è¡¨å•ä¸­è¯»å–å‡ºæ¥æ•°æ®ã€‚å¾ªç¯è¯»å–æ•°æ®ï¼Œå°†è¯»å–å‡ºæ¥çš„æ•°æ®æ”¾åœ¨åˆ‡ç‰‡ä¸­ã€‚ç°åœ¨ä½ å·²ç»èƒ½å¤Ÿç”¨Goå¤„ç†æ•°æ®åº“äº†ã€‚</p>
<p>æœ€åä¸€éƒ¨åˆ†ç”¨æ¥è®¾ç½®webæœåŠ¡å™¨ï¼Œå®ƒåŒ…å«å¦‚ä¸‹å†…å®¹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go">    <span class="nx">http</span><span class="p">.</span><span class="nf">HandleFunc</span><span class="p">(</span><span class="s">&#34;/&#34;</span><span class="p">,</span> <span class="nx">myHandler</span><span class="p">)</span>
    <span class="nx">err</span> <span class="p">=</span> <span class="nx">http</span><span class="p">.</span><span class="nf">ListenAndServe</span><span class="p">(</span><span class="s">&#34;:8080&#34;</span><span class="p">,</span> <span class="kc">nil</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>è¿™é‡Œï¼Œ<code>http.HandleFunc()</code>å‡½æ•°å‘Šè¯‰ç¨‹åºä¸­åµŒå…¥çš„webæœåŠ¡å™¨å“ªäº›urlå°†è¢«æ”¯æŒï¼Œå“ªäº›handlerå‡½æ•°(<code>myHandler()</code>)æ”¯æŒã€‚å½“å‰çš„handleræ”¯æŒ<code>/URL</code>ï¼Œå®ƒæ˜¯GoåŒ¹é…æ‰€æœ‰çš„URLã€‚è¿™ä½¿ä½ ä¸å¿…åˆ›å»ºä»»ä½•é¢å¤–çš„é™æ€æˆ–åŠ¨æ€é¡µé¢ã€‚</p>
<p><code>htmlT.go</code>è¢«åˆ†è¿›é‡Œäº†2ä¸ªè™šæ‹Ÿéƒ¨åˆ†ä¸­ã€‚ç¬¬ä¸€éƒ¨åˆ†å°†ä»æ•°æ®åº“æŸ¥è¯¢å‡ºçš„æ•°æ®æ”¾åˆ°åˆ‡ç‰‡ä¸­ï¼Œç¬¬äºŒéƒ¨åˆ†å°±æ˜¯å°†æ•°æ®æ˜¾ç¤ºåœ¨webæœåŠ¡ä¸­ã€‚</p>
<p><code>SQLite</code>ä¸¤ä¸ªæœ€å¤§çš„ä¼˜åŠ¿å°±æ˜¯ä½ ä¸éœ€è¦è¿è¡Œæ•°æ®åº“æœåŠ¡ï¼Œå› ä¸º<code>SQLite</code>æ•°æ®åº“è¢«å­˜å‚¨åœ¨å®ƒè‡ªå·±å†…éƒ¨çš„æ–‡ä»¶ä¸­ï¼Œè¿™æ„å‘³ç€å•ä¸ªæ–‡ä»¶å°±æ˜¯æ•´ä¸ªæ•°æ®åº“ã€‚</p>
<p>æ³¨æ„ä¸ºäº†å‡å°‘Goä»£ç è¢«è¿è¡Œå¤šæ¬¡çš„é—®é¢˜ï¼Œä½ å°†éœ€è¦æ‰‹åŠ¨åˆ›å»ºæ•°æ®åº“è¡¨å’Œ<code>SQLite3</code>æ•°æ®åº“ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ sqlite3 htmlT.db
SQLite version 3.19.3 2017-06-27 16:48:08
Enter <span class="s2">&#34;.help&#34;</span> <span class="k">for</span> usage hints.
sqlite&gt; CREATE TABLE data <span class="o">(</span>
 ...&gt; number INTEGER PRIMARY KEY,
 ...&gt; double INTEGER,
 ...&gt; square INTEGER <span class="o">)</span><span class="p">;</span>
sqlite&gt; ^D
$ ls -l htmlT.db
-rw-r--r-- <span class="m">1</span> mtsouk staff <span class="m">8192</span> Dec <span class="m">26</span> 22:46 htmlT.db
</code></pre></div><p>ç¬¬ä¸€ä¸ªåœ¨UNIXä¸­è¢«æ‰§è¡Œçš„shellå‘½ä»¤æ˜¯åˆ›å»ºä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶ã€‚ç¬¬äºŒä¸ªå‘½ä»¤æ‰§è¡Œåœ¨<code>SQLite3</code>çš„å‘½ä»¤è¡Œä¸­åˆ›å»ºè¡¨å’Œå­—æ®µï¼Œå®ƒæœ‰3ä¸ªå­—æ®µã€numberã€doubleã€squareã€‚</p>
<p>æ­¤å¤–ï¼Œä½ å°†éœ€è¦å¤–éƒ¨çš„templateæ–‡ä»¶ï¼Œå®ƒå°†è¢«å‘½åä¸º<code>html.gohtml</code>ï¼Œè¿™ä¸ªæ–‡ä»¶å°†è¢«ç”¨ä½œç”Ÿæˆç¨‹åºçš„è¾“å‡ºã€‚</p>
<p><code>html.gohtml</code>çš„ç¬¬ä¸€éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!doctype html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Doing Maths in Go!<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
 <span class="nt">html</span> <span class="p">{</span>
 <span class="k">font-size</span><span class="p">:</span> <span class="mi">14</span><span class="kt">px</span><span class="p">;</span>
 <span class="p">}</span>
 <span class="nt">table</span><span class="o">,</span> <span class="nt">th</span><span class="o">,</span> <span class="nt">td</span> <span class="p">{</span>
 <span class="k">border</span><span class="p">:</span> <span class="mi">2</span><span class="kt">px</span> <span class="kc">solid</span> <span class="kc">blue</span><span class="p">;</span>
 <span class="p">}</span>
 <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
 <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</code></pre></div><p>WEBæµè§ˆå™¨å°†è·å¾—çš„HTMLä»£ç åŸºäºHTML .gohtmlçš„å†…å®¹ã€‚è¿™æ„å‘³ç€ä½ å°†éœ€è¦åˆ›å»ºé€‚å½“çš„HTMLè¾“å‡ºï¼Œå› æ­¤å‰é¢çš„HTMLä»£ç ä¹ŸåŒ…æ‹¬ä¸€äº›å†…è”CSSä»£ç ï¼Œç”¨äºæ ¼å¼åŒ–ç”Ÿæˆçš„HTMLè¡¨ã€‚</p>
<p>ç¬¬äºŒéƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">table</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">thead</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">th</span><span class="p">&gt;</span>Number<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">th</span><span class="p">&gt;</span>Double<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">th</span><span class="p">&gt;</span>Square<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
 <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
 <span class="p">&lt;/</span><span class="nt">thead</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">tbody</span><span class="p">&gt;</span>
{{ range . }}
 <span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;</span> {{ .Number }} <span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;</span> {{ .Double }} <span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;</span> {{ .Square }} <span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
 <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
{{ end }}
 <span class="p">&lt;/</span><span class="nt">tbody</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">table</span><span class="p">&gt;</span>
</code></pre></div><p>As you can see from the preceding code, you still have to use {{ range }} and {{ end }} in order to iterate over the elements of the slice of structures that was passed to template.ExecuteTemplate(). However, this time the html.gohtml template file contains lots of HTML code in order to format the data in the slice of structures better.
ä½ å¯ä»¥çœ‹åˆ°ä¹‹å‰çš„ä»£ç ï¼Œä½ ä»ç„¶ä¸å¾—ä¸ä½¿ç”¨<code>{{ range }}</code>å’Œ<code>{{ end }}</code>ä¸ºäº†éå†åˆ‡ç‰‡ä¸­çš„å…ƒç´ å€¼ï¼Œå®ƒé€šè¿‡<code>template.ExecuteTemplate()</code>éå†ã€‚ç„¶è€Œï¼Œè¿™æ¬¡<code>html.gohtml</code>æ¨¡æ¿æ–‡ä»¶åŒ…å«ä¸€äº›HTMLä»£ç ä¸ºäº†ä½¿æ•°æ®çš„æ•°æ®æ›´åŠ ç¾è§‚ã€‚</p>
<p>æœ€åä¸€éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-htlml" data-lang="htlml">&lt;/body&gt;
&lt;/html&gt;
</code></pre><p>æœ€åä¸€éƒ¨åˆ†ä»£ç ä¸»è¦æ˜¯æ ¹æ®HTMLæ ‡å‡†ç”Ÿæˆé€‚å½“çš„HTMLä»£ç ã€‚åœ¨ç¼–è¯‘å’Œæ‰§è¡Œ<code>htmlT.go</code>ä¹‹å‰ï¼Œä½ å°†éœ€è¦ä¸‹è½½å’Œ<code>SQLite3</code>äº¤äº’çš„packageã€‚æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ go get github.com/mattn/go-sqlite3
</code></pre></div><p>ä½ å·²ç»çŸ¥é“ï¼Œä½ å¯ä»¥åœ¨<code>~/go/src</code>è·¯å¾„ä¸‹æ‰¾åˆ°ä¸‹è½½çš„åŒ…çš„æºç ã€‚å¦‚æœä½ æ˜¯MacOSæœºå™¨ï¼Œå®ƒçš„ç¼–è¯‘ç‰ˆæœ¬åœ¨<code>~/go/pkg/darwin_amd64</code>ä¸‹ã€‚å¦åˆ™ï¼Œæ£€æŸ¥<code>~/go/pkg</code>çš„å†…å®¹å»æ‰¾åˆ°ä½ è‡ªå·±çš„æ¶æ„ã€‚æ³¨æ„â€œ~â€å­—ç¬¦ä»£è¡¨å½“å‰ç”¨æˆ·ç›®å½•çš„è·¯å¾„ã€‚</p>
<p>æ³¨æ„é™„åŠ çš„Go packageå­˜åœ¨ä¼šå¸®åŠ©ä½ å’Œ<code>SQLite3</code>æ•°æ®åº“äº¤äº’ã€‚ç„¶è€Œï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯ç›®å‰å”¯ä¸€æ”¯æŒ<code>database/sql</code>æ¥å£ã€‚æ‰§è¡Œ<code>htmlT.go</code>æ–‡ä»¶ä¼šåœ¨æµè§ˆå™¨çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š</p>
<p><a class="link" href="https://yunteng9345.github.io/images/go/go-module.jpg"  target="_blank" rel="noopener"
    >go-moduleå›¾ç‰‡</a>go-module.jpg</p>
<p>htmlT.goè¾“å‡º</p>
<p>è€Œä¸”ï¼Œ<code>htmlT.go</code>åœ¨UNIXçš„shellä¸‹ç”Ÿæˆè¾“å‡ºçš„ç±»å‹ï¼Œä¸»è¦æœ‰debugä¿¡æ¯ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ go run htmlT.go htmlT.db html.gohtml
Emptying database table.
Populating htmlT.db
Host: localhost:8080 Path: /
Host: localhost:8080 Path: /favicon.ico
Host: localhost:8080 Path: /123
</code></pre></div><p>å¦‚æœä½ æƒ³è¦çœ‹åˆ°ç¨‹åºä»UNIXshellè¾“å‡ºHTML,ä½ è¦ä½¿ç”¨<code>wget(1)</code>å·¥å…·ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ wget -qO- http://localhost:8080
&lt;!doctype html&gt;
&lt;html <span class="nv">lang</span><span class="o">=</span><span class="s2">&#34;en&#34;</span>&gt;
&lt;head&gt;
 &lt;meta <span class="nv">charset</span><span class="o">=</span><span class="s2">&#34;UTF-8&#34;</span>&gt;
 &lt;title&gt;Doing Maths in Go!&lt;/title&gt;
 &lt;style&gt;
 html <span class="o">{</span>
 font-size: 14px<span class="p">;</span>
 <span class="o">}</span>
 table, th, td <span class="o">{</span>
 border: 2px solid blue<span class="p">;</span>
 <span class="o">}</span>
 &lt;/style&gt;
 &lt;/head&gt;
 &lt;body&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
</code></pre></div><p><code>text/template</code>å’Œ<code>html/template</code>éƒ½æ˜¯åŠŸèƒ½éå¸¸å¼ºå¤§çš„åŒ…ï¼Œå®ƒèƒ½å¤ŸèŠ‚çœä½ çš„æ—¶é—´ï¼Œæ‰€ä»¥æˆ‘å»ºè®®åœ¨ä½ çš„appæœ‰é€‚åˆçš„éœ€æ±‚æ—¶å¤šä½¿ç”¨å®ƒä»¬ã€‚</p>
<h1 id="èµ„æº">èµ„æº</h1>
<p>ä½ å°†ä¼šåœ¨ä¸‹é¢æ‰¾åˆ°éå¸¸æœ‰ç”¨çš„èµ„æºï¼š</p>
<ul>
<li>
<p>è®¿é—®<code>syscall</code>æ ‡å‡†Goåº“<a class="link" href="https://golang.org/pkg/syscall/"  target="_blank" rel="noopener"
    >https://golang.org/pkg/syscall/</a>ã€‚è¿™æ˜¯ç›®å‰ä¸ºæ­¢æˆ‘çœ‹åˆ°è¿‡æœ€å¤§çš„Goæ–‡æ¡£ã€‚</p>
</li>
<li>
<p>è®¿é—®<code>text/template</code>æ ‡å‡†Goåº“<a class="link" href="https://golang.org/pkg/text/template/"  target="_blank" rel="noopener"
    >https://golang.org/pkg/text/template/</a></p>
</li>
<li>
<p>è®¿é—®<code>html/template</code>æ ‡å‡†Goåº“<a class="link" href="https://golang.org/pkg/html/template/"  target="_blank" rel="noopener"
    >https://golang.org/pkg/html/template/</a></p>
</li>
<li>
<p>è®¿é—®<code>go/token</code>æ ‡å‡†Goåº“<a class="link" href="https://golang.org/pkg/go/token/"  target="_blank" rel="noopener"
    >https://golang.org/pkg/go/token/</a></p>
</li>
<li>
<p>è®¿é—®<code>go/parser</code>æ ‡å‡†Goåº“<a class="link" href="https://golang.org/pkg/go/parser/"  target="_blank" rel="noopener"
    >https://golang.org/pkg/go/parser/</a></p>
</li>
<li>
<p>è®¿é—®<code>go/scanner</code>æ ‡å‡†Goåº“<a class="link" href="https://golang.org/pkg/go/scanner/"  target="_blank" rel="noopener"
    >https://golang.org/pkg/go/scanner/</a></p>
</li>
<li>
<p>è®¿é—®<code>go/ast</code>æ ‡å‡†Goåº“<a class="link" href="https://golang.org/pkg/go/ast/"  target="_blank" rel="noopener"
    >https://golang.org/pkg/go/ast/</a></p>
</li>
<li>
<p>è®¿é—®<code>SQLite3</code><a class="link" href="https://www.sqlite.org/"  target="_blank" rel="noopener"
    >https://www.sqlite.org/</a></p>
</li>
<li>
<p>è®¿é—®&quot;ç”¨Goè¯­è¨€å†™å‡ºæœ€æ¼‚äº®çš„package&rdquo;<a class="link" href="https://www.youtube.com/watch?v=cAWlv2SeQus"  target="_blank" rel="noopener"
    >https://www.youtube.com/watch?v=cAWlv2SeQus</a></p>
</li>
<li>
<p>å¦‚æœä½ æƒ³çŸ¥é“<code>Plan 9</code>ï¼ŒæŸ¥çœ‹<a class="link" href="https://plan9.io/plan9/"  target="_blank" rel="noopener"
    >https://plan9.io/plan9/</a></p>
</li>
<li>
<p>èŠ±ç‚¹æ—¶é—´é€šè¿‡<code>man</code>å‘½ä»¤<code>(man 1 find)</code>ã€‚æŸ¥çœ‹ <code>find(1)</code> å‘½ä»¤è¡Œå·¥å…·ã€‚</p>
</li>
</ul>
<h1 id="ç»ƒä¹ ">ç»ƒä¹ </h1>
<ol>
<li>
<p>å¯»æ‰¾æ›´å¤šå®ç°<code>fmt.Printf()</code>çš„ä¿¡æ¯ã€‚</p>
</li>
<li>
<p>ä½ èƒ½å†™ä¸€ä¸ªå‡½æ•°ç”¨æ¥å­˜å‚¨3ä¸ªintå€¼å—ï¼Ÿå°è¯•å†™2ä¸ªç‰ˆæœ¬çš„å‡½æ•°ï¼šä¸€ä¸ªå¸¦æœ‰å‘½åè¿”å›å€¼ï¼Œå¦ä¸€ä¸ªæ²¡æœ‰å‘½åè¿”å›å€¼ã€‚ä½ è®¤ä¸ºå“ªä¸ªæ›´å¥½ï¼Ÿ</p>
</li>
<li>
<p>ä½ èƒ½ä¿®æ”¹<code>htmlT.go</code>ä¸­çš„ä»£ç ç”¨<code>text/template</code>ä»£æ›¿<code>html/template</code>å—ï¼Ÿ</p>
</li>
<li>
<p>ä½ èƒ½ä¿®æ”¹<code>htmlT.go</code>ä¸­çš„ä»£ç ï¼Œä½¿ç”¨[https://github.com/feyeleanor/gosqlite3](https://
github.com/feyeleanor/gosqlite3)æˆ–è€…<a class="link" href="https://github.com/phf/go-sqlite3"  target="_blank" rel="noopener"
    >https://github.com/phf/go-sqlite3</a>è®©å®ƒå’ŒSQLiteæ•°æ®åº“äº¤äº’ã€‚</p>
</li>
<li>
<p>åˆ›å»ºä½ è‡ªå·±çš„Go moduleå¹¶ä¸”å¼€å‘é’ˆå¯¹äºå®ƒçš„3ä¸ªå¤§ç‰ˆæœ¬ã€‚</p>
</li>
<li>
<p>å†™ä¸€ä¸ªç±»ä¼¼äº<code>htmlT.go</code>ä¸€æ ·èƒ½å¤Ÿè¯»å–Mysqlæ•°æ®åº“çš„ç¨‹åºã€‚</p>
</li>
<li>
<p>å†™ä¸‹ä½ æ‰€åšçš„ä»£ç æ›´æ”¹ã€‚</p>
</li>
</ol>
<h1 id="æ€»ç»“">æ€»ç»“</h1>
<p>è¿™ç« ä¸»è¦å±•ç¤ºäº†ä¸‰éƒ¨åˆ†ä¸»é¢˜ï¼šGo functions, Go packages, Go modules.</p>
<p>Go modulesä¸»è¦çš„ä¼˜åŠ¿æ˜¯å‡†ç¡®çš„è®°å½•ä¾èµ–ä¿¡æ¯ï¼Œå®ƒèƒ½å¤Ÿé‡ç”¨å¤šæ¨¡å—ï¼Œè®©ç¼–ç¨‹å˜å¾—ç®€å•ç›´æ¥ã€‚è¿™ä¸€ç« ä¹Ÿç»™ä½ æä¾›äº†å¤§é‡çš„å…³äºå¼€å‘ä¼˜ç§€Go packageçš„å»ºè®®ã€‚éšåè®²äº†<code>text/template</code>å’Œ<code>html/template</code>åŒ…ï¼Œå®ƒå…è®¸ä½ åˆ›å»ºåŸºäºæ¨¡æ¿çš„ç®€å•çš„textå’Œhtmlçš„è¾“å‡ºã€‚ä¹Ÿæœ‰<code>go/token, go/parser, go/scanner</code>è¿™äº›åŒ…ã€‚æœ€åï¼Œè®²äº†<code>syscall</code>æ ‡å‡†Goåº“çš„é«˜çº§ç‰¹æ€§ã€‚</p>
<p>ä¸‹ä¸€ç« å°†è¦è®¨è®ºå…³äºGoè¯­è¨€é‡è¦çš„ä¿©ä¸ªç‰¹å¾ï¼š<strong>æ¥å£å’Œåå°„</strong>ã€‚å®ƒå°†è®¨è®ºOOPã€Debugå’ŒGo typeæ–¹æ³•ã€‚æ‰€æœ‰çš„è¿™äº›ä¸»é¢˜éƒ½æ¯”è¾ƒé«˜çº§ï¼Œåœ¨ç¬¬ä¸€æ¬¡æ¥è§¦ä½ å¯èƒ½æ„Ÿè§‰ä»–ä»¬æ¯”è¾ƒå›°éš¾ã€‚ç„¶è€Œå­¦çš„æ›´å¤šä½ å°†æˆä¸ºäº†ä¸€ä¸ªååˆ†ä¼˜ç§€çš„ç¨‹åºå‘˜ã€‚</p>
<p>æœ€åï¼Œä¸‹ä¸€ç« åŒ…æ‹¬ç®€ä»‹gitï¼Œå°±æ˜¯åœ¨è¿™ç« åˆ›å»ºGo moduleçš„å·¥å…·gitã€‚</p>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
</aside>

     
     
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (DISQUS) {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2021 
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.1.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
